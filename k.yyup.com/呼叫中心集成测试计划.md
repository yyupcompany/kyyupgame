# 呼叫中心集成测试计划

**制定日期**: 2025-10-28  
**优先级**: 🔴 高  
**预计完成时间**: 1-2天

---

## 🧪 测试范围

### 1. API集成测试

#### 核心功能测试
- [ ] **VOS连接测试**
  - 测试: `testVosConnection()` 方法
  - 预期: 返回VOS配置状态
  - 验证: `vosConnected` 状态正确更新

- [ ] **发起通话测试**
  - 测试: `handleCall()` 方法
  - 输入: 有效的电话号码
  - 预期: 返回 `callId`，通话状态更新
  - 验证: `isCallActive` 为 true，`activeCallCount` 增加

- [ ] **挂断通话测试**
  - 测试: `handleHangup()` 方法
  - 输入: 有效的 `callId`
  - 预期: 通话状态更新为 'ended'
  - 验证: `isCallActive` 为 false，`activeCallCount` 减少

- [ ] **加载通话记录测试**
  - 测试: `loadCallRecords()` 方法
  - 预期: 返回通话记录列表
  - 验证: `callRecords` 数组正确填充

- [ ] **播放录音测试**
  - 测试: `playRecording()` 方法
  - 输入: 有效的录音ID
  - 预期: 返回音频URL
  - 验证: 音频可以播放

#### AI功能测试
- [ ] **分析通话测试**
  - 测试: `viewAnalysis()` 方法
  - 输入: 有效的通话ID
  - 预期: 返回分析结果
  - 验证: `analysisData` 正确填充

- [ ] **优化话术测试**
  - 测试: `optimizeScript()` 方法
  - 输入: 原始话术
  - 预期: 返回优化后的话术
  - 验证: `analysisData.optimizedScript` 更新

#### 数据加载测试
- [ ] **加载联系人测试**
  - 测试: `loadContacts()` 方法
  - 预期: 加载三类联系人
  - 验证: `parentContacts`, `customerContacts`, `employeeContacts` 正确填充

- [ ] **加载分机测试**
  - 测试: `loadExtensions()` 方法
  - 预期: 返回分机列表
  - 验证: `extensions` 数组正确填充

### 2. UI交互测试

#### 标签页切换
- [ ] 电话呼叫标签页
- [ ] 通话记录标签页
- [ ] 话术分析标签页
- [ ] 设置标签页

#### 按钮功能
- [ ] 发起通话按钮
- [ ] VOS设置按钮
- [ ] 挂断按钮
- [ ] 播放录音按钮
- [ ] 分析按钮
- [ ] 优化话术按钮
- [ ] 导出记录按钮

#### 表单输入
- [ ] 电话号码输入
- [ ] 话术模板选择
- [ ] 日期范围筛选
- [ ] 搜索功能

### 3. 错误处理测试

#### 网络错误
- [ ] API请求超时
- [ ] 网络连接失败
- [ ] 服务器错误 (500)
- [ ] 未授权错误 (401)
- [ ] 禁止访问错误 (403)

#### 数据验证
- [ ] 空电话号码
- [ ] 无效的电话号码格式
- [ ] 缺少必填字段
- [ ] 数据类型错误

#### 业务逻辑
- [ ] VOS未配置
- [ ] 通话中重复发起
- [ ] 挂断不存在的通话
- [ ] 分析不存在的通话

### 4. 性能测试

#### 加载性能
- [ ] 页面初始加载时间 < 3秒
- [ ] 通话记录加载时间 < 2秒
- [ ] 联系人加载时间 < 1秒

#### 内存使用
- [ ] 初始内存占用 < 50MB
- [ ] 加载大量数据后 < 100MB
- [ ] 没有内存泄漏

#### 并发性能
- [ ] 同时处理多个通话
- [ ] 同时加载多个数据源
- [ ] 快速切换标签页

---

## 🧬 测试用例

### 测试用例1: 完整通话流程
```
前置条件: VOS已配置
步骤:
1. 打开呼叫中心页面
2. 点击"发起通话"按钮
3. 输入电话号码
4. 点击"呼叫"按钮
5. 等待通话接通
6. 点击"挂断"按钮
预期结果: 通话成功发起和挂断
```

### 测试用例2: 通话记录查看
```
前置条件: 存在通话记录
步骤:
1. 打开呼叫中心页面
2. 切换到"通话记录"标签页
3. 查看通话记录列表
4. 点击"播放"按钮
5. 点击"分析"按钮
预期结果: 能够查看和分析通话记录
```

### 测试用例3: 话术优化
```
前置条件: 存在通话记录
步骤:
1. 打开呼叫中心页面
2. 切换到"通话记录"标签页
3. 点击"优化"按钮
4. 查看优化建议
预期结果: 显示优化后的话术和建议
```

---

## 📊 测试环境

### 开发环境
- Node.js: >= 18.0.0
- npm: >= 8.0.0
- 浏览器: Chrome 最新版本

### 测试数据
- 测试用户: test@example.com
- 测试电话: 13800138000
- 测试VOS配置: 已配置

---

## 🚀 执行步骤

### 1. 准备阶段
```bash
# 安装依赖
npm install

# 启动开发服务器
npm run start:all

# 访问页面
http://localhost:5173/centers/call-center
```

### 2. 执行测试
```bash
# 运行单元测试
npm run test:unit

# 运行集成测试
npm run test:integration

# 运行E2E测试
npm run test:e2e
```

### 3. 验证结果
- 检查所有测试通过
- 检查没有控制台错误
- 检查性能指标

---

## 📋 测试报告模板

### 测试项目: [项目名称]
- **测试日期**: [日期]
- **测试人员**: [人员]
- **测试环境**: [环境]
- **总测试数**: [数量]
- **通过数**: [数量]
- **失败数**: [数量]
- **通过率**: [百分比]

### 失败项目
| 项目 | 预期 | 实际 | 原因 |
|------|------|------|------|
| | | | |

### 建议
- 
- 

---

## ✅ 验收标准

- [ ] 所有API集成测试通过
- [ ] 所有UI交互测试通过
- [ ] 所有错误处理测试通过
- [ ] 性能指标达到要求
- [ ] 没有控制台错误
- [ ] 代码覆盖率 >= 80%


