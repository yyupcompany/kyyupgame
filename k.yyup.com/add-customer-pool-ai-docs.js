// ä¸ºå®¢æˆ·æ± ä¸­å¿ƒæ·»åŠ AIçŸ¥è¯†åº“æ–‡æ¡£
import mysql from 'mysql2/promise';

// æ•°æ®åº“è¿æ¥é…ç½®
const dbConfig = {
  host: 'dbconn.sealoshzh.site',
  port: 43906,
  user: 'root',
  password: 'pwk5ls7j',
  database: 'kargerdensales'
};

// å®¢æˆ·æ± ä¸­å¿ƒAIçŸ¥è¯†åº“æ–‡æ¡£
const customerPoolDocs = [
  {
    category: 'customer_pool_center',
    title: 'å®¢æˆ·æ± ä¸­å¿ƒæ¦‚è§ˆ',
    content: `# å®¢æˆ·æ± ä¸­å¿ƒæ¦‚è§ˆ

## åŠŸèƒ½ç®€ä»‹
å®¢æˆ·æ± ä¸­å¿ƒæ˜¯å¹¼å„¿å›­ç®¡ç†ç³»ç»Ÿçš„æ ¸å¿ƒè¥é”€æ¨¡å—ï¼Œç”¨äºç»Ÿä¸€ç®¡ç†ã€è·Ÿè¿›å’Œè½¬åŒ–æ½œåœ¨å®¢æˆ·ï¼Œæå‡æ‹›ç”Ÿæ•ˆç‡ã€‚

## æ ¸å¿ƒåŠŸèƒ½
1. **å®¢æˆ·ä¿¡æ¯ç®¡ç†**
   - é›†ä¸­å­˜å‚¨å®¢æˆ·åŸºæœ¬ä¿¡æ¯
   - æ”¯æŒå¤šæ¸ é“å®¢æˆ·å¯¼å…¥
   - å®¢æˆ·çŠ¶æ€å®æ—¶è·Ÿè¸ª

2. **è·Ÿè¿›è®°å½•ç³»ç»Ÿ**
   - ç”µè¯ã€å¾®ä¿¡ã€é¢è°ˆã€é‚®ä»¶ç­‰è·Ÿè¿›æ–¹å¼
   - è·Ÿè¿›å†…å®¹è¯¦ç»†è®°å½•
   - ä¸‹æ¬¡è·Ÿè¿›æ—¶é—´æé†’

3. **æ•°æ®åˆ†ææŠ¥è¡¨**
   - å®¢æˆ·è½¬åŒ–ç‡ç»Ÿè®¡
   - æ¸ é“æ¥æºåˆ†æ
   - è·Ÿè¿›æ•ˆæœè¯„ä¼°

4. **å›¢é˜Ÿåä½œç®¡ç†**
   - å®¢æˆ·åˆ†é…ç®¡ç†
   - å·¥ä½œé‡ç»Ÿè®¡
   - ç»©æ•ˆè€ƒæ ¸æ”¯æŒ

## å…³é”®æŒ‡æ ‡
- æ€»å®¢æˆ·æ•°ï¼šæ‰€æœ‰å®¢æˆ·è®°å½•æ€»æ•°
- æœ¬æœˆæ–°å¢ï¼šå½“æœˆæ–°å¢å®¢æˆ·æ•°é‡
- æœªåˆ†é…å®¢æˆ·ï¼šå°šæœªæŒ‡å®šè´Ÿè´£äººçš„å®¢æˆ·
- æœ¬æœˆè½¬åŒ–ï¼šå½“æœˆæˆåŠŸè½¬åŒ–çš„å®¢æˆ·æ•°

## ä½¿ç”¨åœºæ™¯
é€‚ç”¨äºæ‹›ç”ŸåŠã€å¸‚åœºéƒ¨ã€é”€å”®å›¢é˜Ÿè¿›è¡Œå®¢æˆ·å…³ç³»ç®¡ç†å’Œæ‹›ç”Ÿè½¬åŒ–å·¥ä½œã€‚`,
    metadata: JSON.stringify({
      keywords: ['å®¢æˆ·æ± ', 'å®¢æˆ·ç®¡ç†', 'æ‹›ç”Ÿ', 'è½¬åŒ–ç‡', 'è·Ÿè¿›'],
      related_pages: ['/centers/customer-pool'],
      business_type: 'marketing',
      priority: 'high'
    })
  },
  {
    category: 'customer_management',
    title: 'å®¢æˆ·ä¿¡æ¯ç®¡ç†æŒ‡å—',
    content: `# å®¢æˆ·ä¿¡æ¯ç®¡ç†æŒ‡å—

## å®¢æˆ·ä¿¡æ¯ç»“æ„
å®¢æˆ·æ± ç³»ç»ŸåŒ…å«ä»¥ä¸‹æ ¸å¿ƒä¿¡æ¯å­—æ®µï¼š

### åŸºæœ¬ä¿¡æ¯
- **å§“å**ï¼šå®¢æˆ·å§“åï¼ˆå¿…å¡«ï¼‰
- **ç”µè¯**ï¼šè”ç³»ç”µè¯ï¼ˆå¿…å¡«ï¼Œæ”¯æŒæ‰‹æœºå’Œåº§æœºï¼‰
- **å¾®ä¿¡å·**ï¼šå¾®ä¿¡è”ç³»æ–¹å¼
- **é‚®ç®±**ï¼šç”µå­é‚®ä»¶åœ°å€

### ä¸šåŠ¡ä¿¡æ¯
- **å®¢æˆ·æ¥æº**ï¼šç½‘ç»œå’¨è¯¢ã€ç”µè¯å’¨è¯¢ã€æœ‹å‹æ¨èã€å¹¿å‘ŠæŠ•æ”¾ç­‰
- **å®¢æˆ·çŠ¶æ€**ï¼šæ–°å®¢æˆ·ã€å·²è”ç³»ã€æ„å‘å®¢æˆ·ã€å·²è½¬åŒ–ã€å·²æµå¤±
- **è´Ÿè´£äºº**ï¼šåˆ†é…çš„è·Ÿè¿›äººå‘˜
- **å¤‡æ³¨ä¿¡æ¯**ï¼šå…¶ä»–é‡è¦ä¿¡æ¯è®°å½•

### æ„å‘ä¿¡æ¯
- **å­©å­å¹´é¾„**ï¼šç›®æ ‡å­¦ç”Ÿå¹´é¾„
- **å…¥å›­æ—¶é—´**ï¼šæœŸæœ›å…¥å›­æ—¶é—´
- **ç­çº§åå¥½**ï¼šåå¥½çš„ç­çº§ç±»å‹
- **é¢„ç®—èŒƒå›´**ï¼šå®¶åº­é¢„ç®—æƒ…å†µ

## å®¢æˆ·ç®¡ç†æ“ä½œ

### æ–°å¢å®¢æˆ·
1. ç‚¹å‡»"æ–°å¢å®¢æˆ·"æŒ‰é’®
2. å¡«å†™å®¢æˆ·åŸºæœ¬ä¿¡æ¯
3. é€‰æ‹©å®¢æˆ·æ¥æº
4. åˆ†é…è´Ÿè´£äºº
5. ä¿å­˜å®¢æˆ·ä¿¡æ¯

### å®¢æˆ·åˆ†é…
- æ”¯æŒå•ä¸ªå®¢æˆ·åˆ†é…
- æ”¯æŒæ‰¹é‡å®¢æˆ·åˆ†é…
- å¯æ ¹æ®åœ°åŒºã€æ¥æºç­‰æ¡ä»¶æ™ºèƒ½åˆ†é…

### å®¢æˆ·çŠ¶æ€ç®¡ç†
- æ–°å®¢æˆ·ï¼šåˆšå½•å…¥ç³»ç»Ÿçš„å®¢æˆ·
- å·²è”ç³»ï¼šå·²è¿›è¡Œé¦–æ¬¡æ²Ÿé€š
- æ„å‘å®¢æˆ·ï¼šæœ‰æ˜ç¡®å…¥å›­æ„å‘
- å·²è½¬åŒ–ï¼šæˆåŠŸæŠ¥åå…¥å›­
- å·²æµå¤±ï¼šç¡®è®¤ä¸ä¼šå…¥å›­

## æ•°æ®å¯¼å…¥å¯¼å‡º
- æ”¯æŒExcelæ ¼å¼æ‰¹é‡å¯¼å…¥
- æ”¯æŒæ•°æ®å¤‡ä»½å¯¼å‡º
- æä¾›æ•°æ®æ¨¡æ¿ä¸‹è½½`,
    metadata: JSON.stringify({
      keywords: ['å®¢æˆ·ä¿¡æ¯', 'å®¢æˆ·åˆ†é…', 'çŠ¶æ€ç®¡ç†', 'æ•°æ®å¯¼å…¥'],
      related_tables: ['customer_pool', 'customer_assignments'],
      operation_type: 'management'
    })
  },
  {
    category: 'followup_system',
    title: 'è·Ÿè¿›è®°å½•ç³»ç»Ÿ',
    content: `# è·Ÿè¿›è®°å½•ç³»ç»Ÿ

## è·Ÿè¿›æ–¹å¼åˆ†ç±»

### ç”µè¯è·Ÿè¿›
- **é¦–æ¬¡è”ç³»**ï¼šç¡®è®¤å®¢æˆ·åŸºæœ¬ä¿¡æ¯å’Œéœ€æ±‚
- **æ·±åº¦æ²Ÿé€š**ï¼šè¯¦ç»†ä»‹ç»å¹¼å„¿å›­æƒ…å†µ
- **é¢„çº¦å‚è§‚**ï¼šé‚€è¯·å®åœ°å‚è§‚
- **ä»·æ ¼å’¨è¯¢**ï¼šè´¹ç”¨ç›¸å…³é—®é¢˜è§£ç­”

### å¾®ä¿¡è·Ÿè¿›
- **èµ„æ–™åˆ†äº«**ï¼šå‘é€å¹¼å„¿å›­ä»‹ç»ææ–™
- **å›¾ç‰‡å±•ç¤º**ï¼šåˆ†äº«å›­åŒºç¯å¢ƒç…§ç‰‡
- **è§†é¢‘ä»‹ç»**ï¼šåˆ†äº«æ•™å­¦æ´»åŠ¨è§†é¢‘
- **åœ¨çº¿ç­”ç–‘**ï¼šå®æ—¶å›å¤å®¢æˆ·ç–‘é—®

### é¢è°ˆè·Ÿè¿›
- **å›­åŒºå‚è§‚**ï¼šå®‰æ’å®åœ°å‚è§‚æ´»åŠ¨
- **é¢å¯¹é¢å’¨è¯¢**ï¼šæ·±åº¦äº¤æµå’Œç­”ç–‘
- **è¯•å¬ä½“éªŒ**ï¼šå®‰æ’è¯•å¬è¯¾ç¨‹
- **ç­¾çº¦æ´½è°ˆ**ï¼šæ­£å¼æŠ¥åæµç¨‹

### é‚®ä»¶è·Ÿè¿›
- **èµ„æ–™å‘é€**ï¼šé‚®ä»¶å‘é€è¯¦ç»†èµ„æ–™
- **å®šæœŸå›è®¿**ï¼šå®šæœŸé‚®ä»¶å…³æ€€
- **æ´»åŠ¨é‚€è¯·**ï¼šé‚€è¯·å‚åŠ å¹¼å„¿å›­æ´»åŠ¨

## è·Ÿè¿›è®°å½•è§„èŒƒ

### è®°å½•å†…å®¹è¦æ±‚
1. **è·Ÿè¿›æ—¶é—´**ï¼šå‡†ç¡®è®°å½•æ²Ÿé€šæ—¶é—´
2. **è·Ÿè¿›æ–¹å¼**ï¼šé€‰æ‹©å…·ä½“è·Ÿè¿›æ–¹å¼
3. **æ²Ÿé€šå†…å®¹**ï¼šè¯¦ç»†è®°å½•è°ˆè¯è¦ç‚¹
4. **å®¢æˆ·åé¦ˆ**ï¼šè®°å½•å®¢æˆ·æ€åº¦å’Œæ„è§
5. **ä¸‹æ¬¡è®¡åˆ’**ï¼šå®‰æ’ä¸‹æ¬¡è·Ÿè¿›æ—¶é—´å’Œæ–¹å¼

### è·Ÿè¿›ç»“æœåˆ†ç±»
- **ç§¯æ**ï¼šå®¢æˆ·è¡¨ç°å‡ºæ˜ç¡®å…´è¶£
- **ä¸€èˆ¬**ï¼šå®¢æˆ·æ€åº¦ä¸­æ€§ï¼Œéœ€ç»§ç»­è·Ÿè¿›
- **æ¶ˆæ**ï¼šå®¢æˆ·å…´è¶£ä¸å¤§ï¼Œè€ƒè™‘å…¶ä»–é€‰æ‹©
- **æ— æ•ˆ**ï¼šè”ç³»ä¸ä¸Šæˆ–æ˜ç¡®æ‹’ç»

### ä¸‹æ¬¡è·Ÿè¿›å®‰æ’
- **ç«‹å³è·Ÿè¿›**ï¼šå®¢æˆ·é«˜åº¦æ„å‘ï¼Œéœ€ç«‹å³å¤„ç†
- **3å¤©å†…**ï¼šå®¢æˆ·æœ‰å…´è¶£ï¼Œéœ€åŠæ—¶è·Ÿè¿›
- **1å‘¨å†…**ï¼šå®¢æˆ·æ€åº¦ä¸€èˆ¬ï¼Œå®šæœŸè”ç³»
- **1æœˆå†…**ï¼šå®¢æˆ·æš‚æ— éœ€æ±‚ï¼Œé•¿æœŸç»´æŠ¤

## è·Ÿè¿›æé†’ç³»ç»Ÿ
- è‡ªåŠ¨æé†’ä¸‹æ¬¡è·Ÿè¿›æ—¶é—´
- æ”¯æŒæå‰æé†’è®¾ç½®
- ç§»åŠ¨ç«¯æ¶ˆæ¯æ¨é€
- é‚®ä»¶æé†’åŠŸèƒ½`,
    metadata: JSON.stringify({
      keywords: ['è·Ÿè¿›è®°å½•', 'å®¢æˆ·æ²Ÿé€š', 'è·Ÿè¿›æé†’', 'è”ç³»æ–¹å¼'],
      related_tables: ['followup_records', 'customer_communications'],
      operation_type: 'tracking'
    })
  },
  {
    category: 'customer_analytics',
    title: 'å®¢æˆ·æ•°æ®åˆ†æ',
    content: `# å®¢æˆ·æ•°æ®åˆ†æ

## æ ¸å¿ƒåˆ†ææŒ‡æ ‡

### å®¢æˆ·è½¬åŒ–åˆ†æ
1. **æ€»ä½“è½¬åŒ–ç‡**
   - è®¡ç®—å…¬å¼ï¼šå·²è½¬åŒ–å®¢æˆ·æ•° / æ€»å®¢æˆ·æ•° Ã— 100%
   - è¡Œä¸šæ ‡å‡†ï¼šå¹¼æ•™è¡Œä¸šå¹³å‡è½¬åŒ–ç‡15-25%
   - ç›®æ ‡è®¾å®šï¼šæ ¹æ®å†å²æ•°æ®è®¾å®šåˆç†ç›®æ ‡

2. **æ¸ é“è½¬åŒ–ç‡**
   - ä¸åŒæ¥æºæ¸ é“çš„è½¬åŒ–æ•ˆæœå¯¹æ¯”
   - æŠ•å…¥äº§å‡ºæ¯”åˆ†æ
   - æ¸ é“ä¼˜åŒ–å»ºè®®

3. **æ—¶é—´æ®µè½¬åŒ–åˆ†æ**
   - æœˆåº¦è½¬åŒ–è¶‹åŠ¿
   - å­£èŠ‚æ€§å˜åŒ–è§„å¾‹
   - é«˜å³°æœŸè¯†åˆ«

### å®¢æˆ·æ¥æºåˆ†æ
1. **æ¸ é“åˆ†ç±»ç»Ÿè®¡**
   - ç½‘ç»œå’¨è¯¢ï¼šå®˜ç½‘ã€å¾®ä¿¡å…¬ä¼—å·ã€åœ¨çº¿å¹³å°
   - ç”µè¯å’¨è¯¢ï¼šç›´æ¥æ¥ç”µã€è½¬ä»‹ç»
   - çº¿ä¸‹æ¸ é“ï¼šå¹¿å‘ŠæŠ•æ”¾ã€æ´»åŠ¨æ¨å¹¿
   - å£ç¢‘æ¨èï¼šè€ç”Ÿå®¶é•¿æ¨è

2. **æ¸ é“æ•ˆæœè¯„ä¼°**
   - å„æ¸ é“å®¢æˆ·è´¨é‡å¯¹æ¯”
   - æˆæœ¬æ•ˆç›Šåˆ†æ
   - ROIè®¡ç®—

### è·Ÿè¿›æ•ˆæœåˆ†æ
1. **è·Ÿè¿›é¢‘æ¬¡ä¸è½¬åŒ–å…³ç³»**
   - æœ€ä½³è·Ÿè¿›æ¬¡æ•°ç»Ÿè®¡
   - è·Ÿè¿›é—´éš”æ—¶é—´åˆ†æ
   - è·Ÿè¿›æ–¹å¼æ•ˆæœå¯¹æ¯”

2. **é”€å”®äººå‘˜ç»©æ•ˆ**
   - ä¸ªäººè½¬åŒ–ç‡æ’å
   - è·Ÿè¿›è´¨é‡è¯„ä¼°
   - å·¥ä½œé‡ç»Ÿè®¡

## æ•°æ®å¯è§†åŒ–å›¾è¡¨

### è½¬åŒ–æ¼æ–—å›¾
æ˜¾ç¤ºä»æ–°å®¢æˆ·åˆ°æœ€ç»ˆè½¬åŒ–çš„å®Œæ•´æµç¨‹ï¼š
- æ–°å¢å®¢æˆ· â†’ é¦–æ¬¡è”ç³» â†’ æ·±åº¦æ²Ÿé€š â†’ é¢„çº¦å‚è§‚ â†’ ç­¾çº¦æˆåŠŸ

### æ¥æºåˆ†æé¥¼å›¾
æŒ‰å®¢æˆ·æ¥æºæ¸ é“å±•ç¤ºåˆ†å¸ƒæ¯”ä¾‹ï¼Œå¸®åŠ©ä¼˜åŒ–è¥é”€æŠ•å…¥ã€‚

### è½¬åŒ–è¶‹åŠ¿çº¿å›¾
æ˜¾ç¤ºæœˆåº¦è½¬åŒ–ç‡å˜åŒ–è¶‹åŠ¿ï¼Œè¯†åˆ«ä¸šåŠ¡å‘¨æœŸæ€§è§„å¾‹ã€‚

### è·Ÿè¿›æ•ˆæœæŸ±çŠ¶å›¾
å¯¹æ¯”ä¸åŒè·Ÿè¿›æ–¹å¼çš„è½¬åŒ–æ•ˆæœï¼Œä¼˜åŒ–è·Ÿè¿›ç­–ç•¥ã€‚

## æŠ¥è¡¨åŠŸèƒ½
1. **å®¢æˆ·æ¦‚è§ˆæŠ¥è¡¨**ï¼šæ•´ä½“å®¢æˆ·æ± çŠ¶å†µ
2. **è½¬åŒ–åˆ†ææŠ¥è¡¨**ï¼šè¯¦ç»†è½¬åŒ–æ•°æ®åˆ†æ
3. **æ¸ é“æ•ˆæœæŠ¥è¡¨**ï¼šå„æ¸ é“è¡¨ç°å¯¹æ¯”
4. **é”€å”®ç»©æ•ˆæŠ¥è¡¨**ï¼šå›¢é˜Ÿå’Œä¸ªäººç»©æ•ˆ

## æ•°æ®åº”ç”¨å»ºè®®
- å®šæœŸåˆ†æè½¬åŒ–ç‡å˜åŒ–ï¼ŒåŠæ—¶è°ƒæ•´é”€å”®ç­–ç•¥
- é‡ç‚¹æŠ•å…¥é«˜è½¬åŒ–ç‡æ¸ é“ï¼Œå‡å°‘ä½æ•ˆæ¸ é“æŠ•å…¥
- æ€»ç»“ä¼˜ç§€é”€å”®äººå‘˜ç»éªŒï¼Œæ¨å¹¿æœ€ä½³å®è·µ
- å»ºç«‹é¢„è­¦æœºåˆ¶ï¼ŒåŠæ—¶å‘ç°ä¸šåŠ¡å¼‚å¸¸`,
    metadata: JSON.stringify({
      keywords: ['æ•°æ®åˆ†æ', 'è½¬åŒ–ç‡', 'æ¸ é“åˆ†æ', 'é”€å”®ç»©æ•ˆ'],
      related_tables: ['customer_analytics', 'conversion_stats'],
      operation_type: 'analytics'
    })
  }
];

async function addCustomerPoolAIDocs() {
  let connection;
  
  try {
    // è¿æ¥æ•°æ®åº“
    connection = await mysql.createConnection(dbConfig);
    console.log('âœ… æ•°æ®åº“è¿æ¥æˆåŠŸ');
    
    // æ·»åŠ å®¢æˆ·æ± ä¸­å¿ƒAIçŸ¥è¯†åº“æ–‡æ¡£
    console.log('ğŸ”„ å¼€å§‹æ·»åŠ å®¢æˆ·æ± ä¸­å¿ƒAIçŸ¥è¯†åº“æ–‡æ¡£...');
    
    for (const doc of customerPoolDocs) {
      const query = `
        INSERT INTO ai_knowledge_base (category, title, content, metadata, created_at, updated_at)
        VALUES (?, ?, ?, ?, NOW(), NOW())
        ON DUPLICATE KEY UPDATE
        content = VALUES(content),
        metadata = VALUES(metadata),
        updated_at = NOW()
      `;
      
      await connection.execute(query, [
        doc.category,
        doc.title,
        doc.content,
        doc.metadata
      ]);
      
      console.log(`âœ… å·²æ·»åŠ æ–‡æ¡£: [${doc.category}] ${doc.title}`);
    }
    
    console.log(`ğŸ‰ æˆåŠŸæ·»åŠ  ${customerPoolDocs.length} ä¸ªå®¢æˆ·æ± ä¸­å¿ƒAIçŸ¥è¯†åº“æ–‡æ¡£`);
    
    // éªŒè¯æ·»åŠ ç»“æœ
    const [rows] = await connection.execute(
      'SELECT category, title FROM ai_knowledge_base WHERE category IN (?, ?, ?, ?) ORDER BY category',
      ['customer_pool_center', 'customer_management', 'followup_system', 'customer_analytics']
    );
    
    console.log('\nğŸ“Š å®¢æˆ·æ± ä¸­å¿ƒæ–‡æ¡£ç»Ÿè®¡:');
    rows.forEach((row, index) => {
      console.log(`  ${index + 1}. [${row.category}] ${row.title}`);
    });
    
  } catch (error) {
    console.error('âŒ æ·»åŠ AIçŸ¥è¯†åº“æ–‡æ¡£å¤±è´¥:', error.message);
    process.exit(1);
  } finally {
    if (connection) {
      await connection.end();
      console.log('ğŸ” æ•°æ®åº“è¿æ¥å·²å…³é—­');
    }
  }
}

// æ‰§è¡Œè„šæœ¬
addCustomerPoolAIDocs();