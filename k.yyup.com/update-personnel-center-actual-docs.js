import mysql from 'mysql2/promise';

const connection = await mysql.createConnection({
  host: 'localhost',
  user: 'root',
  password: '123456',
  database: 'lazy_ai_substitute_project'
});

// 先删除旧的人事中心文档
console.log('删除旧的人事中心AI知识库文档...');
await connection.execute(
  "DELETE FROM ai_knowledge_base WHERE category = '人事中心'"
);

const personnelCenterDocs = [
  {
    category: '人事中心',
    document_name: 'personnel_overview_dashboard',
    document_description: '人事中心概览仪表板功能说明',
    document_content: `# 人事中心概览仪表板

## 页面概述
人事中心是教师和学生管理的核心平台，提供全面的人员管理功能，包括教师信息、学生档案、家长管理、班级组织等。

## 主要功能区域

### 1. 欢迎区域
- **页面标题**：欢迎来到人事中心
- **功能描述**：这里是教师和学生管理的核心平台，您可以管理教师信息、学生档案、组织架构、人员培训
- **快速操作**：新建按钮，根据当前标签页创建对应类型的人员记录

### 2. 统计卡片区域
显示四个核心统计指标：
- **在校学生**：456人，较上月增长12人（主要类型：primary）
- **注册家长**：328人，较上月增长8人（主要类型：success）
- **在职教师**：45人，较上月增长2人（主要类型：warning）
- **开设班级**：18个，较上月增长1个（主要类型：info）

每个统计卡片都可点击跳转到对应的管理标签页

### 3. 图表展示区域
包含两个重要图表：
- **人员分布统计**：饼图显示学生、家长、教师、班级的分布情况
- **人员增长趋势**：折线图显示最近6个月教师、学生、家长的变化趋势

### 4. 快速操作区域
提供四个快速操作卡片：
- **新增学生**：添加新的学生信息
- **新增家长**：添加新的家长信息  
- **新增教师**：添加新的教师信息
- **新增班级**：创建新的班级

## 数据加载机制
- 概览数据通过personnelCenterApi.getOverview()获取
- 图表数据并行加载，分别调用getPersonnelDistribution()和getPersonnelTrend()
- 支持数据刷新和实时更新`
  },
  {
    category: '人事中心',
    document_name: 'student_management_system',
    document_description: '学生管理功能详解',
    document_content: `# 学生管理系统

## 页面布局
学生管理采用左右分栏布局：
- **左侧**：学生列表表格，支持分页、搜索、CRUD操作
- **右侧**：学生详情面板，显示选中学生的详细信息

## 学生列表功能

### 表格列信息
- **姓名**：学生真实姓名
- **学号**：唯一标识符
- **班级**：所属班级名称
- **性别**：男/女
- **年龄**：当前年龄
- **状态**：在读/休学/毕业（用不同颜色标签显示）
- **入学时间**：学生入学日期

### 操作功能
- **创建学生**：打开表单弹窗，填写学生基本信息
- **编辑学生**：修改学生信息
- **删除学生**：确认后删除学生记录
- **行点击**：选择学生查看详情
- **分页切换**：支持页码和每页条数变更
- **搜索功能**：根据条件筛选学生

## 学生详情面板

### 信息分组显示
1. **基本信息**：姓名、学号、性别、年龄、生日
2. **班级信息**：班级、入学时间、状态
3. **家长信息**：家长姓名、电话、邮箱
4. **成绩记录**：各科目成绩和等级评定

### 成绩显示
- 按科目显示分数
- 用不同颜色标签标识等级：优秀(≥90)、良好(≥80)、中等(≥70)、待提高(<70)
- 支持编辑和更新成绩记录

## 表单管理
- 新增/编辑学生使用统一表单组件
- 表单字段包含验证规则
- 支持下拉选择班级
- 自动保存并刷新列表数据

## 状态管理
- 学生状态：active(在读)、suspended(休学)、graduated(毕业)
- 状态变更会影响统计数据
- 不同状态用不同颜色标签区分`
  },
  {
    category: '人事中心',
    document_name: 'parent_management_system',
    document_description: '家长管理功能详解',
    document_content: `# 家长管理系统

## 页面布局
家长管理采用左右分栏布局：
- **左侧**：家长列表表格，包含详细的操作按钮
- **右侧**：家长详情面板，可编辑家长信息

## 家长列表功能

### 表格列信息
- **姓名**：家长真实姓名
- **手机号**：联系电话
- **邮箱**：电子邮箱地址
- **孩子**：关联的孩子姓名标签
- **状态**：正常/暂停（用颜色标签区分）
- **注册时间**：账户创建日期
- **操作**：查看、编辑、更多操作

### 高级操作功能
除了基本的增删改查，家长管理还提供：
- **孩子管理**：管理家长关联的孩子信息
- **沟通记录**：查看与家长的沟通历史
- **下拉菜单操作**：更多操作选项

## 家长详情面板

### 信息分组
1. **基本信息**：姓名、电话、邮箱、地址
2. **孩子信息**：关联的孩子列表
3. **沟通记录**：详细的沟通历史
4. **其他信息**：状态、注册时间、来源渠道

### 沟通记录功能
- **记录类型**：电话、访问、消息、邮件（用不同颜色标识）
- **时间轴显示**：按时间顺序展示沟通记录
- **内容详情**：每次沟通的具体内容
- **可编辑**：支持添加新的沟通记录

## 表单管理
创建/编辑家长表单包含：
- 基本信息字段：姓名、手机、邮箱、地址
- 关系选择：父亲、母亲、爷爷、奶奶、其他
- 职业信息：家长的工作职业

## 特色功能
- **孩子关联**：自动显示家长关联的所有孩子
- **智能通信**：支持多种沟通方式记录
- **状态管理**：active(正常)、inactive(暂停)
- **来源追踪**：记录家长的获客来源`
  },
  {
    category: '人事中心',
    document_name: 'teacher_management_system',
    document_description: '教师管理功能详解',
    document_content: `# 教师管理系统

## 页面布局
教师管理采用单列布局，专注于教师列表的展示和管理：

## 教师列表功能

### 表格列信息
- **姓名**：教师真实姓名
- **工号**：唯一员工标识
- **部门**：所属部门（教学部、行政部、后勤部）
- **职位**：具体职位名称
- **任教班级**：教师负责的班级（多个班级用标签显示）
- **状态**：在职/离职/休假（用颜色标签区分）
- **入职时间**：教师入职日期
- **操作**：编辑、删除按钮

### 操作功能
- **创建教师**：打开表单弹窗，录入教师基本信息
- **编辑教师**：使用专门的教师编辑对话框
- **删除教师**：确认后删除教师记录
- **班级显示**：用标签形式显示教师任教的多个班级

## 教师表单管理

### 新增教师表单字段
- **基本信息**：姓名、工号、手机号、邮箱
- **部门职位**：部门选择（下拉）、职位输入
- **时间信息**：入职时间（日期选择）
- **薪资信息**：薪资金额（可选）

### 编辑功能
- 使用专门的TeacherEditDialog组件
- 支持修改所有教师信息
- 保存后自动刷新教师列表

## 教师状态管理
- **在职(active)**：正常工作状态，绿色标签
- **离职(inactive)**：已离职状态，红色标签  
- **休假(leave)**：临时休假状态，橙色标签

## 部门管理
支持的部门类型：
- **教学部(teaching)**：负责教学工作的教师
- **行政部(admin)**：负责管理工作的人员
- **后勤部(logistics)**：负责后勤保障的人员

## 班级关联
- 教师可以关联多个班级
- 班级信息以标签形式在列表中显示
- 支持班级分配和调整

## 数据操作
- 分页加载教师数据
- 支持按条件搜索教师
- 异步删除和编辑操作
- 实时更新列表状态`
  },
  {
    category: '人事中心',
    document_name: 'class_management_system',
    document_description: '班级管理功能详解',
    document_content: `# 班级管理系统

## 页面布局
班级管理采用左右分栏布局：
- **左侧**：班级列表表格，展示所有班级信息
- **右侧**：班级详情面板，显示选中班级的详细信息

## 班级列表功能

### 表格列信息
- **班级名称**：班级的完整名称
- **年级**：小班/中班/大班
- **容量**：当前学生数/最大容量，包含进度条显示
- **班主任**：负责该班级的主要教师
- **教室**：班级所在的教室位置
- **状态**：正常/暂停运营状态
- **创建时间**：班级建立的日期

### 容量管理特色功能
- **可视化容量**：用进度条显示当前学生数量占最大容量的比例
- **容量警告**：当接近满员时可能有视觉提示
- **动态更新**：学生转入转出时自动更新容量显示

## 班级详情面板

### 信息分组
1. **基本信息**：名称、年级、教室、最大容量
2. **教师信息**：班主任、副班主任
3. **学生信息**：班级学生列表，头像网格显示
4. **其他信息**：状态、创建时间、班级描述

### 学生展示功能
- **学生网格**：以卡片形式展示班级所有学生
- **头像显示**：每个学生显示头像和姓名
- **响应式布局**：自动适应不同屏幕尺寸
- **快速识别**：通过头像快速识别班级成员

## 班级表单管理

### 新增班级表单
- **基本设置**：班级名称、年级选择、最大容量
- **教室分配**：教室位置输入
- **教师分配**：班主任、副班主任选择（下拉选择）
- **描述信息**：班级特色描述（多行文本）

### 编辑功能
- 支持修改班级基本信息
- 更新教师分配
- 调整容量设置
- 状态管理（正常/暂停）

## 年级分类
- **小班(small)**：适合较小年龄段的幼儿
- **中班(medium)**：中等年龄段的幼儿班级
- **大班(large)**：大年龄段，准备升学的幼儿

## 班级状态管理
- **正常(active)**：正常运营的班级
- **暂停(inactive)**：临时停课或暂不招生的班级

## 数据关联
- 与教师系统联动，显示班主任信息
- 与学生系统联动，实时显示班级学生
- 容量数据自动计算和更新
- 支持跨系统数据一致性维护`
  }
];

console.log('开始添加基于实际页面内容的人事中心AI知识库文档...');

for (const doc of personnelCenterDocs) {
  try {
    const [result] = await connection.execute(
      'INSERT INTO ai_knowledge_base (category, document_name, document_description, document_content, created_at, updated_at) VALUES (?, ?, ?, ?, NOW(), NOW())',
      [doc.category, doc.document_name, doc.document_description, doc.document_content]
    );
    
    console.log(`✅ 成功添加文档: ${doc.document_name} (ID: ${result.insertId})`);
  } catch (error) {
    console.error(`❌ 添加文档失败: ${doc.document_name}`, error.message);
  }
}

await connection.end();
console.log('人事中心AI知识库文档更新完成！');