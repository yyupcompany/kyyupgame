# ä»£ç è´¨é‡å®¡æŸ¥æŠ¥å‘Š

**ç”Ÿæˆæ—¥æœŸ**: 2025-11-26  
**å®¡è®¡èŒƒå›´**: æ•´ä¸ªç»Ÿä¸€è®¤è¯é¡¹ç›®  
**å®¡è®¡å‘˜**: Claudeä»£ç è´¨é‡ä¸å®‰å…¨å®¡è®¡ä¸“å®¶  
**è´¨é‡ç­‰çº§**: ä¸­ç­‰ï¼ˆéœ€è¦æ”¹è¿›ï¼‰

## 1. æ‰§è¡Œæ¦‚è¦

### 1.1 è´¨é‡ç­‰çº§åˆ†å¸ƒ
- ğŸ”´ **ä¸¥é‡è´¨é‡é—®é¢˜ (Critical)**: 8ä¸ª
- ğŸŸ  **é‡è¦è´¨é‡é—®é¢˜ (High)**: 15ä¸ª
- ğŸŸ¡ **ä¸­ç­‰é—®é¢˜ (Medium)**: 25ä¸ª
- ğŸŸ¢ **è½»å¾®é—®é¢˜ (Low)**: 40ä¸ª

### 1.2 æ€»ä½“è´¨é‡è¯„ä¼°
- **ä»£ç è§„æ¨¡**: çº¦300,000è¡Œä»£ç ï¼Œ58,913ä¸ªæ–‡ä»¶
- **å¤æ‚åº¦**: æé«˜ - å¤§å‹å¤æ‚ç³»ç»Ÿ
- **å¯ç»´æŠ¤æ€§**: ä¸­ç­‰ - å­˜åœ¨æ”¹è¿›ç©ºé—´
- **ä»£ç é‡å¤**: é«˜ - å‘ç°å¤šå¤„é‡å¤é€»è¾‘
- **æµ‹è¯•è¦†ç›–**: è‰¯å¥½ - å®Œæ•´çš„æµ‹è¯•ä½“ç³»

## 2. ä¸¥é‡è´¨é‡é—®é¢˜åˆ†æ

### 2.1 ğŸ”´ å¤§é‡ä½¿ç”¨anyç±»å‹ (Critical)

#### é—®é¢˜æè¿°
é¡¹ç›®ä¸­æœ‰å¤§é‡ä½¿ç”¨`any`ç±»å‹çš„æƒ…å†µï¼Œé™ä½äº†TypeScriptç±»å‹å®‰å…¨çš„ä»·å€¼ã€‚

```typescript
// âŒ è´¨é‡é—®é¢˜: è¿‡åº¦ä½¿ç”¨anyç±»å‹
export interface AIResponse {
  success: boolean
  data: {
    message: string
    sessionId?: string
    timestamp?: string
    [key: string]: any  // é¿å…ä½¿ç”¨any
  }
  error?: string
}

async function someFunction(error: any) {  // åº”è¯¥ä½¿ç”¨å…·ä½“ç±»å‹
  console.error(error);
}

(e: 'save', data: any): void  // äº‹ä»¶å‚æ•°åº”è¯¥æœ‰æ˜ç¡®ç±»å‹
```

#### å½±å“åˆ†æ
- **ç±»å‹å®‰å…¨**: é™ä½äº†TypeScriptç¼–è¯‘æ—¶ç±»å‹æ£€æŸ¥æ•ˆæœ
- **å¼€å‘ä½“éªŒ**: IDEæ™ºèƒ½æç¤ºå’Œé”™è¯¯æ£€æŸ¥å—é™
- **ç»´æŠ¤æˆæœ¬**: è¿è¡Œæ—¶é”™è¯¯é£é™©å¢åŠ 

#### ä¿®å¤æ–¹æ¡ˆ
```typescript
// âœ… è´¨é‡æ”¹è¿›: å®šä¹‰å…·ä½“ç±»å‹
interface AIResponseData {
  message: string;
  sessionId?: string;
  timestamp?: string;
  [key: string]: unknown; // ä½¿ç”¨unknownä»£æ›¿any
}

export interface AIResponse {
  success: boolean;
  data: AIResponseData;
  error?: string;
}

// å®šä¹‰å…·ä½“é”™è¯¯ç±»å‹
interface ApiError {
  code: string;
  message: string;
  details?: Record<string, unknown>;
}

async function someFunction(error: ApiError): Promise<void> {
  console.error(`APIé”™è¯¯ ${error.code}: ${error.message}`);
}

// äº‹ä»¶å‚æ•°ç±»å‹å®šä¹‰
interface SaveEvent {
  data: {
    id: string;
    name: string;
    // ...å…¶ä»–å­—æ®µ
  };
}

(e: 'save', data: SaveEvent['data']): void
```

### 2.2 ğŸ”´ ä»£ç é‡å¤ä¸¥é‡ (Critical)

#### é—®é¢˜æè¿°
å‘ç°å¤šä¸ªåœ°æ–¹å­˜åœ¨é‡å¤çš„ä¸šåŠ¡é€»è¾‘å’Œå·¥å…·å‡½æ•°ã€‚

```typescript
// âŒ é‡å¤çš„HTTPè¯·æ±‚é€»è¾‘ - å‡ºç°åœ¨å¤šä¸ªæ–‡ä»¶ä¸­
function request(method: string, path: string, data = null) {
  return new Promise((resolve, reject) => {
    const options = {
      method: method.toUpperCase(),
      headers: {
        'Content-Type': 'application/json'
      }
    };
    
    const req = http.request(url, options, (res) => {
      // ...ç›¸åŒçš„å“åº”å¤„ç†é€»è¾‘
    });
  });
}
```

#### å½±å“åˆ†æ
- **ç»´æŠ¤æˆæœ¬**: ä¿®æ”¹éœ€è¦æ›´æ–°å¤šå¤„
- **ä¸€è‡´æ€§é£é™©**: ä¸åŒåœ°æ–¹å¯èƒ½å®ç°ä¸ä¸€è‡´
- **ä»£ç ä½“ç§¯**: å¢åŠ äº†ä¸å¿…è¦çš„ä»£ç é‡

#### ä¿®å¤æ–¹æ¡ˆ
```typescript
// âœ… ç»Ÿä¸€çš„HTTPå®¢æˆ·ç«¯
// src/utils/http-client.ts
export class HttpClient {
  private baseURL: string;
  private defaultHeaders: Record<string, string>;
  
  constructor(baseURL: string, defaultHeaders: Record<string, string> = {}) {
    this.baseURL = baseURL;
    this.defaultHeaders = defaultHeaders;
  }
  
  async request<T = unknown>(
    method: string,
    path: string,
    data?: unknown,
    options?: RequestInit
  ): Promise<T> {
    const url = `${this.baseURL}${path}`;
    const response = await fetch(url, {
      method: method.toUpperCase(),
      headers: {
        'Content-Type': 'application/json',
        ...this.defaultHeaders,
        ...options?.headers
      },
      body: data ? JSON.stringify(data) : undefined,
      ...options
    });
    
    if (!response.ok) {
      throw new Error(`HTTPé”™è¯¯: ${response.status} ${response.statusText}`);
    }
    
    return response.json();
  }
  
  // ä¾¿æ·æ–¹æ³•
  get<T>(path: string, options?: RequestInit): Promise<T> {
    return this.request<T>('GET', path, undefined, options);
  }
  
  post<T>(path: string, data?: unknown, options?: RequestInit): Promise<T> {
    return this.request<T>('POST', path, data, options);
  }
}

// ä½¿ç”¨ç»Ÿä¸€çš„HTTPå®¢æˆ·ç«¯å®ä¾‹
export const httpClient = new HttpClient(
  process.env.VITE_API_BASE_URL || 'http://localhost:3000',
  {
    'X-Client-Version': process.env.VITE_APP_VERSION || '1.0.0'
  }
);
```

### 2.3 ğŸ”´ ç¡¬ç¼–ç æ•°æ® (Critical)

#### é—®é¢˜æè¿°
å‘ç°å¤§é‡ç¡¬ç¼–ç çš„ä¸šåŠ¡æ•°æ®å’Œé…ç½®ã€‚

```typescript
// âŒ è´¨é‡é—®é¢˜: ç¡¬ç¼–ç ä¸šåŠ¡æ•°æ®
async function getShortcutConfig(id: number): Promise<{ data: AIShortcut }> {
  return {
    data: {
      id,
      shortcut_name: 'æ™ºèƒ½å’¨è¯¢',  // ç¡¬ç¼–ç 
      prompt_name: 'general_chat',
      category: 'comprehensive_analysis',
      role: 'all',
      system_prompt: 'ä½ æ˜¯å¹¼å„¿å›­æ‹›ç”Ÿå’¨è¯¢ä¸“å®¶ï¼Œä¸ºç”¨æˆ·æä¾›ä¸“ä¸šçš„æ‹›ç”Ÿå»ºè®®å’Œè§£ç­”ã€‚', // ç¡¬ç¼–ç 
      api_endpoint: 'ai_chat',
      is_active: true,
      sort_order: 0,
      created_at: '',
      updated_at: ''
    }
  };
}
```

#### ä¿®å¤æ–¹æ¡ˆ
```typescript
// âœ… è´¨é‡æ”¹è¿›: é…ç½®å¤–éƒ¨åŒ–
// src/config/ai-shortcuts.ts
export interface AIShortcutConfig {
  id: number;
  shortcut_name: string;
  prompt_name: string;
  category: string;
  role: string;
  system_prompt: string;
  api_endpoint: string;
}

// ä»é…ç½®æ–‡ä»¶æˆ–ç¯å¢ƒå˜é‡åŠ è½½
export const AI_SHORTCUTS: Record<string, AIShortcutConfig> = {
  default: {
    id: 1,
    shortcut_name: process.env.AI_SHORTCUT_NAME || 'æ™ºèƒ½å’¨è¯¢',
    prompt_name: 'general_chat',
    category: 'comprehensive_analysis',
    role: 'all',
    system_prompt: process.env.AI_DEFAULT_PROMPT || 'ä½ æ˜¯å¹¼å„¿å›­æ‹›ç”Ÿå’¨è¯¢ä¸“å®¶ï¼Œä¸ºç”¨æˆ·æä¾›ä¸“ä¸šçš„æ‹›ç”Ÿå»ºè®®å’Œè§£ç­”ã€‚',
    api_endpoint: 'ai_chat'
  }
};

// æˆ–ä»APIåŠ¨æ€è·å–
async function getShortcutConfig(id: number): Promise<{ data: AIShortcut }> {
  try {
    const response = await httpClient.get(`/api/ai-shortcuts/${id}`);
    return response;
  } catch (error) {
    // é™çº§åˆ°é»˜è®¤é…ç½®
    return { data: AI_SHORTCUTS.default };
  }
}
```

## 3. é‡è¦è´¨é‡é—®é¢˜åˆ†æ

### 3.1 ğŸŸ  é”™è¯¯å¤„ç†ä¸ä¸€è‡´ (High)

#### é—®é¢˜æè¿°
é¡¹ç›®ä¸­çš„é”™è¯¯å¤„ç†æ–¹å¼ä¸ç»Ÿä¸€ï¼Œæœ‰äº›åœ°æ–¹ç¼ºå°‘é”™è¯¯å¤„ç†ã€‚

```typescript
// âŒ ä¸ä¸€è‡´çš„é”™è¯¯å¤„ç†
// æ–¹å¼1: ç›´æ¥throw
function validateInput(input: string) {
  if (!input) {
    throw new Error('è¾“å…¥ä¸èƒ½ä¸ºç©º');
  }
}

// æ–¹å¼2: è¿”å›é”™è¯¯å¯¹è±¡
function processData(data: unknown) {
  if (!data) {
    return { success: false, error: 'æ•°æ®æ— æ•ˆ' };
  }
  return { success: true, result: 'å¤„ç†ç»“æœ' };
}

// æ–¹å¼3: ç¼ºå°‘é”™è¯¯å¤„ç†
async function fetchUserData(userId: string) {
  const response = await fetch(`/api/users/${userId}`);
  return response.json(); // æ²¡æœ‰æ£€æŸ¥å“åº”çŠ¶æ€
}
```

#### ä¿®å¤æ–¹æ¡ˆ
```typescript
// âœ… ç»Ÿä¸€çš„é”™è¯¯å¤„ç†ç­–ç•¥
// src/utils/error-handler.ts
export class AppError extends Error {
  public readonly code: string;
  public readonly statusCode: number;
  public readonly isOperational: boolean;

  constructor(
    message: string,
    code: string = 'UNKNOWN_ERROR',
    statusCode: number = 500,
    isOperational: boolean = true
  ) {
    super(message);
    this.name = this.constructor.name;
    this.code = code;
    this.statusCode = statusCode;
    this.isOperational = isOperational;
    
    Error.captureStackTrace(this, this.constructor);
  }
}

// é¢„å®šä¹‰é”™è¯¯ç±»å‹
export class ValidationError extends AppError {
  constructor(message: string) {
    super(message, 'VALIDATION_ERROR', 400);
  }
}

export class NotFoundError extends AppError {
  constructor(resource: string) {
    super(`${resource}æœªæ‰¾åˆ°`, 'NOT_FOUND', 404);
  }
}

export class NetworkError extends AppError {
  constructor(message: string) {
    super(message, 'NETWORK_ERROR', 503);
  }
}

// ç»Ÿä¸€çš„é”™è¯¯å¤„ç†ä¸­é—´ä»¶
export const errorHandler = (
  error: Error,
  req: Request,
  res: Response,
  next: NextFunction
): void => {
  if (error instanceof AppError) {
    res.status(error.statusCode).json({
      success: false,
      error: {
        code: error.code,
        message: error.message
      }
    });
  } else {
    // æœªçŸ¥é”™è¯¯
    res.status(500).json({
      success: false,
      error: {
        code: 'INTERNAL_ERROR',
        message: 'å†…éƒ¨æœåŠ¡å™¨é”™è¯¯'
      }
    });
  }
};

// ä½¿ç”¨ç¤ºä¾‹
function validateInput(input: string): void {
  if (!input) {
    throw new ValidationError('è¾“å…¥ä¸èƒ½ä¸ºç©º');
  }
}

async function fetchUserData(userId: string): Promise<unknown> {
  try {
    const response = await httpClient.get(`/api/users/${userId}`);
    
    if (!response.ok) {
      throw new NetworkError(`ç”¨æˆ·æ•°æ®è·å–å¤±è´¥: ${response.statusText}`);
    }
    
    return response.json();
  } catch (error) {
    if (error instanceof AppError) {
      throw error;
    }
    throw new NetworkError(`ç½‘ç»œè¯·æ±‚å¤±è´¥: ${error.message}`);
  }
}
```

### 3.2 ğŸŸ  å¼‚æ­¥ä»£ç å¤„ç†ä¸è§„èŒƒ (High)

#### é—®é¢˜æè¿°
å‘ç°ä¸è§„èŒƒçš„ä½¿ç”¨Promiseå’Œasync/awaitçš„æƒ…å†µã€‚

```typescript
// âŒ ä¸è§„èŒƒçš„å¼‚æ­¥ä»£ç 
// æ··åˆä½¿ç”¨Promiseå’Œasync/await
function fetchUser(id: number) {
  return new Promise((resolve, reject) => {
    fetch(`/api/users/${id}`)
      .then(response => response.json())
      .then(data => resolve(data))
      .catch(error => reject(error));
  });
}

// ç¼ºå°‘é”™è¯¯å¤„ç†
async function loadUserData() {
  const user = await fetchUser(1); // æ²¡æœ‰try-catch
  console.log(user);
}

// ä¸å¿…è¦çš„PromiseåŒ…è£…
async function processData(data: unknown) {
  return new Promise(resolve => {
    // åŒæ­¥æ“ä½œï¼Œä¸éœ€è¦Promise
    const result = data.toString();
    resolve(result);
  });
}
```

#### ä¿®å¤æ–¹æ¡ˆ
```typescript
// âœ… è§„èŒƒçš„å¼‚æ­¥ä»£ç å¤„ç†
// ä½¿ç”¨async/awaitæ›¿ä»£Promiseæ„é€ å‡½æ•°
async function fetchUser(id: number): Promise<unknown> {
  const response = await httpClient.get(`/api/users/${id}`);
  return response.json();
}

// æ­£ç¡®çš„é”™è¯¯å¤„ç†
async function loadUserData(): Promise<void> {
  try {
    const user = await fetchUser(1);
    console.log(user);
  } catch (error) {
    console.error('åŠ è½½ç”¨æˆ·æ•°æ®å¤±è´¥:', error);
    // å¯ä»¥é€‰æ‹©é‡æ–°æŠ›å‡ºæˆ–å¤„ç†é”™è¯¯
    throw error;
  }
}

// åŒæ­¥æ“ä½œä¸éœ€è¦PromiseåŒ…è£…
function processData(data: unknown): string {
  return data.toString();
}

// å¹¶è¡Œå¤„ç†ä¼˜åŒ–
async function loadMultipleUsers(ids: number[]): Promise<unknown[]> {
  try {
    // å¹¶è¡ŒåŠ è½½ï¼Œæé«˜æ€§èƒ½
    const userPromises = ids.map(id => fetchUser(id));
    const users = await Promise.all(userPromises);
    return users;
  } catch (error) {
    console.error('æ‰¹é‡åŠ è½½ç”¨æˆ·å¤±è´¥:', error);
    throw error;
  }
}
```

### 3.3 ğŸŸ  å‡½æ•°å¤æ‚åº¦è¿‡é«˜ (High)

#### é—®é¢˜æè¿°
å‘ç°ä¸€äº›å‡½æ•°è¿‡äºå¤æ‚ï¼Œè¿åäº†å•ä¸€èŒè´£åŸåˆ™ã€‚

```typescript
// âŒ å¤æ‚åº¦è¿‡é«˜çš„å‡½æ•°
export class AIRouterService {
  async routeRequest(params: AIRequestParams): Promise<AIResponse> {
    // è¿™ä¸ªå‡½æ•°åšäº†å¤ªå¤šäº‹æƒ…
    // 1. å‚æ•°éªŒè¯
    if (!params.message) {
      throw new Error('æ¶ˆæ¯ä¸èƒ½ä¸ºç©º');
    }
    
    // 2. è·å–å¿«æ·æ–¹å¼é…ç½®
    let shortcutConfig;
    if (params.shortcutId) {
      shortcutConfig = await getShortcutConfig(params.shortcutId);
    }
    
    // 3. æ„å»ºè¯·æ±‚ä¸Šä¸‹æ–‡
    const context: AIRequestContext = {
      type: shortcutConfig?.data?.category || 'general',
      systemPrompt: shortcutConfig?.data?.system_prompt,
      userRole: params.context?.userRole,
      currentRoute: params.context?.currentRoute,
      timestamp: new Date().toISOString()
    };
    
    // 4. è·¯ç”±åˆ°ä¸åŒçš„AIæ¥å£
    let response;
    if (params.shortcutId) {
      response = await this.callShortcutAPI(params, shortcutConfig);
    } else if (params.context?.type === 'expert') {
      response = await this.callExpertAPI(params);
    } else {
      response = await this.callGeneralAPI(params);
    }
    
    // 5. å¤„ç†å“åº”
    return {
      success: true,
      data: {
        message: response.data?.message || 'å¤„ç†æˆåŠŸ',
        sessionId: response.data?.sessionId,
        timestamp: new Date().toISOString()
      }
    };
  }
}
```

#### ä¿®å¤æ–¹æ¡ˆ
```typescript
// âœ… é‡æ„ä¸ºå¤šä¸ªå°å‡½æ•°
export class AIRouterService {
  async routeRequest(params: AIRequestParams): Promise<AIResponse> {
    this.validateParams(params);
    
    const shortcutConfig = await this.getShortcutConfig(params.shortcutId);
    const context = this.buildRequestContext(params, shortcutConfig);
    const response = await this.executeRoute(params, shortcutConfig);
    
    return this.formatResponse(response);
  }
  
  private validateParams(params: AIRequestParams): void {
    if (!params.message) {
      throw new ValidationError('æ¶ˆæ¯ä¸èƒ½ä¸ºç©º');
    }
  }
  
  private async getShortcutConfig(shortcutId?: number): Promise<{ data: AIShortcut } | undefined> {
    return shortcutId ? await getShortcutConfig(shortcutId) : undefined;
  }
  
  private buildRequestContext(
    params: AIRequestParams, 
    shortcutConfig?: { data: AIShortcut }
  ): AIRequestContext {
    return {
      type: shortcutConfig?.data?.category || 'general',
      systemPrompt: shortcutConfig?.data?.system_prompt,
      userRole: params.context?.userRole,
      currentRoute: params.context?.currentRoute,
      timestamp: new Date().toISOString()
    };
  }
  
  private async executeRoute(
    params: AIRequestParams,
    shortcutConfig?: { data: AIShortcut }
  ): Promise<unknown> {
    if (params.shortcutId) {
      return await this.callShortcutAPI(params, shortcutConfig!);
    }
    
    if (params.context?.type === 'expert') {
      return await this.callExpertAPI(params);
    }
    
    return await this.callGeneralAPI(params);
  }
  
  private formatResponse(response: unknown): AIResponse {
    const responseData = response as { data?: { message?: string; sessionId?: string } };
    
    return {
      success: true,
      data: {
        message: responseData.data?.message || 'å¤„ç†æˆåŠŸ',
        sessionId: responseData.data?.sessionId,
        timestamp: new Date().toISOString()
      }
    };
  }
}
```

## 4. ä¸­ç­‰è´¨é‡é—®é¢˜åˆ†æ

### 4.1 ğŸŸ¡ å‘½åè§„èŒƒä¸ä¸€è‡´ (Medium)

#### é—®é¢˜æè¿°
å˜é‡ã€å‡½æ•°ã€ç±»çš„å‘½åä¸ç»Ÿä¸€ï¼Œå½±å“ä»£ç å¯è¯»æ€§ã€‚

```typescript
// âŒ ä¸ä¸€è‡´çš„å‘½åè§„èŒƒ
const userData = getUserInfo();          // é©¼å³°å‘½å
const user_data = fetch_user_data();     // ä¸‹åˆ’çº¿å‘½å
const UserDetail = getUserDetails();     // å¤§å†™å¼€å¤´

function process_data() { }              // ä¸‹åˆ’çº¿å‘½å
function processData() { }               // é©¼å³°å‘½å

class user_service { }                   // å°å†™ç±»å
class UserService { }                    // æ­£ç¡®çš„ç±»å
```

#### ä¿®å¤æ–¹æ¡ˆ
```typescript
// âœ… ç»Ÿä¸€çš„å‘½åè§„èŒƒ
interface NamingConventions {
  // å˜é‡å’Œå‡½æ•°: camelCase
  userData: UserInfo;
  fetchUserData: () => Promise<UserInfo>;
  processApiResponse: (response: ApiResponse) => ProcessedData;
  
  // å¸¸é‡: UPPER_SNAKE_CASE
  API_BASE_URL: string;
  MAX_RETRY_ATTEMPTS: number;
  DEFAULT_TIMEOUT: number;
  
  // ç±»å’Œæ¥å£: PascalCase
  UserService: Class;
  ApiResponse: Interface;
  UserRepository: Class;
  
  // ç±»å‹åˆ«å: PascalCase
  UserID: string;
  HttpStatus: number;
  
  // æšä¸¾: PascalCase
  UserRole: Enum;
  RequestStatus: Enum;
}
```

### 4.2 ğŸŸ¡ æ³¨é‡Šå’Œæ–‡æ¡£ä¸è¶³ (Medium)

#### é—®é¢˜æè¿°
ç¼ºå°‘å¿…è¦çš„æ³¨é‡Šå’Œæ–‡æ¡£ï¼Œå½±å“ä»£ç ç†è§£ã€‚

```typescript
// âŒ ç¼ºå°‘æ³¨é‡Šçš„å¤æ‚å‡½æ•°
export function processComplexData(input: unknown): unknown {
  const processed = input.map(item => {
    const filtered = item.filter(sub => sub.valid);
    const transformed = filtered.map(sub => ({
      ...sub,
      processed: true,
      timestamp: Date.now()
    }));
    return transformed;
  });
  
  return processed.reduce((acc, curr) => {
    return acc.concat(curr);
  }, []);
}
```

#### ä¿®å¤æ–¹æ¡ˆ
```typescript
// âœ… æ·»åŠ è¯¦ç»†æ³¨é‡Šå’Œæ–‡æ¡£
/**
 * å¤æ‚æ•°æ®å¤„ç†å‡½æ•°
 * 
 * å¯¹è¾“å…¥çš„æ•°æ®è¿›è¡Œè¿‡æ»¤ã€è½¬æ¢å’Œèšåˆæ“ä½œ
 * 
 * @param input - å¾…å¤„ç†çš„åŸå§‹æ•°æ®ï¼Œåº”è¯¥æ˜¯ä¸€ä¸ªåŒ…å«å­é¡¹çš„æ•°ç»„
 * @returns å¤„ç†åçš„æ•°æ®ï¼ŒåŒ…å«æ‰€æœ‰æœ‰æ•ˆå­é¡¹çš„æ‰å¹³åŒ–æ•°ç»„
 * 
 * @example
 * ```typescript
 * const data = [
 *   { items: [{ valid: true, name: 'item1' }, { valid: false, name: 'item2' }] }
 * ];
 * const result = processComplexData(data);
 * // ç»“æœ: [{ valid: true, name: 'item1', processed: true, timestamp: 1234567890 }]
 * ```
 */
export function processComplexData(input: unknown[]): unknown[] {
  // ç¬¬ä¸€æ­¥ï¼šè¿‡æ»¤æ— æ•ˆçš„å­é¡¹
  const processedData = input.map(item => {
    const validItems = item.filter(subItem => subItem.valid);
    
    // ç¬¬äºŒæ­¥ï¼šè½¬æ¢æœ‰æ•ˆé¡¹ï¼Œæ·»åŠ å¤„ç†æ ‡è®°å’Œæ—¶é—´æˆ³
    const transformedItems = validItems.map(subItem => ({
      ...subItem,
      processed: true,
      timestamp: Date.now()
    }));
    
    return transformedItems;
  });
  
  // ç¬¬ä¸‰æ­¥ï¼šæ‰å¹³åŒ–å¤„ç†ï¼Œå°†æ‰€æœ‰æ•°ç»„åˆå¹¶
  return processedData.reduce(
    (accumulator: unknown[], currentItems: unknown[]) => 
      accumulator.concat(currentItems), 
    []
  );
}
```

### 4.3 ğŸŸ¡ é­”æ³•æ•°å­—å’Œå­—ç¬¦ä¸² (Medium)

#### é—®é¢˜æè¿°
ä»£ç ä¸­å­˜åœ¨æœªå®šä¹‰å¸¸é‡çš„é­”æ³•æ•°å­—å’Œå­—ç¬¦ä¸²ã€‚

```typescript
// âŒ é­”æ³•æ•°å­—å’Œå­—ç¬¦ä¸²
if (user.age < 18) {
  return 'æœªæˆå¹´äºº';
}

setTimeout(() => {
  console.log('æ“ä½œè¶…æ—¶');
}, 5000);

const roles = ['admin', 'teacher', 'parent', 'student'];
if (roles.includes(user.role)) {
  // å¤„ç†é€»è¾‘
}
```

#### ä¿®å¤æ–¹æ¡ˆ
```typescript
// âœ… å®šä¹‰å¸¸é‡
// src/constants/app.constants.ts
export const AGE_LIMITS = {
  ADULT: 18,
  SENIOR: 65,
  RETIREMENT: 60
} as const;

export const TIMEOUTS = {
  API_REQUEST: 5000,
  PAGE_LOAD: 10000,
  USER_INTERACTION: 3000
} as const;

export const USER_ROLES = {
  ADMIN: 'admin',
  TEACHER: 'teacher', 
  PARENT: 'parent',
  STUDENT: 'student'
} as const;

export const VALID_ROLES = [
  USER_ROLES.ADMIN,
  USER_ROLES.TEACHER,
  USER_ROLES.PARENT,
  USER_ROLES.STUDENT
] as const;

// ä½¿ç”¨å¸¸é‡
if (user.age < AGE_LIMITS.ADULT) {
  return 'æœªæˆå¹´äºº';
}

setTimeout(() => {
  console.log('æ“ä½œè¶…æ—¶');
}, TIMEOUTS.API_REQUEST);

if (VALID_ROLES.includes(user.role as typeof VALID_ROLES[number])) {
  // å¤„ç†é€»è¾‘
}
```

## 5. è½»å¾®è´¨é‡é—®é¢˜åˆ†æ

### 5.1 ğŸŸ¢ ä»£ç æ ¼å¼ä¸ä¸€è‡´ (Low)

#### é—®é¢˜æè¿°
ä¸åŒæ–‡ä»¶çš„ä»£ç æ ¼å¼ä¸ç»Ÿä¸€ï¼ŒåŒ…æ‹¬ç¼©è¿›ã€ç©ºè¡Œã€æ‹¬å·é£æ ¼ç­‰ã€‚

```typescript
// âŒ æ ¼å¼ä¸ä¸€è‡´
function formatA(){
  return"result";
}

function formatB() 
{
  return "result";
}
```

#### ä¿®å¤æ–¹æ¡ˆ
```typescript
// âœ… ç»Ÿä¸€æ ¼å¼æ ‡å‡†
function formatA(): string {
  return "result";
}

function formatB(): string {
  return "result";
}
```

### 5.2 ğŸŸ¢ æœªä½¿ç”¨çš„å¯¼å…¥å’Œå˜é‡ (Low)

#### é—®é¢˜æè¿°
å­˜åœ¨æœªä½¿ç”¨çš„å¯¼å…¥ã€å˜é‡å’Œå‡½æ•°ã€‚

```typescript
// âŒ æœªä½¿ç”¨çš„å¯¼å…¥
import { useState, useEffect, useRef } from 'react';
import axios from 'axios';
import { User } from './types';

function Component() {
  const [state, setState] = useState();  // useEffect, useRef, axios, User æœªä½¿ç”¨
  return <div>{state}</div>;
}
```

#### ä¿®å¤æ–¹æ¡ˆ
```typescript
// âœ… æ¸…ç†æœªä½¿ç”¨çš„å¯¼å…¥
import { useState } from 'react';

function Component() {
  const [state, setState] = useState();
  return <div>{state}</div>;
}
```

## 6. ä»£ç è´¨é‡æ”¹è¿›å»ºè®®

### 6.1 ç«‹å³æ‰§è¡Œ (Critical - æœ¬å‘¨å†…)

#### 6.1.1 å»ºç«‹ä»£ç è§„èŒƒ
```json
// .eslintrc.js
module.exports = {
  extends: [
    '@typescript-eslint/recommended',
    'plugin:vue/vue3-recommended'
  ],
  rules: {
    '@typescript-eslint/no-explicit-any': 'error',
    '@typescript-eslint/no-unused-vars': 'error',
    'vue/component-name-in-template-casing': ['error', 'PascalCase'],
    'no-console': 'warn',
    'prefer-const': 'error'
  }
};

// .prettierrc
{
  "semi": true,
  "singleQuote": true,
  "tabWidth": 2,
  "trailingComma": "es5",
  "printWidth": 100
}
```

#### 6.1.2 é‡æ„anyç±»å‹ä½¿ç”¨
```typescript
// ä½¿ç”¨TypeScriptä¸¥æ ¼æ¨¡å¼
// tsconfig.json
{
  "compilerOptions": {
    "strict": true,
    "noImplicitAny": true,
    "strictNullChecks": true,
    "strictFunctionTypes": true
  }
}
```

### 6.2 çŸ­æœŸæ‰§è¡Œ (High - æœ¬æœˆå†…)

#### 6.2.1 å»ºç«‹å…±äº«ç»„ä»¶åº“
```typescript
// åˆ›å»ºå¯å¤ç”¨çš„ç»„ä»¶å’Œå·¥å…·
// src/components/base/
export class BaseButton extends Vue { }
export class BaseInput extends Vue { }
export class BaseModal extends Vue { }

// src/utils/
export const httpClient = new HttpClient();
export const errorHandler = new ErrorHandler();
export const validator = new Validator();
```

#### 6.2.2 å®æ–½ä»£ç å®¡æŸ¥æµç¨‹
```yaml
# .github/workflows/code-review.yml
name: Code Review
on: [pull_request]
jobs:
  quality-check:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: ESLint Check
        run: npm run lint
      - name: TypeScript Check
        run: npm run typecheck
      - name: Unit Tests
        run: npm test
```

### 6.3 ä¸­æœŸæ‰§è¡Œ (Medium - 3ä¸ªæœˆå†…)

#### 6.3.1 é‡æ„å¤§å‹å‡½æ•°
```typescript
// å®æ–½å•ä¸€èŒè´£åŸåˆ™
// æ¯ä¸ªå‡½æ•°åªåšä¸€ä»¶äº‹
// å‡½æ•°é•¿åº¦ä¸è¶…è¿‡30è¡Œ
// åœˆå¤æ‚åº¦ä¸è¶…è¿‡10

export class CodeRefactoringGuidelines {
  // å‡½æ•°é•¿åº¦ç›‘æ§
  static measureFunctionComplexity(func: Function): number {
    const lines = func.toString().split('\n').length;
    return lines;
  }
  
  // åœˆå¤æ‚åº¦è®¡ç®—
  static calculateCyclomaticComplexity(func: Function): number {
    // å®ç°åœˆå¤æ‚åº¦è®¡ç®—é€»è¾‘
  }
}
```

#### 6.3.2 å»ºç«‹è®¾è®¡æ¨¡å¼åº“
```typescript
// å¸¸ç”¨è®¾è®¡æ¨¡å¼å®ç°
// patterns/factory.ts
export class ServiceFactory {
  static createService<T>(type: string): T {
    // å·¥å‚æ¨¡å¼å®ç°
  }
}

// patterns/observer.ts
export class EventEmitter {
  // è§‚å¯Ÿè€…æ¨¡å¼å®ç°
}

// patterns/decorator.ts
export function Cacheable(target: any, propertyKey: string, descriptor: PropertyDescriptor) {
  // è£…é¥°å™¨æ¨¡å¼å®ç°
}
```

## 7. è´¨é‡ç›‘æ§ä½“ç³»

### 7.1 ä»£ç è´¨é‡æŒ‡æ ‡
```typescript
// è´¨é‡æŒ‡æ ‡ç›‘æ§
interface QualityMetrics {
  // ç±»å‹å®‰å…¨æŒ‡æ ‡
  anyTypeUsage: number;
  typeCoverage: number;
  
  // ä»£ç å¤æ‚åº¦æŒ‡æ ‡
  averageFunctionLength: number;
  maxCyclomaticComplexity: number;
  
  // å¯ç»´æŠ¤æ€§æŒ‡æ ‡
  codeDuplicationRate: number;
  testCoverage: number;
  
  // æ€§èƒ½æŒ‡æ ‡
  bundleSize: number;
  loadTime: number;
}
```

### 7.2 è‡ªåŠ¨åŒ–è´¨é‡æ£€æŸ¥
```bash
# æ·»åŠ åˆ°package.json
{
  "scripts": {
    "quality:check": "npm run lint && npm run typecheck && npm test",
    "quality:complexity": "complexity-report -f json -o complexity.json src/",
    "quality:duplicate": "jscpd --format json --output duplication.json src/",
    "quality:coverage": "npm test -- --coverage"
  }
}
```

## 8. å›¢é˜ŸåŸ¹è®­å’Œæœ€ä½³å®è·µ

### 8.1 ä»£ç è´¨é‡åŸ¹è®­
1. **TypeScriptæœ€ä½³å®è·µåŸ¹è®­**
2. **è®¾è®¡æ¨¡å¼åº”ç”¨åŸ¹è®­**
3. **ä»£ç é‡æ„æŠ€å·§åŸ¹è®­**
4. **æµ‹è¯•é©±åŠ¨å¼€å‘åŸ¹è®­**

### 8.2 è´¨é‡æ–‡åŒ–å»ºè®¾
- **ä»£ç å®¡æŸ¥åˆ¶åº¦**: æ¯ä¸ªPRå¿…é¡»ç»è¿‡ä»£ç å®¡æŸ¥
- **è´¨é‡é—¨ç¦**: ä¸è¾¾æ ‡çš„ä»£ç ä¸èƒ½åˆå¹¶
- **æŒç»­æ”¹è¿›**: å®šæœŸè´¨é‡è¯„å®¡å’Œä¼˜åŒ–

## 9. å·¥å…·å’Œé…ç½®

### 9.1 æ¨èå·¥å…·
```bash
# ä»£ç è´¨é‡å·¥å…·
npm install -g eslint typescript prettier
npm install -g complex-report jscpd
npm install -g sonarqube-scanner

# VS Codeæ’ä»¶
- TypeScript Hero
- ESLint
- Prettier
- CodeMetrics
- GitLens
```

### 9.2 é…ç½®æ–‡ä»¶ç¤ºä¾‹
```json
// package.json scripts
{
  "scripts": {
    "lint": "eslint src --ext .ts,.vue",
    "lint:fix": "eslint src --ext .ts,.vue --fix",
    "format": "prettier --write src/**/*.{ts,vue}",
    "quality:report": "npm run lint && npm run typecheck && npm run test:coverage"
  }
}
```

## 10. æ€»ç»“å’Œå»ºè®®

### 10.1 å½“å‰è´¨é‡çŠ¶å†µ
- ğŸ”´ **ç±»å‹å®‰å…¨**: å¤§é‡anyç±»å‹ä½¿ç”¨ï¼Œéœ€è¦æ”¹è¿›
- ğŸŸ  **ä»£ç é‡å¤**: é‡å¤é€»è¾‘è¾ƒå¤šï¼Œéœ€è¦é‡æ„
- ğŸŸ¡ **å¤æ‚åº¦**: éƒ¨åˆ†å‡½æ•°è¿‡äºå¤æ‚
- ğŸŸ¢ **æµ‹è¯•è¦†ç›–**: æµ‹è¯•ä½“ç³»å®Œå–„

### 10.2 ä¼˜å…ˆçº§å»ºè®®
1. **ç«‹å³ä¿®å¤**: anyç±»å‹ä½¿ç”¨å’Œä»£ç é‡å¤é—®é¢˜ (Critical)
2. **æœ¬å‘¨å®Œæˆ**: é”™è¯¯å¤„ç†ç»Ÿä¸€å’Œå¼‚æ­¥ä»£ç è§„èŒƒ (High)
3. **æœ¬æœˆå®Œæˆ**: å‘½åè§„èŒƒç»Ÿä¸€å’Œæ³¨é‡Šå®Œå–„ (Medium)
4. **3ä¸ªæœˆå†…**: ä»£ç æ ¼å¼æ ‡å‡†åŒ–å’Œå·¥å…·é…ç½® (Low)

### 10.3 é•¿æœŸæ”¹è¿›ç›®æ ‡
- **ç±»å‹å®‰å…¨**: anyç±»å‹ä½¿ç”¨é™ä½åˆ°<5%
- **ä»£ç é‡å¤**: é‡å¤ç‡é™ä½åˆ°<10%
- **å¤æ‚åº¦æ§åˆ¶**: å¹³å‡å‡½æ•°é•¿åº¦<20è¡Œ
- **æ–‡æ¡£å®Œå–„**: å…³é”®å‡½æ•°100%æ³¨é‡Šè¦†ç›–
- **è‡ªåŠ¨åŒ–**: 90%çš„è´¨é‡æ£€æŸ¥è‡ªåŠ¨åŒ–

**è´¨é‡ç›®æ ‡**:
- SonarQubeè´¨é‡é—¨: Açº§
- æŠ€æœ¯å€ºåŠ¡: <1å¤©
- æµ‹è¯•è¦†ç›–ç‡: >90%
- ä»£ç å®¡æŸ¥: 100%è¦†ç›–ç‡