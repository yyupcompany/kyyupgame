# 🔐 幼儿园综合管理系统 - 环境变量秘钥配置

> ⚠️ **安全警告**：本文档包含敏感信息，请妥善保管，不要分享给未授权人员
>
> 📅 **创建日期**：2025-01-06

---

## 📊 系统架构概览

| 系统 | 项目目录 | 域名 | 前端端口 | 后端端口 | 数据库 |
|------|----------|------|----------|----------|--------|
| 统一认证中心 | /adminyyup/admin.yyup.cc | rent.yyup.cc | 5174(开发)/80(生产) | 4001 | admin_tenant_management |
| 租户业务系统 | /k.yyup.com | k.yyup.cc | 5173(开发)/80(生产) | 3000 | kargerdensales |

### 访问流程
1. 管理员访问 `rent.yyup.cc` → 登录统一认证中心 → 管理租户
2. 租户用户访问 `k.yyup.cc` → 登录租户系统 → 使用业务功能

---

## 🏢 系统一：统一认证中心 (admin.yyup.cc)

**项目路径**: `/persistent/home/zhgue/kyyupgame/adminyyup/admin.yyup.cc`

### 1. 数据库配置

| 变量名 | 值 | 说明 |
|--------|-----|------|
| DB_HOST | dbconn.sealoshzh.site | 数据库主机 |
| DB_PORT | 43906 | 数据库端口 |
| DB_USERNAME | root | 数据库用户名 |
| DB_PASSWORD | pwk5ls7j | 数据库密码 |
| DB_DATABASE | admin_tenant_management | 数据库名 |

### 2. JWT 配置

| 变量名 | 值 |
|--------|-----|
| JWT_SECRET | admin_yyup_cc_super_secret_jwt_key_2024 |
| JWT_EXPIRES_IN | 24h |
| JWT_REFRESH_SECRET | admin_yyup_cc_refresh_secret_2024 |
| JWT_REFRESH_EXPIRES_IN | 7d |

### 3. 阿里云短信配置

| 变量名 | 值 |
|--------|-----|
| ALIYUN_ACCESS_KEY_ID | YOUR_ALIYUN_ACCESS_KEY_ID |
| ALIYUN_ACCESS_KEY_SECRET | YOUR_ALIYUN_ACCESS_KEY_SECRET |
| SMS_SIGN_NAME | 婴婴向上北京教育科技 |
| SMS_TEMPLATE_CODE | SMS_493345201 |

### 4. 阿里云 DNS 配置

| 变量名 | 值 |
|--------|-----|
| ALIYUN_DNS_ACCESS_KEY_ID | YOUR_ALIYUN_ACCESS_KEY_ID |
| ALIYUN_DNS_ACCESS_KEY_SECRET | YOUR_ALIYUN_ACCESS_KEY_SECRET |
| DNS_DOMAIN | yyup.cc |
| DNS_SERVER_IP | 47.94.82.59 |

### 5. 阿里云 OSS 配置

| 变量名 | 值 | 说明 |
|--------|-----|------|
| SYSTEM_OSS_ACCESS_KEY_ID | YOUR_ALIYUN_OSS_ACCESS_KEY_ID | 系统OSS |
| SYSTEM_OSS_ACCESS_KEY_SECRET | YOUR_ALIYUN_OSS_ACCESS_KEY_SECRET | 系统OSS |
| SYSTEM_OSS_BUCKET | systemkarder | 系统存储桶 |
| SYSTEM_OSS_REGION | oss-cn-guangzhou | 广州区域 |
| OSS_ACCESS_KEY_ID | YOUR_ALIYUN_OSS_ACCESS_KEY_ID | 人脸识别OSS |
| OSS_ACCESS_KEY_SECRET | YOUR_ALIYUN_OSS_ACCESS_KEY_SECRET | 人脸识别OSS |
| OSS_BUCKET | faceshanghaikarden | 人脸存储桶 |
| OSS_REGION | oss-cn-shanghai | 上海区域 |

### 6. 阿里云 KMS 配置

| 变量名 | 值 |
|--------|-----|
| KMS_ENABLED | true |
| ALIYUN_KMS_ACCESS_KEY_ID | YOUR_ALIYUN_OSS_ACCESS_KEY_ID |
| ALIYUN_KMS_ACCESS_KEY_SECRET | YOUR_ALIYUN_OSS_ACCESS_KEY_SECRET |
| KMS_REGION | cn-guangzhou |
| KMS_API_JWT_SECRET | admin_yyup_cc_kms_api_jwt_secret_2024 |
| KMS_DEFAULT_KEY_ALIAS | alias/jwt-signing-key |

### 7. 安全配置

| 变量名 | 值 |
|--------|-----|
| API_KEY_SECRET | admin_yyup_cc_api_secret_2024 |
| ADMIN_API_KEY | admin_yyup_cc_admin_key_2024 |
| DATA_ENCRYPTION_KEY | admin_yyup_cc_data_encryption_key_32chars |
| SYNC_ENCRYPTION_KEY | sync_encryption_key_2024 |

---

## 🏫 系统二：租户业务系统 (k.yyup.com)

**项目路径**: `/persistent/home/zhgue/kyyupgame/k.yyup.com`

### 1. 数据库配置

| 变量名 | 值 | 说明 |
|--------|-----|------|
| DB_HOST | dbconn.sealoshzh.site | 数据库主机 |
| DB_PORT | 43906 | 数据库端口 |
| DB_USER | root | 数据库用户名 |
| DB_PASSWORD | pwk5ls7j | 数据库密码 |
| DB_NAME | kargerdensales | 数据库名 |

### 2. JWT 配置

| 变量名 | 值 |
|--------|-----|
| JWT_SECRET | kindergarten-enrollment-secret |

### 3. KMS 远程 API 配置

| 变量名 | 值 |
|--------|-----|
| KMS_API_URL | https://admin.yyup.cc/api/kms |
| KMS_API_TENANT_ID | k_tenant |
| KMS_REMOTE_ENABLED | true |
| KMS_FALLBACK_ENABLED | true |
| DB_ENCRYPTION_KEY | local-fallback-encryption-key-2024 |

### 4. 阿里云 OSS 配置

| 变量名 | 值 | 说明 |
|--------|-----|------|
| SYSTEM_OSS_ACCESS_KEY_ID | YOUR_ALIYUN_OSS_ACCESS_KEY_ID | 系统OSS |
| SYSTEM_OSS_ACCESS_KEY_SECRET | YOUR_ALIYUN_OSS_ACCESS_KEY_SECRET | 系统OSS |

### 5. 统一认证中心集成

| 变量名 | 值 |
|--------|-----|
| UNIFIED_AUTH_CENTER_URL | https://rent.yyup.cc |
| UNIFIED_AUTH_CENTER_API_URL | http://localhost:4001 |
| TENANT_CODE | k_tenant |
| TENANT_DOMAIN | k.yyup.cc |

### 6. 服务器配置

| 变量名 | 值 |
|--------|-----|
| SERVER_URL | https://k.yyup.cc |
| SERVER_PORT | 3000 |
| FRONTEND_URL | https://k.yyup.cc |

---

## 📝 阿里云 Access Key 汇总

| 用途 | Access Key ID | Access Key Secret |
|------|--------------|-------------------|
| OSS/KMS (系统存储) | YOUR_ALIYUN_OSS_ACCESS_KEY_ID | YOUR_ALIYUN_OSS_ACCESS_KEY_SECRET |
| SMS/DNS (短信/域名) | YOUR_ALIYUN_ACCESS_KEY_ID | YOUR_ALIYUN_ACCESS_KEY_SECRET |

---

## 🗄️ 数据库信息汇总

| 数据库 | 用途 | 连接信息 |
|--------|------|----------|
| admin_tenant_management | 统一认证中心 | dbconn.sealoshzh.site:43906 |
| kargerdensales | 租户业务系统 | dbconn.sealoshzh.site:43906 |

---

## 🔄 更新记录

| 日期 | 更新内容 | 操作人 |
|------|----------|--------|
| 2025-01-06 | 初始创建文档，整理两个系统的环境变量 | AI Assistant |

---

## ⚠️ 安全提醒

1. **不要将此文件提交到Git仓库** - 请确保 `.gitignore` 包含此文件
2. **定期更换密钥** - 建议每3-6个月更换一次敏感密钥
3. **权限最小化** - 阿里云AccessKey应该只授予必要的权限
4. **监控异常访问** - 定期检查阿里云控制台的访问日志
