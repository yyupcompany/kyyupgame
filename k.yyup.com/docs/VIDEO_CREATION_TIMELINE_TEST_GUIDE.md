# 视频创作Timeline测试指南

## 📋 概述

本文档提供视频创作功能的完整测试流程，确保7个步骤可以完整走通。

## 🎯 测试目标

- ✅ 验证7个步骤的完整流程
- ✅ 验证数据在步骤间正确传递
- ✅ 验证错误处理和用户提示
- ✅ 验证项目恢复功能
- ✅ 验证重新生成功能

---

## 🚀 完整流程测试

### 步骤1: 创意输入

**测试点**：
1. 访问媒体中心 → 视频创作
2. 填写表单：
   - 视频主题：`春季招生宣传`
   - 发布平台：`抖音`
   - 视频类型：`招生宣传`
   - 视频时长：`短视频 (15-30秒)`
   - 关键要点：`优质教育、温馨环境、专业师资`

**验证**：
- [ ] 所有字段可以正常输入
- [ ] 必填字段验证生效（主题、平台、类型）
- [ ] 点击"开始创作"后进入步骤2

**预期结果**：
- 创建项目成功
- 自动进入步骤2
- 步骤1显示为"已完成"状态

---

### 步骤2: 脚本生成

**测试点**：
1. 自动开始生成脚本
2. 观察进度条和进度文本
3. 等待脚本生成完成
4. 点击"查看脚本"按钮

**验证**：
- [ ] 进度条正常显示
- [ ] 进度文本实时更新
- [ ] 脚本生成成功
- [ ] 脚本对话框正确显示所有信息：
  - 视频标题
  - 视频简介
  - 总时长
  - 场景数量
  - 场景详情（画面描述、旁白、字幕、技术参数）
- [ ] 点击"重新生成脚本"弹出确认对话框
- [ ] 确认后清除后续数据并重新生成

**预期结果**：
- 脚本包含3-12个场景（根据时长）
- 每个场景有完整的描述信息
- 可以查看和重新生成

---

### 步骤3: 配音合成

**测试点**：
1. 选择配音风格
2. 试听不同音色
3. 点击"生成配音"
4. 等待配音生成完成
5. 播放配音音频
6. 点击"查看配音列表"

**验证**：
- [ ] 音色选择器正常工作
- [ ] 试听功能正常
- [ ] 配音生成进度正常显示
- [ ] 生成的配音数量与场景数量一致
- [ ] 每个配音可以正常播放
- [ ] 配音列表对话框正确显示：
  - 场景编号
  - 旁白文案
  - 音频时长
  - 播放按钮
- [ ] 点击"重新生成配音"弹出确认对话框
- [ ] 确认后清除后续数据并重新生成

**预期结果**：
- 每个场景都有对应的配音
- 配音质量清晰
- 可以查看和重新生成

---

### 步骤4: 分镜生成

**测试点**：
1. 点击"生成分镜视频"
2. 观察生成进度
3. 等待所有场景视频生成完成
4. 查看生成的视频

**验证**：
- [ ] 进度条正常显示
- [ ] 每个场景视频生成成功
- [ ] 视频可以正常播放
- [ ] 视频内容与脚本描述匹配
- [ ] 点击"重新生成分镜"弹出确认对话框
- [ ] 确认后清除后续数据并重新生成

**预期结果**：
- 所有场景都有对应的视频
- 视频质量符合要求
- 可以重新生成

**常见问题**：
- ❌ 提示"prompt参数不能为空"
  - 原因：场景描述字段读取错误
  - 解决：已修复，使用 visualDescription 字段

---

### 步骤5: 视频剪辑

**测试点**：
1. 点击"开始剪辑合成"
2. 观察合成进度
3. 等待视频合成完成
4. 预览最终视频

**验证**：
- [ ] 进度条正常显示
- [ ] 视频合成成功
- [ ] 最终视频包含所有场景
- [ ] 配音正确添加到视频
- [ ] 视频可以正常播放

**预期结果**：
- 生成完整的合成视频
- 视频包含所有场景和配音
- 视频质量符合要求

**常见问题**：
- ❌ 配音没有添加到视频
  - 原因：audioUrl 参数传递错误
  - 解决：已修复，支持 audioData 数组

---

### 步骤6: 预览调整

**测试点**：
1. 预览最终视频
2. 检查视频质量
3. 点击"确认无误，继续"

**验证**：
- [ ] 视频播放正常
- [ ] 画面清晰
- [ ] 配音清晰
- [ ] 场景过渡自然
- [ ] 点击"重新生成"可以返回重新制作

**预期结果**：
- 视频符合预期
- 可以确认或重新生成

---

### 步骤7: 导出发布

**测试点**：
1. 下载视频
2. 保存项目
3. 创建新视频

**验证**：
- [ ] 点击"下载视频"可以下载
- [ ] 点击"保存项目"提示保存成功
- [ ] 点击"发布到平台"提示功能开发中
- [ ] 点击"创建新视频"重置所有状态

**预期结果**：
- 视频可以下载
- 项目可以保存
- 可以创建新视频

---

## 🔄 项目恢复测试

### 测试场景1: 脚本生成完成后刷新

**步骤**：
1. 完成步骤1和步骤2
2. 刷新页面
3. 观察项目恢复

**验证**：
- [ ] 自动恢复到步骤2
- [ ] 主题信息正确恢复
- [ ] 脚本数据正确显示
- [ ] 可以继续下一步

---

### 测试场景2: 配音生成完成后刷新

**步骤**：
1. 完成步骤1、2、3
2. 刷新页面
3. 观察项目恢复

**验证**：
- [ ] 自动恢复到步骤3
- [ ] 主题信息正确恢复
- [ ] 脚本数据正确显示
- [ ] 配音数据正确恢复
- [ ] 可以查看配音列表
- [ ] 可以继续下一步

---

### 测试场景3: 生成过程中刷新

**步骤**：
1. 在脚本生成过程中刷新页面
2. 观察项目恢复

**验证**：
- [ ] 自动恢复到步骤2
- [ ] 显示"正在生成脚本"
- [ ] 继续轮询进度
- [ ] 生成完成后正常显示

---

## 🔧 重新生成功能测试

### 测试场景1: 重新生成脚本

**步骤**：
1. 完成步骤2
2. 点击"重新生成脚本"
3. 确认对话框

**验证**：
- [ ] 弹出警告对话框
- [ ] 提示会清除后续数据
- [ ] 确认后清除配音、分镜、最终视频
- [ ] 重新生成脚本
- [ ] 步骤重置到步骤2

---

### 测试场景2: 重新生成配音

**步骤**：
1. 完成步骤3
2. 点击"重新生成配音"
3. 确认对话框

**验证**：
- [ ] 弹出警告对话框
- [ ] 提示会清除后续数据
- [ ] 确认后清除分镜、最终视频
- [ ] 保留脚本数据
- [ ] 重新生成配音
- [ ] 步骤重置到步骤3

---

### 测试场景3: 重新生成分镜

**步骤**：
1. 完成步骤4
2. 点击"重新生成分镜"
3. 确认对话框

**验证**：
- [ ] 弹出警告对话框
- [ ] 提示会清除后续数据
- [ ] 确认后清除最终视频
- [ ] 保留脚本和配音数据
- [ ] 重新生成分镜
- [ ] 步骤重置到步骤4

---

## 🐛 已知问题和解决方案

### 问题1: videoGenerating is not defined

**现象**：恢复项目时报错

**原因**：变量名错误

**解决**：已修复，使用 scenesGenerating

---

### 问题2: prompt参数不能为空

**现象**：生成分镜时报错

**原因**：字段名不匹配

**解决**：已修复，使用 visualDescription 字段

---

### 问题3: 配音列表消失

**现象**：点击下一步后无法查看配音

**原因**：缺少查看按钮

**解决**：已添加"查看配音列表"按钮

---

### 问题4: 配音没有添加到视频

**现象**：合成的视频没有配音

**原因**：audioUrl 参数传递错误

**解决**：已修复，支持 audioData 数组

---

## 📊 测试检查清单

### 功能完整性
- [ ] 7个步骤都可以正常完成
- [ ] 数据在步骤间正确传递
- [ ] 所有按钮功能正常
- [ ] 所有对话框正常显示

### 数据准确性
- [ ] 脚本数据完整
- [ ] 配音数据完整
- [ ] 分镜数据完整
- [ ] 最终视频正确

### 用户体验
- [ ] 进度提示清晰
- [ ] 错误提示友好
- [ ] 操作流程顺畅
- [ ] 界面响应及时

### 错误处理
- [ ] 网络错误有提示
- [ ] 生成失败有提示
- [ ] 数据缺失有提示
- [ ] 操作确认有提示

---

## 🎯 测试结论

完成以上所有测试后，确认：

- [ ] Timeline可以完整走通
- [ ] 所有功能正常工作
- [ ] 用户体验良好
- [ ] 错误处理完善

---

## 📝 测试记录

**测试日期**：_____________

**测试人员**：_____________

**测试环境**：
- 前端：http://localhost:5173
- 后端：http://localhost:3000
- 浏览器：_____________

**测试结果**：
- 通过：_____ 项
- 失败：_____ 项
- 阻塞：_____ 项

**备注**：

