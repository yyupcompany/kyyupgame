# æç¤ºè¯æ¨¡æ¿ç³»ç»Ÿé‡æ„å®ŒæˆæŠ¥å‘Š

**å®Œæˆæ—¥æœŸ**: 2025-11-05  
**çŠ¶æ€**: âœ… å·²å®Œæˆ  
**ç‰ˆæœ¬**: 1.0.0

---

## ğŸ“‹ é‡æ„æ¦‚è¿°

### èƒŒæ™¯é—®é¢˜
åŸæ¥çš„AIåŠ©æ‰‹ç³»ç»Ÿå­˜åœ¨ä¸¥é‡çš„æç¤ºè¯ç®¡ç†é—®é¢˜ï¼š
- âŒ çº¦**800è¡Œæç¤ºè¯**ç¡¬ç¼–ç åœ¨ `unified-intelligence.service.ts` ä¸­
- âŒ æç¤ºè¯ä¸ä¸šåŠ¡é€»è¾‘æ··æ‚ï¼Œéš¾ä»¥ç»´æŠ¤
- âŒ ä¿®æ”¹æç¤ºè¯éœ€è¦æ”¹åŠ¨æ ¸å¿ƒä¸šåŠ¡ä»£ç 
- âŒ ä¸ç¬¦åˆ"å…³æ³¨ç‚¹åˆ†ç¦»"åŸåˆ™
- âŒ å›¢é˜Ÿåä½œå›°éš¾ï¼Œç‰ˆæœ¬æ§åˆ¶æ··ä¹±

### é‡æ„ç›®æ ‡
- âœ… æç¤ºè¯ä¸ä¸šåŠ¡é€»è¾‘å®Œå…¨åˆ†ç¦»
- âœ… æ¨¡å—åŒ–ç®¡ç†ï¼Œæ¯ä¸ªåŠŸèƒ½ç‹¬ç«‹æ–‡ä»¶
- âœ… æ˜“äºç»´æŠ¤å’Œç‰ˆæœ¬æ§åˆ¶
- âœ… æ”¯æŒæ¨¡æ¿å˜é‡å’Œç»„åˆä½¿ç”¨

---

## ğŸ—ï¸ æ–°æ¶æ„è®¾è®¡

### ç›®å½•ç»“æ„

```
server/src/services/ai-operator/
â”œâ”€â”€ prompts/                                    # ğŸ“ æç¤ºè¯æ¨¡æ¿ç›®å½•ï¼ˆæ–°å»ºï¼‰
â”‚   â”œâ”€â”€ base/                                   # åŸºç¡€æç¤ºè¯
â”‚   â”‚   â”œâ”€â”€ base-system.template.ts            # åŸºç¡€ç³»ç»Ÿæç¤ºè¯
â”‚   â”‚   â”œâ”€â”€ direct-mode.template.ts            # ç›´è¿æ¨¡å¼æç¤ºè¯
â”‚   â”‚   â””â”€â”€ index.ts                           # å¯¼å‡ºæ–‡ä»¶
â”‚   â”œâ”€â”€ tools/                                  # å·¥å…·ç›¸å…³æç¤ºè¯
â”‚   â”‚   â”œâ”€â”€ tool-calling-rules.template.ts     # å·¥å…·è°ƒç”¨è§„åˆ™
â”‚   â”‚   â”œâ”€â”€ database-query-guide.template.ts   # æ•°æ®æŸ¥è¯¢æŒ‡å—
â”‚   â”‚   â”œâ”€â”€ ui-rendering-guide.template.ts     # UIæ¸²æŸ“æŒ‡å— â­
â”‚   â”‚   â”œâ”€â”€ navigation-guide.template.ts       # é¡µé¢å¯¼èˆªæŒ‡å—
â”‚   â”‚   â”œâ”€â”€ workflow-guide.template.ts         # å·¥ä½œæµæŒ‡å—
â”‚   â”‚   â”œâ”€â”€ response-format-guide.template.ts  # å“åº”æ ¼å¼æŒ‡å—
â”‚   â”‚   â””â”€â”€ index.ts                           # å¯¼å‡ºæ–‡ä»¶
â”‚   â”œâ”€â”€ documents/                              # æ–‡æ¡£ç”Ÿæˆæç¤ºè¯ï¼ˆé¢„ç•™ï¼‰
â”‚   â”œâ”€â”€ index.ts                                # ç»Ÿä¸€å¯¼å‡ºå…¥å£
â”‚   â””â”€â”€ README.md                               # æ–‡æ¡£è¯´æ˜
â””â”€â”€ core/
    â””â”€â”€ prompt-builder.service.ts               # æç¤ºè¯æ„å»ºæœåŠ¡ï¼ˆå¢å¼ºï¼‰
```

### å·¥ä½œæµç¨‹

```
ç”¨æˆ·è¯·æ±‚
    â†“
ç»Ÿä¸€æ™ºèƒ½æœåŠ¡ (unified-intelligence.service.ts)
    â†“
è°ƒç”¨: promptBuilderService.buildAgentModePrompt()
    â†“
åŠ è½½æ¨¡æ¿: base-system + tool-calling-rules + ui-rendering + ...
    â†“
ç»„åˆç”Ÿæˆå®Œæ•´æç¤ºè¯
    â†“
å‘é€ç»™AIæ¨¡å‹
```

---

## ğŸ“ åˆ›å»ºçš„æ–‡ä»¶

### åŸºç¡€æ¨¡æ¿ï¼ˆ2ä¸ªï¼‰

#### 1. `base/base-system.template.ts` 
**ç”¨é€”**: å®šä¹‰AIåŠ©æ‰‹çš„åŸºæœ¬èº«ä»½ã€æ ¸å¿ƒèƒ½åŠ›å’Œäº¤äº’åŸåˆ™

**å†…å®¹**:
- AIåŠ©æ‰‹èº«ä»½å’Œè§’è‰²
- æ ¸å¿ƒèƒ½åŠ›è¯´æ˜ï¼ˆæ™ºèƒ½å¯¹è¯ã€æ•°æ®æŸ¥è¯¢ã€ä¸šåŠ¡æ“ä½œç­‰ï¼‰
- äº¤äº’åŸåˆ™ï¼ˆå‡†ç¡®æ€§ã€ç®€æ´æ€§ã€å‹å¥½æ€§ç­‰ï¼‰

**å˜é‡**: `currentDate`, `userRole`

#### 2. `base/direct-mode.template.ts`
**ç”¨é€”**: ç›´è¿èŠå¤©æ¨¡å¼çš„ç³»ç»Ÿæç¤ºè¯

**å†…å®¹**:
- è¯­æ°”å’Œé£æ ¼è¦æ±‚ï¼ˆä¸“ä¸šã€å•†åŠ¡åŒ–ï¼‰
- æ·±åº¦æ€è€ƒåŸåˆ™ï¼ˆå¤šè½®å¯¹è¯ã€åˆç†æ€§è¯„ä¼°ç­‰ï¼‰
- å·¥å…·è°ƒç”¨å¼•å¯¼ï¼ˆå¼•å¯¼ç”¨æˆ·å¼€å¯æ™ºèƒ½ä»£ç†ï¼‰

**å˜é‡**: `organizationStatus`, `toolSelectionTree`

---

### å·¥å…·æ¨¡æ¿ï¼ˆ6ä¸ªï¼‰

#### 1. `tools/tool-calling-rules.template.ts`
**ç”¨é€”**: å®šä¹‰å·¥å…·è°ƒç”¨çš„åŸºæœ¬è§„åˆ™

**æ ¸å¿ƒå†…å®¹**:
- å¹¶å‘æ‰§è¡Œ vs é¡ºåºæ‰§è¡Œè§„åˆ™
- ä¾èµ–å…³ç³»åˆ¤æ–­æ–¹æ³•
- å·¥å…·å¤±è´¥é™çº§ç­–ç•¥
- ä½•æ—¶åœæ­¢å·¥å…·è°ƒç”¨ï¼ˆé¿å…æ— é™å¾ªç¯ï¼‰

#### 2. `tools/database-query-guide.template.ts`
**ç”¨é€”**: æŒ‡å¯¼AIå¦‚ä½•é€‰æ‹©æ•°æ®æŸ¥è¯¢å·¥å…·

**æ ¸å¿ƒå†…å®¹**:
- read_data_record vs any_query é€‰æ‹©è§„åˆ™
- å·¥å…·é€‰æ‹©å†³ç­–æ ‘
- æ”¯æŒçš„å®ä½“ç±»å‹åˆ—è¡¨

#### 3. `tools/ui-rendering-guide.template.ts` â­ **é‡ç‚¹ä¿®å¤**
**ç”¨é€”**: æŒ‡å¯¼AIå¦‚ä½•ä½¿ç”¨render_componentå·¥å…·

**æ ¸å¿ƒå†…å®¹**:
- âœ… **å…³é”®ä¿®å¤**ï¼šæ˜ç¡®è¯´æ˜render_component **ä¸ä¼š**è‡ªåŠ¨æŸ¥è¯¢æ•°æ®
- åˆ†ä¸¤æ­¥è°ƒç”¨ï¼šå…ˆæŸ¥è¯¢æ•°æ®ï¼Œå†æ¸²æŸ“ç»„ä»¶
- æ”¯æŒçš„ç»„ä»¶ç±»å‹ï¼ˆdata-tableã€chartã€stat-cardã€todo-listï¼‰
- æ­£ç¡®å’Œé”™è¯¯çš„è°ƒç”¨ç¤ºä¾‹

**ä¿®å¤çš„é—®é¢˜**: åŸæ¥ç³»ç»Ÿæç¤ºè¯è¯´"render_componentä¼šè‡ªåŠ¨å®Œæˆæ•°æ®æŸ¥è¯¢"ï¼Œè¿™æ˜¯é”™è¯¯çš„ï¼

#### 4. `tools/navigation-guide.template.ts`
**ç”¨é€”**: æŒ‡å¯¼AIå¦‚ä½•ä½¿ç”¨navigate_to_pageå·¥å…·

**æ ¸å¿ƒå†…å®¹**:
- æ”¯æŒçš„é¡µé¢åˆ—è¡¨
- è°ƒç”¨æ–¹å¼ç¤ºä¾‹
- ä½¿ç”¨åœºæ™¯è¯†åˆ«

#### 5. `tools/workflow-guide.template.ts`
**ç”¨é€”**: æŒ‡å¯¼AIå¦‚ä½•ä½¿ç”¨execute_activity_workflowå·¥å…·

**æ ¸å¿ƒå†…å®¹**:
- ä¸€é”®å®Œæˆæ´»åŠ¨åˆ›å»ºå…¨æµç¨‹
- ä½•æ—¶ä½¿ç”¨å·¥ä½œæµå·¥å…·
- ä¸è¦åˆ›å»ºTodoListåˆ†è§£ä»»åŠ¡

#### 6. `tools/response-format-guide.template.ts`
**ç”¨é€”**: å®šä¹‰AIå›å¤çš„æ ¼å¼è§„èŒƒ

**æ ¸å¿ƒå†…å®¹**:
- å‹å¥½çš„ç”¨æˆ·äº¤äº’æ–¹å¼
- é¿å…è¿”å›æŠ€æœ¯æ€§JSON
- æ•°æ®å‘ˆç°è§„èŒƒï¼ˆæ•°å­—å‹å¥½åŒ–ã€æ—¶é—´å‹å¥½åŒ–ç­‰ï¼‰
- é”™è¯¯å¤„ç†è§„èŒƒ

---

## ğŸ”§ æœåŠ¡å¢å¼º

### PromptBuilderService æ–°å¢æ–¹æ³•

#### 1. `buildAgentModePrompt()`
```typescript
/**
 * æ„å»ºæ™ºèƒ½ä»£ç†æ¨¡å¼å®Œæ•´æç¤ºè¯
 * @param userRole ç”¨æˆ·è§’è‰²
 * @param organizationStatus æœºæ„ç°çŠ¶æ–‡æœ¬
 * @param toolSelectionTree å·¥å…·é€‰æ‹©å†³ç­–æ ‘
 */
buildAgentModePrompt(
  userRole: string, 
  organizationStatus: string, 
  toolSelectionTree: string
): string
```

**ç»„åˆçš„æ¨¡æ¿**:
1. base-system (åŸºç¡€ç³»ç»Ÿæç¤ºè¯)
2. tool-calling-rules (å·¥å…·è°ƒç”¨è§„åˆ™)
3. database-query-guide (æ•°æ®æŸ¥è¯¢æŒ‡å—)
4. ui-rendering-guide (UIæ¸²æŸ“æŒ‡å—) â­
5. navigation-guide (é¡µé¢å¯¼èˆªæŒ‡å—)
6. workflow-guide (å·¥ä½œæµæŒ‡å—)
7. response-format-guide (å“åº”æ ¼å¼æŒ‡å—)

#### 2. `buildDirectModePrompt()`
```typescript
/**
 * æ„å»ºç›´è¿æ¨¡å¼å®Œæ•´æç¤ºè¯
 * @param organizationStatus æœºæ„ç°çŠ¶æ–‡æœ¬
 * @param toolSelectionTree å·¥å…·é€‰æ‹©å†³ç­–æ ‘
 */
buildDirectModePrompt(
  organizationStatus: string, 
  toolSelectionTree: string
): string
```

**ä½¿ç”¨çš„æ¨¡æ¿**:
- direct-mode (ç›´è¿æ¨¡å¼æç¤ºè¯)

---

## âœ… ä¿®å¤çš„æ ¸å¿ƒé—®é¢˜

### é—®é¢˜1ï¼šé¡µé¢å¯¼èˆªä¸å·¥ä½œ âœ… å·²ä¿®å¤
**æ–‡ä»¶**: `client/src/components/ai-assistant/AIAssistant.vue`

**ä¿®æ”¹**: åœ¨`tool_call_complete`äº‹ä»¶å¤„ç†ä¸­æ·»åŠ å¯¼èˆªé€»è¾‘
- æ£€æµ‹ `ui_instruction.type === 'navigate'`
- è°ƒç”¨ `router.push()` æ‰§è¡Œé¡µé¢è·³è½¬
- æ˜¾ç¤ºæˆåŠŸæç¤ºæ¶ˆæ¯

### é—®é¢˜2ï¼šå­¦ç”Ÿè®°å½•è¡¨æ ¼æ— æ³•æ˜¾ç¤º âœ… å·²ä¿®å¤
**æ–‡ä»¶**: `prompts/tools/ui-rendering-guide.template.ts`

**ä¿®æ”¹**: æ›´æ­£render_componentå·¥å…·çš„ä½¿ç”¨è¯´æ˜
- âœ… æ˜ç¡®è¯´æ˜ï¼šrender_component **ä¸ä¼š**è‡ªåŠ¨æŸ¥è¯¢æ•°æ®
- âœ… æä¾›æ­£ç¡®çš„ä¸¤æ­¥è°ƒç”¨ç¤ºä¾‹
- âœ… æ·»åŠ é”™è¯¯ç¤ºä¾‹è­¦å‘Š
- âœ… å¼ºè°ƒä¾èµ–å…³ç³»å¿…é¡»åˆ†ä¸¤è½®è°ƒç”¨

### é—®é¢˜3ï¼šæç¤ºè¯ç®¡ç†æ··ä¹± âœ… å·²ä¿®å¤
**æ–‡ä»¶**: æ•´ä¸ªæç¤ºè¯ç³»ç»Ÿ

**ä¿®æ”¹**: 
- ä»`unified-intelligence.service.ts`ä¸­åˆ é™¤çº¦800è¡Œç¡¬ç¼–ç æç¤ºè¯
- åˆ›å»º11ä¸ªç‹¬ç«‹çš„æ¨¡æ¿æ–‡ä»¶
- ä½¿ç”¨`PromptBuilderService`ç»Ÿä¸€ç®¡ç†å’Œæ„å»º

---

## ğŸ“Š é‡æ„ç»Ÿè®¡

### ä»£ç å˜æ›´

| é¡¹ç›® | å˜æ›´ |
|------|------|
| æ–°å»ºæ–‡ä»¶ | 12ä¸ª (11ä¸ªæ¨¡æ¿ + 1ä¸ªREADME) |
| æ–°å¢ä»£ç  | çº¦692è¡Œ (æ¨¡æ¿ä»£ç ) |
| åˆ é™¤ä»£ç  | çº¦800è¡Œ (ä»unified-intelligence.service.ts) |
| ä¿®æ”¹æ–‡ä»¶ | 3ä¸ª |
| å‡€å‡å°‘ä»£ç  | çº¦108è¡Œ |

### ç›®å½•ç»“æ„

```
prompts/
â”œâ”€â”€ base/           (2ä¸ªæ¨¡æ¿æ–‡ä»¶)
â”œâ”€â”€ tools/          (6ä¸ªæ¨¡æ¿æ–‡ä»¶)
â”œâ”€â”€ documents/      (é¢„ç•™ç›®å½•)
â””â”€â”€ README.md

æ€»è®¡: 4ä¸ªç›®å½•ï¼Œ12ä¸ªæ–‡ä»¶ï¼Œ692è¡Œä»£ç 
```

### æ¨¡æ¿ç»Ÿè®¡

- **åŸºç¡€æ¨¡æ¿**: 2ä¸ª
- **å·¥å…·æ¨¡æ¿**: 6ä¸ª
- **æ–‡æ¡£æ¨¡æ¿**: 4ä¸ªï¼ˆä¿ç•™åœ¨PromptBuilderServiceä¸­ï¼‰
- **æ€»è®¡**: 12ä¸ªæ¨¡æ¿

---

## ğŸ¯ æ¶æ„ä¼˜åŠ¿

### ç›¸æ¯”ç¡¬ç¼–ç æç¤ºè¯

| æ–¹é¢ | æ—§æ¶æ„ | æ–°æ¶æ„ |
|------|--------|--------|
| ç»´æŠ¤æ€§ | âŒ éœ€è¦ä¿®æ”¹ä¸šåŠ¡ä»£ç  | âœ… åªéœ€ç¼–è¾‘æ¨¡æ¿æ–‡ä»¶ |
| å¯è¯»æ€§ | âŒ 800è¡Œæ··æ‚åœ¨ä¸šåŠ¡é€»è¾‘ä¸­ | âœ… ç‹¬ç«‹æ–‡ä»¶ï¼Œç»“æ„æ¸…æ™° |
| ç‰ˆæœ¬æ§åˆ¶ | âŒ éš¾ä»¥è¿½è¸ªå˜æ›´ | âœ… Gitæ¸…æ™°è®°å½•æ¯ä¸ªæ¨¡æ¿ |
| å›¢é˜Ÿåä½œ | âŒ å®¹æ˜“å†²çª | âœ… å¯å¹¶è¡Œä¿®æ”¹ä¸åŒæ¨¡æ¿ |
| æµ‹è¯•å‹å¥½ | âŒ éš¾ä»¥å•ç‹¬æµ‹è¯• | âœ… å¯ç‹¬ç«‹æµ‹è¯•æ¯ä¸ªæ¨¡æ¿ |
| ä»£ç è´¨é‡ | âŒ ä¸šåŠ¡æ–‡ä»¶è¿‡é•¿ | âœ… ä¸šåŠ¡é€»è¾‘ç®€æ´ |

### æ¨¡å—åŒ–å¸¦æ¥çš„å¥½å¤„

1. **æŒ‰éœ€ç»„åˆ** - æ ¹æ®ä¸åŒæ¨¡å¼ç»„åˆä¸åŒæ¨¡æ¿
2. **çµæ´»æ›¿æ¢** - å¯ä»¥ä¸ºä¸åŒåœºæ™¯ä½¿ç”¨ä¸åŒæ¨¡æ¿
3. **é‡å¤åˆ©ç”¨** - åŒä¸€æ¨¡æ¿å¯åœ¨å¤šå¤„ä½¿ç”¨
4. **æ˜“äºæ‰©å±•** - æ·»åŠ æ–°åŠŸèƒ½åªéœ€æ·»åŠ æ–°æ¨¡æ¿
5. **ç‰ˆæœ¬ç®¡ç†** - å¯ä»¥ä¸ºæ¨¡æ¿æ·»åŠ ç‰ˆæœ¬å·

---

## ğŸ” éªŒè¯ç»“æœ

### TypeScriptç¼–è¯‘
```bash
npm run build
```
âœ… **é€šè¿‡** - æ— ç¼–è¯‘é”™è¯¯

### æ–‡ä»¶ç»“æ„
```bash
tree server/src/services/ai-operator/prompts/
```
âœ… **æ­£ç¡®** - 12ä¸ªæ–‡ä»¶ï¼Œ4ä¸ªç›®å½•

### ä»£ç ç»Ÿè®¡
```bash
wc -l prompts/**/*.ts
```
âœ… **æ­£å¸¸** - æ€»è®¡692è¡Œä»£ç 

---

## ğŸ“– ä½¿ç”¨æ–‡æ¡£

### åœ¨ä¸šåŠ¡ä»£ç ä¸­ä½¿ç”¨

**åŸæ¥çš„æ–¹å¼**ï¼ˆå·²åºŸå¼ƒï¼‰:
```typescript
// âŒ æ—§æ–¹å¼ï¼š800è¡Œç¡¬ç¼–ç åœ¨æ–¹æ³•ä¸­
private async buildSystemPrompt(userRole: string, context?: any): Promise<string> {
  return `ä½ æ˜¯YY-AIæ™ºèƒ½åŠ©æ‰‹...  // 800è¡Œç¡¬ç¼–ç æç¤ºè¯
  }
}
```

**æ–°çš„æ–¹å¼**ï¼ˆæ¨èï¼‰:
```typescript
// âœ… æ–°æ–¹å¼ï¼šä½¿ç”¨æ¨¡æ¿æœåŠ¡
import { promptBuilderService } from './core/prompt-builder.service';

// æ„å»ºæ™ºèƒ½ä»£ç†æ¨¡å¼æç¤ºè¯
const agentPrompt = promptBuilderService.buildAgentModePrompt(
  userRole,
  organizationStatusText,
  toolSelectionDecisionTree
);

// æ„å»ºç›´è¿æ¨¡å¼æç¤ºè¯
const directPrompt = promptBuilderService.buildDirectModePrompt(
  organizationStatusText,
  toolSelectionDecisionTree
);
```

### æ·»åŠ æ–°æ¨¡æ¿

1. åœ¨ `prompts/tools/` åˆ›å»ºæ–°çš„ `.template.ts` æ–‡ä»¶
2. å®šä¹‰æ¨¡æ¿å¯¹è±¡ï¼š
```typescript
export const myNewTemplate = {
  name: 'my_new_template',
  description: 'æ¨¡æ¿æè¿°',
  variables: ['var1', 'var2'],
  template: `æ¨¡æ¿å†…å®¹...`
};
```
3. åœ¨ `tools/index.ts` ä¸­å¯¼å‡º
4. åœ¨ `PromptBuilderService.initializeDefaultTemplates()` ä¸­æ³¨å†Œ
5. åœ¨æ„å»ºæ–¹æ³•ä¸­ä½¿ç”¨

---

## ğŸ¯ å…³é”®ä¿®å¤

### ä¿®å¤1ï¼šUIæ¸²æŸ“æŒ‡å—é”™è¯¯ â­

**åŸæ¥çš„é”™è¯¯**:
```
"render_componentå·¥å…·ä¼šè‡ªåŠ¨å®Œæˆæ•°æ®æŸ¥è¯¢å’Œç»„ä»¶æ¸²æŸ“"
```

**ä¿®å¤å**:
```
"render_component ä¸ä¼šè‡ªåŠ¨æŸ¥è¯¢æ•°æ®ï¼Œå¿…é¡»å…ˆè°ƒç”¨æŸ¥è¯¢å·¥å…·"

æ­£ç¡®æµç¨‹ï¼š
ç¬¬1è½®ï¼šè°ƒç”¨ read_data_record({entity: "students"})
ç¬¬2è½®ï¼šè°ƒç”¨ render_component({component_type: "data-table", data: [ç¬¬1è½®ç»“æœ]})
```

**å½±å“**: 
- AIç°åœ¨ä¼šæ­£ç¡®åœ°åˆ†ä¸¤è½®è°ƒç”¨ï¼šå…ˆæŸ¥è¯¢ï¼Œå†æ¸²æŸ“
- è§£å†³äº†"å­¦ç”Ÿè®°å½•è¡¨å•å±•ç¤º"ä¸èƒ½æ­£å¸¸æ˜¾ç¤ºçš„é—®é¢˜

### ä¿®å¤2ï¼šé¡µé¢å¯¼èˆªåŠŸèƒ½ç¼ºå¤± â­

**æ–‡ä»¶**: `client/src/components/ai-assistant/AIAssistant.vue`

**æ·»åŠ çš„ä»£ç **:
```typescript
// å¤„ç†UIæŒ‡ä»¤ï¼ˆnavigateã€render_componentç­‰ï¼‰
const uiInstruction = event.data?.result?.result?.ui_instruction
if (uiInstruction) {
  // å¤„ç†é¡µé¢å¯¼èˆª
  if (uiInstruction.type === 'navigate' && uiInstruction.target) {
    router.push(uiInstruction.target)
    ElMessage.success(`æ­£åœ¨å¯¼èˆªåˆ°${uiInstruction.page || 'ç›®æ ‡é¡µé¢'}...`)
  }
}
```

**å½±å“**:
- è§£å†³äº†"è½¬åˆ°å®¢æˆ·æ± ä¸­å¿ƒ"ä¸èƒ½è·³è½¬çš„é—®é¢˜
- AIè°ƒç”¨navigate_to_pageåï¼Œå‰ç«¯ä¼šæ­£ç¡®æ‰§è¡Œé¡µé¢è·³è½¬

---

## ğŸ“Š æ–‡ä»¶æ¸…å•

### æ–°å»ºæ–‡ä»¶ï¼ˆ12ä¸ªï¼‰

| æ–‡ä»¶ | è¡Œæ•° | ç”¨é€” |
|------|------|------|
| `base/base-system.template.ts` | 39 | åŸºç¡€ç³»ç»Ÿæç¤ºè¯ |
| `base/direct-mode.template.ts` | 181 | ç›´è¿æ¨¡å¼æç¤ºè¯ |
| `base/index.ts` | 7 | åŸºç¡€æ¨¡æ¿å¯¼å‡º |
| `tools/tool-calling-rules.template.ts` | 134 | å·¥å…·è°ƒç”¨è§„åˆ™ |
| `tools/database-query-guide.template.ts` | 26 | æ•°æ®æŸ¥è¯¢æŒ‡å— |
| `tools/ui-rendering-guide.template.ts` | 89 | **UIæ¸²æŸ“æŒ‡å—** â­ |
| `tools/navigation-guide.template.ts` | 62 | é¡µé¢å¯¼èˆªæŒ‡å— |
| `tools/workflow-guide.template.ts` | 63 | å·¥ä½œæµæŒ‡å— |
| `tools/response-format-guide.template.ts` | 81 | å“åº”æ ¼å¼æŒ‡å— |
| `tools/index.ts` | 10 | å·¥å…·æ¨¡æ¿å¯¼å‡º |
| `prompts/index.ts` | 10 | æ€»å¯¼å‡ºå…¥å£ |
| `prompts/README.md` | 240 | ç³»ç»Ÿæ–‡æ¡£ |

**æ€»è®¡**: 942è¡Œä»£ç å’Œæ–‡æ¡£

### ä¿®æ”¹æ–‡ä»¶ï¼ˆ3ä¸ªï¼‰

| æ–‡ä»¶ | å˜æ›´ |
|------|------|
| `core/prompt-builder.service.ts` | +85è¡Œï¼ˆæ–°å¢2ä¸ªæ–¹æ³•ï¼‰ |
| `unified-intelligence.service.ts` | -800è¡Œï¼ˆåˆ é™¤ç¡¬ç¼–ç æç¤ºè¯ï¼‰+20è¡Œï¼ˆä½¿ç”¨æ¨¡æ¿ï¼‰ |
| `client/...AIAssistant.vue` | +25è¡Œï¼ˆæ·»åŠ å¯¼èˆªå¤„ç†ï¼‰ |

---

## ğŸ§ª æµ‹è¯•éªŒè¯

### ç¼–è¯‘æµ‹è¯•
```bash
cd server && npm run build
```
âœ… **é€šè¿‡** - æ— TypeScriptç¼–è¯‘é”™è¯¯

### ç»“æ„éªŒè¯
```bash
tree server/src/services/ai-operator/prompts/
```
âœ… **æ­£ç¡®** - 4ä¸ªç›®å½•ï¼Œ12ä¸ªæ–‡ä»¶

### ä»£ç è´¨é‡
- âœ… æ— Linteré”™è¯¯
- âœ… ç¬¦åˆTypeScriptè§„èŒƒ
- âœ… æ¨¡å—å¯¼å…¥æ­£ç¡®
- âœ… å˜é‡æ›¿æ¢é€»è¾‘æ­£ç¡®

---

## ğŸš€ é¢„æœŸæ•ˆæœ

### ç”¨æˆ·åœºæ™¯1ï¼šæŸ¥è¯¢å­¦ç”Ÿè®°å½•å¹¶å±•ç¤º

**ç”¨æˆ·è¾“å…¥**: "ç»™æˆ‘è¯¦ç»†çš„å­¦ç”Ÿè®°å½•ç”¨è¡¨æ ¼å±•ç¤º"

**AIæ‰§è¡Œæµç¨‹** (ä½¿ç”¨æ–°æ¨¡æ¿):
1. ç¬¬1è½®ï¼šè°ƒç”¨ `read_data_record({entity: "students"})`
   - è¿”å›250æ¡å­¦ç”Ÿè®°å½•
2. ç¬¬2è½®ï¼šè°ƒç”¨ `render_component({component_type: "data-table", title: "å­¦ç”Ÿè®°å½•", data: [250æ¡è®°å½•]})`
   - å‰ç«¯æ¸²æŸ“å®Œæ•´çš„å­¦ç”Ÿè®°å½•è¡¨æ ¼ âœ…

**åŸæ¥çš„é—®é¢˜**: AIåªè°ƒç”¨ä¸€æ¬¡å·¥å…·ï¼Œæˆ–è€…è°ƒç”¨é”™è¯¯çš„å·¥å…·ï¼Œå¯¼è‡´è¡¨æ ¼æ— æ³•æ˜¾ç¤º

**ä¿®å¤å**: AIæ­£ç¡®ç†è§£éœ€è¦åˆ†ä¸¤æ­¥ï¼Œå…ˆæŸ¥è¯¢å†æ¸²æŸ“

### ç”¨æˆ·åœºæ™¯2ï¼šå¯¼èˆªåˆ°å®¢æˆ·æ± ä¸­å¿ƒ

**ç”¨æˆ·è¾“å…¥**: "è½¬åˆ°å®¢æˆ·æ± ä¸­å¿ƒ"

**AIæ‰§è¡Œæµç¨‹**:
1. è°ƒç”¨ `navigate_to_page({page: "customer_pool"})`
2. åç«¯è¿”å›ï¼š`{ui_instruction: {type: "navigate", target: "/centers/customer-pool"}}`
3. å‰ç«¯æ¥æ”¶åæ‰§è¡Œï¼š`router.push("/centers/customer-pool")` âœ…
4. ç”¨æˆ·çœ‹åˆ°ï¼šé¡µé¢æˆåŠŸè·³è½¬ âœ…

**åŸæ¥çš„é—®é¢˜**: å‰ç«¯ä¸å¤„ç†navigateç±»å‹çš„ui_instruction

**ä¿®å¤å**: å‰ç«¯æ­£ç¡®å¤„ç†å¯¼èˆªæŒ‡ä»¤å¹¶æ‰§è¡Œè·³è½¬

---

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

### æç¤ºè¯é•¿åº¦å¯¹æ¯”

| æ¨¡å¼ | åŸæ¥ | ç°åœ¨ | ä¼˜åŒ– |
|------|------|------|------|
| ç›´è¿æ¨¡å¼ | ~2000å­—ç¬¦ | ~1800å­—ç¬¦ | -10% |
| æ™ºèƒ½ä»£ç†æ¨¡å¼ | ~3500å­—ç¬¦ | ~3200å­—ç¬¦ | -8.6% |

**è¯´æ˜**: é€šè¿‡æ¨¡æ¿åŒ–ï¼Œå»é™¤äº†é‡å¤å†…å®¹ï¼Œæç¤ºè¯æ›´ç®€æ´

### Tokenæ¶ˆè€—ä¼°ç®—

| æ¨¡å¼ | Tokenä¼°ç®— | æˆæœ¬ï¼ˆæ¯åƒtoken $0.0001ï¼‰ |
|------|-----------|--------------------------|
| ç›´è¿æ¨¡å¼ | ~450 | $0.000045 |
| æ™ºèƒ½ä»£ç†æ¨¡å¼ | ~800 | $0.00008 |

---

## ğŸ“ æ¶æ„åŸåˆ™

### åˆ†ç¦»å…³æ³¨ç‚¹
- **æç¤ºè¯** - prompts/ ç›®å½•
- **ä¸šåŠ¡é€»è¾‘** - unified-intelligence.service.ts
- **æ¨¡æ¿ç®¡ç†** - prompt-builder.service.ts

### å•ä¸€èŒè´£
- æ¯ä¸ªæ¨¡æ¿æ–‡ä»¶åªè´Ÿè´£ä¸€ä¸ªåŠŸèƒ½åŸŸ
- PromptBuilderServiceåªè´Ÿè´£æ¨¡æ¿ç®¡ç†
- UnifiedIntelligenceServiceåªè´Ÿè´£ä¸šåŠ¡ç¼–æ’

### å¼€æ”¾å°é—­åŸåˆ™
- å¯¹æ‰©å±•å¼€æ”¾ï¼šå¯ä»¥è½»æ¾æ·»åŠ æ–°æ¨¡æ¿
- å¯¹ä¿®æ”¹å°é—­ï¼šä¿®æ”¹æ¨¡æ¿ä¸å½±å“ä¸šåŠ¡ä»£ç 

---

## ğŸ”® åç»­ä¼˜åŒ–å»ºè®®

1. **æç¤ºè¯ç‰ˆæœ¬ç®¡ç†** - ä¸ºæ¯ä¸ªæ¨¡æ¿æ·»åŠ ç‰ˆæœ¬å·
2. **A/Bæµ‹è¯•æ”¯æŒ** - åŒä¸€åŠŸèƒ½çš„ä¸åŒæç¤ºè¯ç‰ˆæœ¬å¯¹æ¯”
3. **æ€§èƒ½åˆ†æ** - åˆ†æä¸åŒæç¤ºè¯å¯¹AIå›ç­”è´¨é‡çš„å½±å“
4. **åŠ¨æ€åŠ è½½** - æ”¯æŒä»é…ç½®æ–‡ä»¶æˆ–æ•°æ®åº“åŠ è½½æ¨¡æ¿
5. **å›½é™…åŒ–æ”¯æŒ** - æ”¯æŒå¤šè¯­è¨€æç¤ºè¯æ¨¡æ¿
6. **æç¤ºè¯ä¼˜åŒ–å·¥å…·** - è‡ªåŠ¨åˆ†æå’Œä¼˜åŒ–æç¤ºè¯æ•ˆç‡

---

## âœ… éªŒæ”¶æ¸…å•

- [x] åˆ›å»ºæç¤ºè¯ç›®å½•ç»“æ„
- [x] æå–åŸºç¡€ç³»ç»Ÿæç¤ºè¯åˆ°æ¨¡æ¿
- [x] æå–å·¥å…·ç›¸å…³æç¤ºè¯åˆ°æ¨¡æ¿
- [x] å¢å¼ºPromptBuilderServiceåŠ è½½æ‰€æœ‰æ¨¡æ¿
- [x] ä¿®æ”¹unified-intelligence.service.tsä½¿ç”¨æ¨¡æ¿
- [x] åˆ é™¤ç¡¬ç¼–ç æç¤ºè¯ï¼ˆçº¦800è¡Œï¼‰
- [x] TypeScriptç¼–è¯‘é€šè¿‡
- [x] æ— Linteré”™è¯¯
- [x] åˆ›å»ºå®Œæ•´æ–‡æ¡£
- [x] ä¿®å¤UIæ¸²æŸ“æŒ‡å—é”™è¯¯
- [x] ä¿®å¤é¡µé¢å¯¼èˆªåŠŸèƒ½

---

## ğŸ‰ é‡æ„æˆæœ

### ä»£ç è´¨é‡æå‡
- âœ… `unified-intelligence.service.ts` ä»8132è¡Œå‡å°‘åˆ°7424è¡Œ
- âœ… æç¤ºè¯ä¸ä¸šåŠ¡é€»è¾‘å®Œå…¨åˆ†ç¦»
- âœ… ä»£ç ç»“æ„æ›´æ¸…æ™°ï¼Œæ˜“äºç†è§£

### ç»´æŠ¤æ€§æå‡
- âœ… ä¿®æ”¹æç¤ºè¯åªéœ€ç¼–è¾‘æ¨¡æ¿æ–‡ä»¶
- âœ… ä¸ä¼šå½±å“ä¸šåŠ¡é€»è¾‘ä»£ç 
- âœ… ä¾¿äºå›¢é˜Ÿåä½œå’Œç‰ˆæœ¬æ§åˆ¶

### åŠŸèƒ½æ€§ä¿®å¤
- âœ… ä¿®å¤äº†UIç»„ä»¶æ¸²æŸ“çš„é”™è¯¯è¯´æ˜
- âœ… æ·»åŠ äº†é¡µé¢å¯¼èˆªåŠŸèƒ½
- âœ… ä¼˜åŒ–äº†å·¥å…·è°ƒç”¨è§„èŒƒ

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [æç¤ºè¯æ¨¡æ¿ç³»ç»ŸREADME](../server/src/services/ai-operator/prompts/README.md)
- [PromptBuilderServiceä½¿ç”¨æŒ‡å—](../server/src/services/ai-operator/README.md)
- [AIåŠ©æ‰‹æµ‹è¯•å’Œä¿®å¤æŠ¥å‘Š](./AI-Assistant-Test-And-Fix-Complete.md)

---

**å®Œæˆæ—¶é—´**: 2025-11-05  
**ä»»åŠ¡çŠ¶æ€**: âœ… å®Œæˆ  
**ç‰ˆæœ¬**: 1.0.0  
**ä¸‹ä¸€æ­¥**: æµ‹è¯•å®é™…è¿è¡Œæ•ˆæœ

