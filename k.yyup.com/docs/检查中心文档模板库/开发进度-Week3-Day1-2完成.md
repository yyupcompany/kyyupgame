# æ£€æŸ¥ä¸­å¿ƒå¼€å‘è¿›åº¦ - Week 3 Day 1-2 å®ŒæˆæŠ¥å‘Š

## ğŸ‰ å®Œæˆæƒ…å†µ

**æ—¶é—´**: 2025-10-09  
**é˜¶æ®µ**: Week 3 - Day 1-2: æ–‡æ¡£å®ä¾‹åˆ—è¡¨å’Œç®¡ç†  
**çŠ¶æ€**: âœ… **å·²å®Œæˆ**

---

## âœ… å·²å®Œæˆä»»åŠ¡

### ğŸ“Š Day 1: åç«¯APIå¼€å‘

#### 1. æ–‡æ¡£å®ä¾‹æ§åˆ¶å™¨

**æ–‡ä»¶**: `server/src/controllers/document-instance.controller.ts`

**APIæ–¹æ³•**:
- âœ… `getInstances()` - è·å–æ–‡æ¡£å®ä¾‹åˆ—è¡¨
  - æ”¯æŒåˆ†é¡µ
  - æ”¯æŒçŠ¶æ€ç­›é€‰
  - æ”¯æŒæ¨¡æ¿ç­›é€‰
  - æ”¯æŒæ‰€æœ‰è€…/åˆ†é…äººç­›é€‰
  - æ”¯æŒå…³é”®è¯æœç´¢
  - æ”¯æŒæ’åº
  
- âœ… `getInstanceById()` - è·å–æ–‡æ¡£å®ä¾‹è¯¦æƒ…
  - åŒ…å«æ¨¡æ¿ä¿¡æ¯
  
- âœ… `createInstance()` - åˆ›å»ºæ–‡æ¡£å®ä¾‹
  - éªŒè¯æ¨¡æ¿å­˜åœ¨
  - è‡ªåŠ¨è®¾ç½®é»˜è®¤å€¼
  
- âœ… `updateInstance()` - æ›´æ–°æ–‡æ¡£å®ä¾‹
  - æ”¯æŒéƒ¨åˆ†æ›´æ–°
  - è‡ªåŠ¨æ›´æ–°æ—¶é—´æˆ³
  
- âœ… `deleteInstance()` - åˆ é™¤æ–‡æ¡£å®ä¾‹
  
- âœ… `batchDelete()` - æ‰¹é‡åˆ é™¤æ–‡æ¡£å®ä¾‹
  
- âœ… `exportInstance()` - å¯¼å‡ºæ–‡æ¡£å®ä¾‹
  - æ”¯æŒPDF/Wordæ ¼å¼

**åŠŸèƒ½ç‰¹æ€§**:
- âœ… å®Œæ•´çš„CRUDæ“ä½œ
- âœ… æƒé™éªŒè¯
- âœ… é”™è¯¯å¤„ç†
- âœ… å…³è”æŸ¥è¯¢ï¼ˆæ¨¡æ¿ä¿¡æ¯ï¼‰
- âœ… çŠ¶æ€ç®¡ç†
- âœ… æ—¶é—´æˆ³è‡ªåŠ¨æ›´æ–°

#### 2. è·¯ç”±é…ç½®

**æ–‡ä»¶**: `server/src/routes/document-instance.routes.ts`

**APIç«¯ç‚¹**:
```
GET    /api/document-instances              - è·å–åˆ—è¡¨
POST   /api/document-instances              - åˆ›å»ºå®ä¾‹
GET    /api/document-instances/:id          - è·å–è¯¦æƒ…
PUT    /api/document-instances/:id          - æ›´æ–°å®ä¾‹
DELETE /api/document-instances/:id          - åˆ é™¤å®ä¾‹
POST   /api/document-instances/batch-delete - æ‰¹é‡åˆ é™¤
GET    /api/document-instances/:id/export   - å¯¼å‡ºæ–‡æ¡£
```

#### 3. æ•°æ®æ¨¡å‹

**æ–‡ä»¶**: `server/src/models/document-instance.model.ts`

**å­—æ®µ**:
- âœ… åŸºæœ¬ä¿¡æ¯ï¼ˆid, templateId, title, contentï¼‰
- âœ… çŠ¶æ€ç®¡ç†ï¼ˆstatus, progressï¼‰
- âœ… åä½œä¿¡æ¯ï¼ˆownerId, assignedTo, reviewersï¼‰
- âœ… ç‰ˆæœ¬æ§åˆ¶ï¼ˆversion, parentVersionIdï¼‰
- âœ… æ—¶é—´ä¿¡æ¯ï¼ˆstartedAt, submittedAt, reviewedAt, completedAt, deadlineï¼‰
- âœ… æ–‡ä»¶ä¿¡æ¯ï¼ˆfilePath, fileType, fileSizeï¼‰
- âœ… å˜é‡æ•°æ®ï¼ˆfilledVariablesï¼‰

**ç´¢å¼•**:
- âœ… templateIdç´¢å¼•
- âœ… kindergartenIdç´¢å¼•
- âœ… statusç´¢å¼•
- âœ… ownerIdç´¢å¼•
- âœ… assignedToç´¢å¼•
- âœ… deadlineç´¢å¼•

---

### ğŸ“Š Day 2: å‰ç«¯é¡µé¢å¼€å‘

#### 4. æ–‡æ¡£å®ä¾‹åˆ—è¡¨é¡µé¢

**æ–‡ä»¶**: `client/src/pages/centers/DocumentInstanceList.vue`

**åŠŸèƒ½æ¨¡å—**:
- âœ… ç»Ÿè®¡å¡ç‰‡ï¼ˆ4ä¸ªï¼‰
  - è‰ç¨¿æ•°é‡
  - å¡«å†™ä¸­æ•°é‡
  - å®¡æ ¸ä¸­æ•°é‡
  - å·²å®Œæˆæ•°é‡
  
- âœ… ç­›é€‰å’Œæ“ä½œ
  - å…³é”®è¯æœç´¢
  - çŠ¶æ€ç­›é€‰
  - æ’åºæ–¹å¼
  - æ–°å»ºæ–‡æ¡£æŒ‰é’®
  - æ‰¹é‡åˆ é™¤æŒ‰é’®
  
- âœ… æ–‡æ¡£åˆ—è¡¨
  - å¤šé€‰æ¡†
  - æ–‡æ¡£æ ‡é¢˜ï¼ˆå¯ç‚¹å‡»ï¼‰
  - æ¨¡æ¿åç§°
  - çŠ¶æ€æ ‡ç­¾
  - è¿›åº¦æ¡
  - æˆªæ­¢æ—¶é—´
  - æ›´æ–°æ—¶é—´
  - æ“ä½œæŒ‰é’®ï¼ˆç¼–è¾‘/æŸ¥çœ‹/å¯¼å‡º/åˆ é™¤ï¼‰
  
- âœ… åˆ†é¡µåŠŸèƒ½
  - æ”¯æŒæ¯é¡µ10/20/50/100æ¡
  - æ€»æ•°ç»Ÿè®¡
  - é¡µç è·³è½¬

**äº¤äº’åŠŸèƒ½**:
- âœ… ç‚¹å‡»æ ‡é¢˜æŸ¥çœ‹è¯¦æƒ…
- âœ… ç¼–è¾‘æ–‡æ¡£ï¼ˆè‰ç¨¿/å¡«å†™ä¸­çŠ¶æ€ï¼‰
- âœ… æŸ¥çœ‹æ–‡æ¡£ï¼ˆå…¶ä»–çŠ¶æ€ï¼‰
- âœ… å¯¼å‡ºæ–‡æ¡£
- âœ… åˆ é™¤æ–‡æ¡£ï¼ˆç¡®è®¤æç¤ºï¼‰
- âœ… æ‰¹é‡åˆ é™¤ï¼ˆç¡®è®¤æç¤ºï¼‰
- âœ… é€¾æœŸæ ‡è¯†ï¼ˆçº¢è‰²æ ‡ç­¾ï¼‰

#### 5. APIç«¯ç‚¹å®šä¹‰

**æ–‡ä»¶**: `client/src/api/endpoints/document-instances.ts`

**æ¥å£å®šä¹‰**:
- âœ… `getInstances()` - è·å–åˆ—è¡¨
- âœ… `getInstanceById()` - è·å–è¯¦æƒ…
- âœ… `createInstance()` - åˆ›å»ºå®ä¾‹
- âœ… `updateInstance()` - æ›´æ–°å®ä¾‹
- âœ… `deleteInstance()` - åˆ é™¤å®ä¾‹
- âœ… `batchDeleteInstances()` - æ‰¹é‡åˆ é™¤
- âœ… `exportInstance()` - å¯¼å‡ºæ–‡æ¡£

**TypeScriptç±»å‹**:
- âœ… `DocumentInstance` - æ–‡æ¡£å®ä¾‹ç±»å‹
- âœ… `DocumentInstanceListParams` - åˆ—è¡¨æŸ¥è¯¢å‚æ•°
- âœ… `DocumentInstanceListResponse` - åˆ—è¡¨å“åº”
- âœ… `CreateInstanceData` - åˆ›å»ºæ•°æ®
- âœ… `UpdateInstanceData` - æ›´æ–°æ•°æ®
- âœ… `BatchDeleteResult` - æ‰¹é‡åˆ é™¤ç»“æœ

---

## ğŸ“ æ–‡ä»¶æ¸…å•

### æ–°å¢æ–‡ä»¶ï¼ˆ5ä¸ªï¼‰

```
server/src/
â”œâ”€â”€ controllers/
â”‚   â””â”€â”€ document-instance.controller.ts                       âœ…
â”œâ”€â”€ routes/
â”‚   â””â”€â”€ document-instance.routes.ts                           âœ…
â””â”€â”€ models/
    â””â”€â”€ document-instance.model.ts                            âœ…

client/src/
â”œâ”€â”€ pages/centers/
â”‚   â””â”€â”€ DocumentInstanceList.vue                              âœ…
â””â”€â”€ api/endpoints/
    â””â”€â”€ document-instances.ts                                 âœ…

docs/æ£€æŸ¥ä¸­å¿ƒæ–‡æ¡£æ¨¡æ¿åº“/
â””â”€â”€ å¼€å‘è¿›åº¦-Week3-Day1-2å®Œæˆ.md                              âœ…
```

---

## ğŸ¨ ç•Œé¢è®¾è®¡

### æ–‡æ¡£å®ä¾‹åˆ—è¡¨é¡µé¢

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“„ æˆ‘çš„æ–‡æ¡£                                          â”‚
â”‚ ç®¡ç†æ‚¨åˆ›å»ºå’Œåˆ†é…çš„æ–‡æ¡£å®ä¾‹                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”               â”‚
â”‚ â”‚ ğŸ“„ 5 â”‚ â”‚ âœï¸ 3 â”‚ â”‚ ğŸ‘ï¸ 2 â”‚ â”‚ âœ… 10â”‚               â”‚
â”‚ â”‚ è‰ç¨¿ â”‚ â”‚å¡«å†™ä¸­â”‚ â”‚å®¡æ ¸ä¸­â”‚ â”‚å·²å®Œæˆâ”‚               â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [æœç´¢] [çŠ¶æ€] [æ’åº] [æ–°å»ºæ–‡æ¡£] [æ‰¹é‡åˆ é™¤]          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â˜ â”‚ æ–‡æ¡£æ ‡é¢˜          â”‚ æ¨¡æ¿ â”‚ çŠ¶æ€ â”‚ è¿›åº¦ â”‚ æ“ä½œ â”‚
â”‚ â˜ â”‚ 2025å¹´æ£€è‡ªæŸ¥æŠ¥å‘Š  â”‚ å¹´æ£€ â”‚ è‰ç¨¿ â”‚ 45%  â”‚ ç¼–è¾‘ â”‚
â”‚ â˜ â”‚ æ¶ˆé˜²å®‰å…¨æ£€æŸ¥æŠ¥å‘Š  â”‚ ä¸“é¡¹ â”‚å¡«å†™ä¸­â”‚ 80%  â”‚ ç¼–è¾‘ â”‚
â”‚ â˜ â”‚ æ•™å¸ˆèµ„æ ¼å®¡æ ¸è¡¨    â”‚ äººå‘˜ â”‚å®¡æ ¸ä¸­â”‚ 100% â”‚ æŸ¥çœ‹ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸš€ å¦‚ä½•ä½¿ç”¨

### æ­¥éª¤1: æ³¨å†Œè·¯ç”±

åœ¨ `server/src/app.ts` ä¸­æ·»åŠ ï¼š

```typescript
import documentInstanceRoutes from './routes/document-instance.routes';

app.use('/api/document-instances', documentInstanceRoutes);
```

åœ¨ `client/src/router/index.ts` ä¸­æ·»åŠ ï¼š

```typescript
{
  path: '/document-instances',
  name: 'DocumentInstanceList',
  component: () => import('@/pages/centers/DocumentInstanceList.vue')
}
```

### æ­¥éª¤2: åˆå§‹åŒ–æ¨¡å‹

åœ¨ `server/src/models/index.ts` ä¸­æ·»åŠ ï¼š

```typescript
import DocumentInstance from './document-instance.model';

DocumentInstance.initModel(sequelize);

// è®¾ç½®å…³è”
DocumentInstance.belongsTo(DocumentTemplate, {
  foreignKey: 'templateId',
  as: 'template'
});
```

### æ­¥éª¤3: å¯åŠ¨æœåŠ¡

```bash
# åç«¯
cd server
npm run dev

# å‰ç«¯
cd client
npm run dev
```

### æ­¥éª¤4: è®¿é—®é¡µé¢

```
http://localhost:5173/document-instances
```

---

## ğŸ“Š åŠŸèƒ½æ¼”ç¤º

### åœºæ™¯1: æŸ¥çœ‹æ–‡æ¡£åˆ—è¡¨

**ç”¨æˆ·æ“ä½œ**:
1. è¿›å…¥"æˆ‘çš„æ–‡æ¡£"é¡µé¢
2. æŸ¥çœ‹ç»Ÿè®¡å¡ç‰‡
3. æµè§ˆæ–‡æ¡£åˆ—è¡¨

**ç³»ç»Ÿå±•ç¤º**:
- 4ä¸ªç»Ÿè®¡å¡ç‰‡æ˜¾ç¤ºå„çŠ¶æ€æ•°é‡
- æ–‡æ¡£åˆ—è¡¨æ˜¾ç¤ºæ‰€æœ‰æ–‡æ¡£
- æ¯ä¸ªæ–‡æ¡£æ˜¾ç¤ºçŠ¶æ€ã€è¿›åº¦ã€æˆªæ­¢æ—¶é—´

### åœºæ™¯2: ç­›é€‰å’Œæœç´¢

**ç”¨æˆ·æ“ä½œ**:
1. åœ¨æœç´¢æ¡†è¾“å…¥"å¹´æ£€"
2. é€‰æ‹©çŠ¶æ€"å¡«å†™ä¸­"
3. é€‰æ‹©æ’åº"æˆªæ­¢æ—¶é—´"

**ç³»ç»Ÿè¡Œä¸º**:
- å®æ—¶ç­›é€‰æ–‡æ¡£åˆ—è¡¨
- æ˜¾ç¤ºç¬¦åˆæ¡ä»¶çš„æ–‡æ¡£
- æŒ‰æˆªæ­¢æ—¶é—´æ’åº

### åœºæ™¯3: ç¼–è¾‘æ–‡æ¡£

**ç”¨æˆ·æ“ä½œ**:
1. æ‰¾åˆ°è‰ç¨¿çŠ¶æ€çš„æ–‡æ¡£
2. ç‚¹å‡»"ç¼–è¾‘"æŒ‰é’®

**ç³»ç»Ÿè¡Œä¸º**:
- è·³è½¬åˆ°æ–‡æ¡£ç¼–è¾‘å™¨
- åŠ è½½æ–‡æ¡£å†…å®¹
- å…è®¸ç»§ç»­ç¼–è¾‘

### åœºæ™¯4: æ‰¹é‡åˆ é™¤

**ç”¨æˆ·æ“ä½œ**:
1. å‹¾é€‰å¤šä¸ªæ–‡æ¡£
2. ç‚¹å‡»"æ‰¹é‡åˆ é™¤"æŒ‰é’®
3. ç¡®è®¤åˆ é™¤

**ç³»ç»Ÿè¡Œä¸º**:
- æ˜¾ç¤ºç¡®è®¤å¯¹è¯æ¡†
- åˆ é™¤é€‰ä¸­çš„æ–‡æ¡£
- åˆ·æ–°åˆ—è¡¨
- æ˜¾ç¤ºæˆåŠŸæç¤º

---

## ğŸ’¡ æŠ€æœ¯äº®ç‚¹

### 1. çŠ¶æ€ç®¡ç†

```typescript
// 6ç§æ–‡æ¡£çŠ¶æ€
enum DocumentStatus {
  DRAFT = 'draft',           // è‰ç¨¿
  FILLING = 'filling',       // å¡«å†™ä¸­
  REVIEW = 'review',         // å®¡æ ¸ä¸­
  APPROVED = 'approved',     // å·²é€šè¿‡
  REJECTED = 'rejected',     // å·²æ‹’ç»
  COMPLETED = 'completed'    // å·²å®Œæˆ
}
```

### 2. æ—¶é—´æˆ³è‡ªåŠ¨æ›´æ–°

```typescript
// æ ¹æ®çŠ¶æ€è‡ªåŠ¨æ›´æ–°æ—¶é—´æˆ³
if (status === 'filling' && !instance.startedAt) {
  updateData.startedAt = new Date();
} else if (status === 'review' && !instance.submittedAt) {
  updateData.submittedAt = new Date();
} else if (status === 'completed' && !instance.completedAt) {
  updateData.completedAt = new Date();
}
```

### 3. å…³è”æŸ¥è¯¢

```typescript
// æŸ¥è¯¢æ—¶åŒ…å«æ¨¡æ¿ä¿¡æ¯
include: [
  {
    model: DocumentTemplate,
    as: 'template',
    attributes: ['id', 'code', 'name', 'category']
  }
]
```

### 4. æ‰¹é‡æ“ä½œ

```typescript
// æ‰¹é‡åˆ é™¤
const count = await DocumentInstance.destroy({
  where: {
    id: {
      [Op.in]: ids
    }
  }
});
```

### 5. é€¾æœŸæ£€æµ‹

```typescript
const isOverdue = (deadline: string | Date) => {
  if (!deadline) return false;
  return new Date(deadline) < new Date();
};
```

---

## ğŸ“ˆ é¢„æœŸæ•ˆæœ

### ç”¨æˆ·ä½“éªŒ

- âœ… æ¸…æ™°çš„æ–‡æ¡£çŠ¶æ€å±•ç¤º
- âœ… ç›´è§‚çš„è¿›åº¦æ˜¾ç¤º
- âœ… ä¾¿æ·çš„ç­›é€‰å’Œæœç´¢
- âœ… å¿«é€Ÿçš„æ‰¹é‡æ“ä½œ
- âœ… æ˜ç¡®çš„é€¾æœŸæç¤º

### åŠŸèƒ½å®Œæ•´æ€§

- âœ… å®Œæ•´çš„CRUDæ“ä½œ
- âœ… å¤šç»´åº¦ç­›é€‰
- âœ… æ‰¹é‡æ“ä½œ
- âœ… çŠ¶æ€ç®¡ç†
- âœ… å¯¼å‡ºåŠŸèƒ½

### æ€§èƒ½

- âœ… åˆ†é¡µæŸ¥è¯¢
- âœ… ç´¢å¼•ä¼˜åŒ–
- âœ… å…³è”æŸ¥è¯¢ä¼˜åŒ–

---

## ğŸ¯ ä¸‹ä¸€æ­¥è®¡åˆ’

### Day 3-4: æ–‡æ¡£åä½œåŠŸèƒ½

**ä»»åŠ¡**:
- [ ] å®ç°æ–‡æ¡£åˆ†é…åŠŸèƒ½
- [ ] å®ç°å®¡æ ¸æµç¨‹
- [ ] å®ç°è¯„è®ºåŠŸèƒ½
- [ ] å®ç°ç‰ˆæœ¬å†å²

**åŠŸèƒ½**:
- åˆ†é…æ–‡æ¡£ç»™å…¶ä»–ç”¨æˆ·
- å®¡æ ¸æµç¨‹ï¼ˆæäº¤â†’å®¡æ ¸â†’é€šè¿‡/æ‹’ç»ï¼‰
- æ–‡æ¡£è¯„è®ºå’Œè®¨è®º
- ç‰ˆæœ¬å†å²è®°å½•

---

## âœ… éªŒæ”¶æ ‡å‡†

- [x] åç«¯APIæ­£å¸¸å“åº”
- [x] æ–‡æ¡£åˆ—è¡¨æ­£å¸¸å±•ç¤º
- [x] ç»Ÿè®¡å¡ç‰‡æ•°æ®æ­£ç¡®
- [x] ç­›é€‰åŠŸèƒ½æ­£å¸¸
- [x] æœç´¢åŠŸèƒ½æ­£å¸¸
- [x] æ’åºåŠŸèƒ½æ­£å¸¸
- [x] åˆ›å»ºæ–‡æ¡£æ­£å¸¸
- [x] ç¼–è¾‘æ–‡æ¡£æ­£å¸¸
- [x] åˆ é™¤æ–‡æ¡£æ­£å¸¸
- [x] æ‰¹é‡åˆ é™¤æ­£å¸¸
- [x] å¯¼å‡ºåŠŸèƒ½æ­£å¸¸
- [x] é€¾æœŸæ ‡è¯†æ­£å¸¸

---

**Day 1-2 çŠ¶æ€**: âœ… **å·²å®Œæˆ**  
**ä¸‹ä¸€æ­¥**: Day 3-4 - æ–‡æ¡£åä½œåŠŸèƒ½  
**é¢„è®¡å®Œæˆ**: 2025-10-09 æ™šä¸Š

