# 检查中心文档模板库 - 测试计划

## 📋 测试概述

**测试目标**: 验证检查中心文档模板库的所有功能正常运行  
**测试范围**: 后端API + 前端页面 + 数据库  
**测试方法**: MCP自动化测试 + 手动验证  
**测试时间**: 2025-10-09

---

## 🎯 测试范围

### 1. 后端API测试（20个端点）

#### 1.1 模板管理API（5个）
- [ ] GET /api/document-templates - 获取模板列表
- [ ] GET /api/document-templates/:id - 获取模板详情
- [ ] GET /api/document-templates/search - 搜索模板
- [ ] GET /api/document-templates/categories - 获取分类列表
- [ ] GET /api/document-templates/recommend - 智能推荐

#### 1.2 文档实例API（7个）
- [ ] GET /api/document-instances - 获取文档列表
- [ ] POST /api/document-instances - 创建文档实例
- [ ] GET /api/document-instances/:id - 获取文档详情
- [ ] PUT /api/document-instances/:id - 更新文档实例
- [ ] DELETE /api/document-instances/:id - 删除文档实例
- [ ] POST /api/document-instances/batch-delete - 批量删除
- [ ] GET /api/document-instances/:id/export - 导出文档

#### 1.3 文档协作API（7个）
- [ ] POST /api/document-instances/:id/assign - 分配文档
- [ ] POST /api/document-instances/:id/submit - 提交审核
- [ ] POST /api/document-instances/:id/review - 审核文档
- [ ] GET /api/document-instances/:id/comments - 获取评论
- [ ] POST /api/document-instances/:id/comments - 添加评论
- [ ] GET /api/document-instances/:id/versions - 获取版本历史
- [ ] POST /api/document-instances/:id/versions - 创建新版本

#### 1.4 统计分析API（6个）
- [ ] GET /api/document-statistics/overview - 统计概览
- [ ] GET /api/document-statistics/trends - 使用趋势
- [ ] GET /api/document-statistics/template-ranking - 模板排行
- [ ] GET /api/document-statistics/completion-rate - 完成率统计
- [ ] GET /api/document-statistics/user-stats - 用户统计
- [ ] GET /api/document-statistics/export - 导出报表

#### 1.5 幼儿园信息API（5个）
- [ ] GET /api/kindergarten/completeness - 获取信息完整度
- [ ] GET /api/kindergarten/missing-fields - 获取缺失字段
- [ ] PUT /api/kindergarten/base-info/batch - 批量更新基础信息
- [ ] POST /api/kindergarten/calculate-completeness - 计算完整度
- [ ] GET /api/kindergarten/field-config - 获取字段配置

---

### 2. 前端页面测试（7个页面）

#### 2.1 文档模板中心
- [ ] 页面正常加载
- [ ] 信息完整度提示显示
- [ ] 统计卡片数据正确
- [ ] 搜索功能正常
- [ ] 筛选功能正常
- [ ] 分页功能正常
- [ ] 点击模板跳转正常

#### 2.2 模板详情页
- [ ] 页面正常加载
- [ ] 模板信息显示正确
- [ ] Markdown预览正常
- [ ] 变量说明表格正常
- [ ] 使用说明显示正常
- [ ] 相关模板推荐正常
- [ ] "使用模板"按钮正常

#### 2.3 文档编辑器
- [ ] 页面正常加载
- [ ] 模板内容加载正确
- [ ] 变量填充面板显示
- [ ] 自动填充功能正常
- [ ] 手动填写变量正常
- [ ] 进度计算正确
- [ ] 自动保存功能正常
- [ ] 预览功能正常
- [ ] 提交功能正常

#### 2.4 基础信息完善
- [ ] 页面正常加载
- [ ] 完整度进度显示
- [ ] 5个步骤显示正常
- [ ] 缺失字段高亮
- [ ] 表单填写正常
- [ ] 步骤切换正常
- [ ] 保存功能正常
- [ ] 完整度实时更新

#### 2.5 文档实例列表
- [ ] 页面正常加载
- [ ] 统计卡片显示
- [ ] 文档列表显示
- [ ] 搜索功能正常
- [ ] 筛选功能正常
- [ ] 排序功能正常
- [ ] 批量删除正常
- [ ] 导出功能正常

#### 2.6 文档协作页面
- [ ] 页面正常加载
- [ ] 文档内容显示
- [ ] 分配文档功能正常
- [ ] 提交审核功能正常
- [ ] 审核文档功能正常
- [ ] 评论功能正常
- [ ] 版本历史显示
- [ ] 创建版本功能正常

#### 2.7 文档统计分析
- [ ] 页面正常加载
- [ ] 统计概览卡片显示
- [ ] 使用趋势图表显示
- [ ] 状态分布图表显示
- [ ] 进度分布图表显示
- [ ] 模板排行图表显示
- [ ] 数据表格显示
- [ ] 导出功能正常

---

### 3. 数据库测试

#### 3.1 表结构验证
- [ ] document_templates表存在
- [ ] document_instances表存在
- [ ] 所有字段类型正确
- [ ] 所有索引创建成功

#### 3.2 数据完整性
- [ ] 模板数据导入成功（73个）
- [ ] 外键约束正常
- [ ] 数据关联正确

---

## 🧪 测试用例

### 测试用例1: 模板列表查询

**测试步骤**:
1. 访问 GET /api/document-templates
2. 验证返回状态码200
3. 验证返回数据结构
4. 验证模板数量 >= 73

**预期结果**:
```json
{
  "success": true,
  "data": {
    "items": [...],
    "total": 73,
    "page": 1,
    "pageSize": 20
  }
}
```

---

### 测试用例2: 创建文档实例

**测试步骤**:
1. 访问 POST /api/document-instances
2. 提交数据: { templateId: 1, title: "测试文档" }
3. 验证返回状态码201
4. 验证文档创建成功

**预期结果**:
```json
{
  "success": true,
  "data": {
    "id": 1,
    "templateId": 1,
    "title": "测试文档",
    "status": "draft",
    "progress": 0
  }
}
```

---

### 测试用例3: 文档协作流程

**测试步骤**:
1. 创建文档实例
2. 分配给用户
3. 提交审核
4. 审核通过
5. 验证状态变化

**预期结果**:
- 分配后状态: filling
- 提交后状态: review
- 审核后状态: approved

---

### 测试用例4: 统计数据准确性

**测试步骤**:
1. 访问 GET /api/document-statistics/overview
2. 验证统计数据
3. 对比数据库实际数据

**预期结果**:
- 总文档数 = 数据库count
- 各状态数量正确
- 平均进度计算正确

---

## 🔍 测试检查点

### 功能性测试
- [ ] 所有API端点响应正常
- [ ] 所有页面加载正常
- [ ] 所有功能按预期工作
- [ ] 数据保存和读取正确

### 性能测试
- [ ] API响应时间 < 1秒
- [ ] 页面加载时间 < 3秒
- [ ] 大数据量查询正常
- [ ] 并发请求处理正常

### 安全性测试
- [ ] 认证机制正常
- [ ] 权限验证正常
- [ ] SQL注入防护
- [ ] XSS防护

### 兼容性测试
- [ ] Chrome浏览器正常
- [ ] Firefox浏览器正常
- [ ] Safari浏览器正常
- [ ] 移动端响应式正常

---

## 📊 测试执行计划

### 阶段1: 后端API测试（30分钟）
1. 启动后端服务
2. 运行API测试脚本
3. 验证所有端点
4. 记录测试结果

### 阶段2: 前端页面测试（30分钟）
1. 启动前端服务
2. 使用MCP浏览器自动化
3. 测试所有页面
4. 验证交互功能

### 阶段3: 集成测试（20分钟）
1. 测试完整业务流程
2. 验证数据一致性
3. 测试异常处理

### 阶段4: 性能测试（10分钟）
1. 压力测试
2. 响应时间测试
3. 并发测试

---

## ✅ 测试验收标准

### 通过标准
- 所有API端点测试通过率 >= 95%
- 所有页面功能测试通过率 >= 95%
- 无严重Bug
- 性能指标达标

### 失败标准
- 核心功能无法使用
- 数据丢失或错误
- 严重性能问题
- 安全漏洞

---

## 📝 测试报告模板

### 测试结果统计
- 总测试用例数: __
- 通过数: __
- 失败数: __
- 跳过数: __
- 通过率: __%

### 发现的问题
| 编号 | 问题描述 | 严重程度 | 状态 |
|------|----------|----------|------|
| 1    |          |          |      |

### 性能数据
| 指标 | 目标值 | 实际值 | 结果 |
|------|--------|--------|------|
| API响应时间 | <1s | __ | __ |
| 页面加载时间 | <3s | __ | __ |

---

## 🚀 测试执行命令

### 后端测试
```bash
# 启动后端
cd server
npm run dev

# 运行API测试
bash scripts/test-template-api.sh <JWT_TOKEN>
```

### 前端测试
```bash
# 启动前端
cd client
npm run dev

# 使用MCP浏览器测试
# 访问各个页面并验证功能
```

### 数据库测试
```bash
# 验证表结构
cd server
npx sequelize-cli db:migrate:status

# 验证数据
mysql -u root -p kindergarten_db
SELECT COUNT(*) FROM document_templates;
```

---

## 📅 测试时间表

| 阶段 | 时间 | 负责人 |
|------|------|--------|
| 测试准备 | 10分钟 | AI |
| 后端API测试 | 30分钟 | AI |
| 前端页面测试 | 30分钟 | AI |
| 集成测试 | 20分钟 | AI |
| 性能测试 | 10分钟 | AI |
| 报告编写 | 10分钟 | AI |
| **总计** | **110分钟** | |

---

**测试计划创建时间**: 2025-10-09  
**测试计划版本**: v1.0  
**测试负责人**: AI Assistant

