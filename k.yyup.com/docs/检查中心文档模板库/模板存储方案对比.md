# æ–‡æ¡£æ¨¡æ¿å­˜å‚¨æ–¹æ¡ˆå¯¹æ¯”ä¸æœ€ä½³å®è·µ

## ğŸ¤” æ ¸å¿ƒé—®é¢˜

**é—®é¢˜**: 73ä¸ªæ–‡æ¡£æ¨¡æ¿åº”è¯¥å¦‚ä½•å­˜å‚¨å’Œç®¡ç†ï¼Ÿ

**ä¸¤ç§æ–¹æ¡ˆ**:
1. **æ–¹æ¡ˆA**: å­˜å‚¨ä¸ºJSONæ ¼å¼åœ¨æ•°æ®åº“ä¸­ï¼Œå˜é‡æå–
2. **æ–¹æ¡ˆB**: å­˜å‚¨ä¸ºMarkdownæ–‡æ¡£ï¼Œç”¨AIä¿®æ”¹ç”Ÿæˆ

---

## ğŸ“Š æ–¹æ¡ˆå¯¹æ¯”

### æ–¹æ¡ˆAï¼šJSON + æ•°æ®åº“å­˜å‚¨

#### æ•°æ®ç»“æ„ç¤ºä¾‹

```typescript
// æ•°æ®åº“è¡¨ï¼šdocument_templates
{
  id: 1,
  code: "01-01",
  name: "å¹¼å„¿å›­å¹´æ£€è‡ªæŸ¥æŠ¥å‘Š",
  category: "annual",
  
  // æ¨¡æ¿å†…å®¹å­˜å‚¨ä¸ºJSONç»“æ„
  template_structure: {
    sections: [
      {
        id: "basic_info",
        title: "åŸºæœ¬ä¿¡æ¯",
        type: "form",
        fields: [
          {
            name: "kindergarten_name",
            label: "å¹¼å„¿å›­åç§°",
            type: "text",
            required: true,
            defaultValue: "{{kindergarten_name}}",
            placeholder: "è¯·è¾“å…¥å¹¼å„¿å›­åç§°"
          },
          {
            name: "inspection_date",
            label: "æ£€æŸ¥æ—¥æœŸ",
            type: "date",
            required: true,
            defaultValue: "{{current_date}}"
          }
        ]
      },
      {
        id: "section_1",
        title: "ä¸€ã€åŠå›­åŸºæœ¬æƒ…å†µ",
        type: "table",
        columns: ["é¡¹ç›®", "å†…å®¹", "å¤‡æ³¨"],
        rows: [
          {
            cells: [
              { value: "å¹¼å„¿å›­åç§°", editable: false },
              { value: "{{kindergarten_name}}", editable: true },
              { value: "", editable: true }
            ]
          }
        ]
      },
      {
        id: "section_2",
        title: "äºŒã€åŠå›­æ¡ä»¶",
        type: "richtext",
        content: "æˆ‘å›­å åœ°é¢ç§¯{{land_area}}å¹³æ–¹ç±³..."
      }
    ]
  },
  
  // å˜é‡å®šä¹‰
  variables: [
    {
      name: "kindergarten_name",
      label: "å¹¼å„¿å›­åç§°",
      type: "string",
      source: "kindergarten.name",  // ä»å“ªä¸ªè¡¨è·å–
      required: true
    },
    {
      name: "land_area",
      label: "å åœ°é¢ç§¯",
      type: "number",
      source: "kindergarten.land_area",
      required: true
    }
  ]
}
```

#### âœ… ä¼˜ç‚¹

1. **ç»“æ„åŒ–å¼º**
   - æ•°æ®ç»“æ„æ¸…æ™°
   - æ˜“äºæŸ¥è¯¢å’Œç»Ÿè®¡
   - æ”¯æŒå¤æ‚çš„æ•°æ®éªŒè¯

2. **å˜é‡ç®¡ç†æ–¹ä¾¿**
   - å˜é‡å®šä¹‰æ˜ç¡®
   - è‡ªåŠ¨å¡«å……å®¹æ˜“å®ç°
   - æ•°æ®æ¥æºå¯è¿½æº¯

3. **çµæ´»æ€§é«˜**
   - å¯ä»¥åŠ¨æ€è°ƒæ•´å­—æ®µ
   - æ”¯æŒæ¡ä»¶æ˜¾ç¤º/éšè—
   - æ˜“äºå®ç°è¡¨å•éªŒè¯

4. **æ€§èƒ½å¥½**
   - æ•°æ®åº“æŸ¥è¯¢å¿«
   - ç´¢å¼•ä¼˜åŒ–å®¹æ˜“
   - ç¼“å­˜ç­–ç•¥ç®€å•

5. **å¤šè¯­è¨€æ”¯æŒ**
   - æ˜“äºå®ç°å›½é™…åŒ–
   - å­—æ®µæ ‡ç­¾å¯ç¿»è¯‘

#### âŒ ç¼ºç‚¹

1. **åˆæœŸå·¥ä½œé‡å¤§**
   - éœ€è¦å°†73ä¸ªMDè½¬æ¢ä¸ºJSON
   - éœ€è¦è®¾è®¡å¤æ‚çš„æ•°æ®ç»“æ„
   - å¼€å‘å·¥ä½œé‡å¤§

2. **çµæ´»æ€§å—é™**
   - å¤æ‚æ’ç‰ˆéš¾ä»¥å®ç°
   - è‡ªç”±æ–‡æœ¬ç¼–è¾‘å—é™
   - éœ€è¦é¢„å®šä¹‰æ‰€æœ‰å­—æ®µç±»å‹

3. **ç»´æŠ¤æˆæœ¬é«˜**
   - ä¿®æ”¹æ¨¡æ¿éœ€è¦ä¿®æ”¹æ•°æ®ç»“æ„
   - éœ€è¦ç‰ˆæœ¬ç®¡ç†
   - æ•°æ®è¿ç§»å¤æ‚

---

### æ–¹æ¡ˆBï¼šMarkdown + AIç”Ÿæˆ

#### æ•°æ®ç»“æ„ç¤ºä¾‹

```typescript
// æ•°æ®åº“è¡¨ï¼šdocument_templates
{
  id: 1,
  code: "01-01",
  name: "å¹¼å„¿å›­å¹´æ£€è‡ªæŸ¥æŠ¥å‘Š",
  category: "annual",
  
  // æ¨¡æ¿å†…å®¹å­˜å‚¨ä¸ºMarkdownæ–‡æœ¬
  template_content: `
# å¹¼å„¿å›­å¹´æ£€è‡ªæŸ¥æŠ¥å‘Š

## åŸºæœ¬ä¿¡æ¯

**å¹¼å„¿å›­åç§°**: {{kindergarten_name}}  
**æ£€æŸ¥æ—¥æœŸ**: {{inspection_date}}  
**å›­é•¿å§“å**: {{principal_name}}

## ä¸€ã€åŠå›­åŸºæœ¬æƒ…å†µ

| é¡¹ç›® | å†…å®¹ | å¤‡æ³¨ |
|------|------|------|
| å¹¼å„¿å›­åç§° | {{kindergarten_name}} | {{remark}} |
| å åœ°é¢ç§¯ | {{land_area}}å¹³æ–¹ç±³ | {{remark}} |

...
  `,
  
  // å˜é‡å®šä¹‰ï¼ˆç®€åŒ–ç‰ˆï¼‰
  variables: {
    kindergarten_name: {
      label: "å¹¼å„¿å›­åç§°",
      type: "string",
      source: "auto",  // è‡ªåŠ¨ä»æ•°æ®åº“è·å–
      required: true
    },
    inspection_date: {
      label: "æ£€æŸ¥æ—¥æœŸ",
      type: "date",
      source: "auto",
      required: true
    }
  },
  
  // AIæç¤ºè¯ï¼ˆç”¨äºç”Ÿæˆå’Œä¿®æ”¹ï¼‰
  ai_prompt: `
    è¿™æ˜¯ä¸€ä¸ªå¹¼å„¿å›­å¹´æ£€è‡ªæŸ¥æŠ¥å‘Šæ¨¡æ¿ã€‚
    è¯·æ ¹æ®ç”¨æˆ·æä¾›çš„ä¿¡æ¯ï¼Œå¡«å……æ¨¡æ¿ä¸­çš„å˜é‡ã€‚
    ä¿æŒåŸæœ‰æ ¼å¼å’Œç»“æ„ä¸å˜ã€‚
  `
}
```

#### âœ… ä¼˜ç‚¹

1. **ç®€å•ç›´è§‚**
   - Markdownæ ¼å¼æ˜“è¯»æ˜“å†™
   - æ‰€è§å³æ‰€å¾—
   - å­¦ä¹ æˆæœ¬ä½

2. **çµæ´»æ€§å¼º**
   - æ”¯æŒä»»æ„å¤æ‚çš„æ’ç‰ˆ
   - å¯Œæ–‡æœ¬ç¼–è¾‘è‡ªç”±
   - æ˜“äºè°ƒæ•´æ ¼å¼

3. **å¼€å‘å¿«é€Ÿ**
   - ç›´æ¥ä½¿ç”¨ç°æœ‰çš„73ä¸ªMDæ–‡ä»¶
   - æ— éœ€å¤æ‚çš„æ•°æ®ç»“æ„è®¾è®¡
   - å¿«é€Ÿä¸Šçº¿

4. **AIå‹å¥½**
   - AIå¯ä»¥ç›´æ¥ç†è§£Markdown
   - æ˜“äºå®ç°æ™ºèƒ½å¡«å……
   - æ”¯æŒè‡ªç„¶è¯­è¨€ä¿®æ”¹

5. **ç»´æŠ¤ç®€å•**
   - ä¿®æ”¹æ¨¡æ¿ç›´æ¥ç¼–è¾‘æ–‡æœ¬
   - ç‰ˆæœ¬ç®¡ç†ç”¨Git
   - æ— éœ€æ•°æ®è¿ç§»

#### âŒ ç¼ºç‚¹

1. **ç»“æ„åŒ–å¼±**
   - éš¾ä»¥ç²¾ç¡®æŸ¥è¯¢
   - æ•°æ®éªŒè¯å›°éš¾
   - ç»Ÿè®¡åˆ†æä¸ä¾¿

2. **æ€§èƒ½é—®é¢˜**
   - å¤§æ–‡æœ¬å­˜å‚¨å’Œä¼ è¾“
   - å…¨æ–‡æœç´¢æ€§èƒ½å·®
   - ç¼“å­˜ç­–ç•¥å¤æ‚

3. **AIä¾èµ–**
   - ä¾èµ–AIæœåŠ¡ç¨³å®šæ€§
   - AIæˆæœ¬è¾ƒé«˜
   - å¯èƒ½å‡ºç°æ ¼å¼é”™è¯¯

---

## ğŸ¯ æœ€ä½³å®è·µï¼šæ··åˆæ–¹æ¡ˆ

### æ¨èæ–¹æ¡ˆï¼šç»“æ„åŒ–å…ƒæ•°æ® + Markdownå†…å®¹ + AIè¾…åŠ©

ç»“åˆä¸¤ç§æ–¹æ¡ˆçš„ä¼˜ç‚¹ï¼Œé‡‡ç”¨æ··åˆå­˜å‚¨ç­–ç•¥ï¼š

```typescript
// æ•°æ®åº“è¡¨ï¼šdocument_templates
{
  id: 1,
  code: "01-01",
  name: "å¹¼å„¿å›­å¹´æ£€è‡ªæŸ¥æŠ¥å‘Š",
  category: "annual",
  
  // 1. å…ƒæ•°æ®ï¼ˆJSONï¼‰- ç”¨äºæŸ¥è¯¢ã€ç­›é€‰ã€ç®¡ç†
  metadata: {
    frequency: "yearly",
    priority: "required",
    estimatedFillTime: 120,
    tags: ["å¹´æ£€", "å¿…å¡«", "é‡è¦"],
    relatedTemplates: [2, 3, 50, 56]
  },
  
  // 2. å˜é‡å®šä¹‰ï¼ˆJSONï¼‰- ç”¨äºè‡ªåŠ¨å¡«å……
  variables: {
    // åŸºç¡€å˜é‡ï¼ˆè‡ªåŠ¨ä»æ•°æ®åº“è·å–ï¼‰
    auto_fill: {
      kindergarten_name: {
        label: "å¹¼å„¿å›­åç§°",
        source: "kindergarten.name",
        type: "string"
      },
      principal_name: {
        label: "å›­é•¿å§“å",
        source: "kindergarten.principal",
        type: "string"
      },
      teacher_count: {
        label: "æ•™å¸ˆäººæ•°",
        source: "SELECT COUNT(*) FROM teachers WHERE kindergarten_id = ?",
        type: "number"
      }
    },
    
    // ç”¨æˆ·å¡«å†™å˜é‡
    user_input: {
      self_evaluation: {
        label: "è‡ªè¯„æƒ…å†µ",
        type: "richtext",
        required: true
      },
      improvement_plan: {
        label: "æ”¹è¿›è®¡åˆ’",
        type: "richtext",
        required: true
      }
    }
  },
  
  // 3. æ¨¡æ¿å†…å®¹ï¼ˆMarkdownï¼‰- ç”¨äºå±•ç¤ºå’Œç¼–è¾‘
  template_content: `
# å¹¼å„¿å›­å¹´æ£€è‡ªæŸ¥æŠ¥å‘Š

## åŸºæœ¬ä¿¡æ¯

**å¹¼å„¿å›­åç§°**: {{kindergarten_name}}  
**å›­é•¿å§“å**: {{principal_name}}  
**æ•™å¸ˆäººæ•°**: {{teacher_count}}äºº

## ä¸€ã€è‡ªè¯„æƒ…å†µ

{{self_evaluation}}

## äºŒã€æ”¹è¿›è®¡åˆ’

{{improvement_plan}}
  `,
  
  // 4. è¡¨å•é…ç½®ï¼ˆJSONï¼‰- ç”¨äºç”Ÿæˆå¡«å†™ç•Œé¢
  form_config: {
    sections: [
      {
        title: "åŸºæœ¬ä¿¡æ¯",
        fields: [
          {
            name: "kindergarten_name",
            type: "text",
            readonly: true,  // è‡ªåŠ¨å¡«å……ï¼Œåªè¯»
            autoFill: true
          },
          {
            name: "principal_name",
            type: "text",
            readonly: true,
            autoFill: true
          }
        ]
      },
      {
        title: "è‡ªè¯„æƒ…å†µ",
        fields: [
          {
            name: "self_evaluation",
            type: "richtext",
            placeholder: "è¯·å¡«å†™è‡ªè¯„æƒ…å†µ...",
            guide: "è¯¦ç»†æè¿°æœ¬å¹´åº¦åŠå›­æƒ…å†µã€å–å¾—çš„æˆç»©å’Œå­˜åœ¨çš„é—®é¢˜"
          }
        ]
      }
    ]
  },
  
  // 5. AIé…ç½®ï¼ˆJSONï¼‰- ç”¨äºAIè¾…åŠ©
  ai_config: {
    prompt: `
      ä½ æ˜¯ä¸€ä¸ªå¹¼å„¿å›­æ–‡æ¡£åŠ©æ‰‹ã€‚
      è¿™æ˜¯ä¸€ä¸ªå¹´æ£€è‡ªæŸ¥æŠ¥å‘Šæ¨¡æ¿ã€‚
      è¯·å¸®åŠ©ç”¨æˆ·ï¼š
      1. è‡ªåŠ¨å¡«å……åŸºç¡€ä¿¡æ¯
      2. æ ¹æ®ç”¨æˆ·è¾“å…¥ç”Ÿæˆè§„èŒƒçš„æŠ¥å‘Šå†…å®¹
      3. æ£€æŸ¥å†…å®¹å®Œæ•´æ€§å’Œè§„èŒƒæ€§
    `,
    features: {
      autoFill: true,
      smartSuggestion: true,
      contentCheck: true
    }
  }
}
```

---

## ğŸš€ å®æ–½æ–¹æ¡ˆ

### é˜¶æ®µ1ï¼šå¿«é€Ÿä¸Šçº¿ï¼ˆä½¿ç”¨æ–¹æ¡ˆBï¼‰

**ç›®æ ‡**: 2å‘¨å†…å¿«é€Ÿä¸Šçº¿åŸºç¡€åŠŸèƒ½

```typescript
// ç®€åŒ–ç‰ˆæ•°æ®ç»“æ„
{
  id: 1,
  code: "01-01",
  name: "å¹¼å„¿å›­å¹´æ£€è‡ªæŸ¥æŠ¥å‘Š",
  category: "annual",
  template_content: "... Markdownå†…å®¹ ...",
  variables: {
    kindergarten_name: { source: "auto" },
    inspection_date: { source: "auto" }
  }
}
```

**å®ç°æ­¥éª¤**:
1. ç›´æ¥å¯¼å…¥73ä¸ªMDæ–‡ä»¶åˆ°æ•°æ®åº“
2. ç®€å•çš„å˜é‡æå–å’Œæ›¿æ¢
3. åŸºç¡€çš„åœ¨çº¿ç¼–è¾‘å™¨
4. AIè¾…åŠ©å¡«å……ï¼ˆè°ƒç”¨OpenAI APIï¼‰

**ä¼˜ç‚¹**: å¿«é€Ÿä¸Šçº¿ï¼ŒéªŒè¯éœ€æ±‚

---

### é˜¶æ®µ2ï¼šä¼˜åŒ–å‡çº§ï¼ˆæ··åˆæ–¹æ¡ˆï¼‰

**ç›®æ ‡**: 4-6å‘¨å†…ä¼˜åŒ–ä¸ºæ··åˆæ–¹æ¡ˆ

```typescript
// å®Œæ•´ç‰ˆæ•°æ®ç»“æ„ï¼ˆå¦‚ä¸Šé¢çš„æ··åˆæ–¹æ¡ˆï¼‰
```

**å®ç°æ­¥éª¤**:
1. æ·»åŠ å…ƒæ•°æ®å­—æ®µ
2. å®Œå–„å˜é‡å®šä¹‰
3. æ·»åŠ è¡¨å•é…ç½®
4. ä¼˜åŒ–AIåŠŸèƒ½

**ä¼˜ç‚¹**: åŠŸèƒ½å®Œå–„ï¼Œæ€§èƒ½ä¼˜åŒ–

---

## ğŸ’¡ å…·ä½“å®ç°å»ºè®®

### 1. æ¨¡æ¿å¯¼å…¥è„šæœ¬

```typescript
// scripts/import-templates.ts

import fs from 'fs';
import path from 'path';
import { DocumentTemplate } from '../models';

async function importTemplates() {
  const templateDir = 'docs/æ£€æŸ¥ä¸­å¿ƒæ–‡æ¡£æ¨¡æ¿åº“';
  const categories = [
    '01-å¹´åº¦æ£€æŸ¥ç±»',
    '02-ä¸“é¡¹æ£€æŸ¥ç±»',
    '03-å¸¸æ€åŒ–ç£å¯¼ç±»',
    '04-æ•™èŒå·¥ç®¡ç†ç±»',
    '05-å¹¼å„¿ç®¡ç†ç±»',
    '06-è´¢åŠ¡ç®¡ç†ç±»',
    '07-ä¿æ•™å·¥ä½œç±»'
  ];
  
  for (const category of categories) {
    const categoryPath = path.join(templateDir, category);
    const files = fs.readdirSync(categoryPath);
    
    for (const file of files) {
      if (!file.endsWith('.md')) continue;
      
      const filePath = path.join(categoryPath, file);
      const content = fs.readFileSync(filePath, 'utf-8');
      
      // æå–å˜é‡
      const variables = extractVariables(content);
      
      // æå–å…ƒæ•°æ®
      const metadata = extractMetadata(content, file);
      
      // ä¿å­˜åˆ°æ•°æ®åº“
      await DocumentTemplate.create({
        code: file.replace('.md', ''),
        name: extractTitle(content),
        category: getCategoryCode(category),
        template_content: content,
        variables: variables,
        metadata: metadata
      });
    }
  }
}

// æå–å˜é‡
function extractVariables(content: string) {
  const regex = /\{\{(\w+)\}\}/g;
  const variables: any = {};
  let match;
  
  while ((match = regex.exec(content)) !== null) {
    const varName = match[1];
    if (!variables[varName]) {
      variables[varName] = {
        label: formatLabel(varName),
        type: guessType(varName),
        source: "auto",
        required: true
      };
    }
  }
  
  return variables;
}

// çŒœæµ‹å˜é‡ç±»å‹
function guessType(varName: string): string {
  if (varName.includes('date')) return 'date';
  if (varName.includes('count') || varName.includes('number')) return 'number';
  if (varName.includes('name')) return 'string';
  return 'string';
}
```

### 2. å˜é‡è‡ªåŠ¨å¡«å……

```typescript
// services/template-service.ts

export class TemplateService {
  // è‡ªåŠ¨å¡«å……å˜é‡
  async autoFillVariables(
    templateId: number,
    kindergartenId: number
  ): Promise<Record<string, any>> {
    const template = await DocumentTemplate.findByPk(templateId);
    const kindergarten = await Kindergarten.findByPk(kindergartenId);
    
    const filledVariables: Record<string, any> = {};
    
    for (const [varName, varConfig] of Object.entries(template.variables)) {
      if (varConfig.source === 'auto') {
        // ä»æ•°æ®åº“è‡ªåŠ¨è·å–
        filledVariables[varName] = await this.getVariableValue(
          varName,
          varConfig,
          kindergartenId
        );
      }
    }
    
    return filledVariables;
  }
  
  // è·å–å˜é‡å€¼
  private async getVariableValue(
    varName: string,
    varConfig: any,
    kindergartenId: number
  ): Promise<any> {
    // æ˜ å°„è¡¨ï¼šå˜é‡å -> æ•°æ®æº
    const mapping: Record<string, () => Promise<any>> = {
      kindergarten_name: async () => {
        const k = await Kindergarten.findByPk(kindergartenId);
        return k?.name;
      },
      principal_name: async () => {
        const k = await Kindergarten.findByPk(kindergartenId);
        return k?.principal;
      },
      teacher_count: async () => {
        return await Teacher.count({ where: { kindergartenId } });
      },
      student_count: async () => {
        return await Student.count({ where: { kindergartenId } });
      },
      current_date: async () => {
        return new Date().toISOString().split('T')[0];
      },
      current_year: async () => {
        return new Date().getFullYear();
      }
    };
    
    const getter = mapping[varName];
    return getter ? await getter() : '';
  }
  
  // å¡«å……æ¨¡æ¿
  async fillTemplate(
    templateContent: string,
    variables: Record<string, any>
  ): Promise<string> {
    let filled = templateContent;
    
    for (const [varName, value] of Object.entries(variables)) {
      const regex = new RegExp(`\\{\\{${varName}\\}\\}`, 'g');
      filled = filled.replace(regex, String(value));
    }
    
    return filled;
  }
}
```

### 3. AIè¾…åŠ©ç”Ÿæˆ

```typescript
// services/ai-service.ts

export class AIService {
  // AIè¾…åŠ©å¡«å……
  async aiAssistFill(
    templateContent: string,
    userInput: Record<string, any>,
    context: any
  ): Promise<string> {
    const prompt = `
ä½ æ˜¯ä¸€ä¸ªå¹¼å„¿å›­æ–‡æ¡£åŠ©æ‰‹ã€‚

æ¨¡æ¿å†…å®¹ï¼š
${templateContent}

ç”¨æˆ·æä¾›çš„ä¿¡æ¯ï¼š
${JSON.stringify(userInput, null, 2)}

å¹¼å„¿å›­èƒŒæ™¯ä¿¡æ¯ï¼š
${JSON.stringify(context, null, 2)}

è¯·å®Œæˆä»¥ä¸‹ä»»åŠ¡ï¼š
1. å°†ç”¨æˆ·æä¾›çš„ä¿¡æ¯å¡«å……åˆ°æ¨¡æ¿ä¸­
2. å¯¹äºæœªæä¾›çš„ä¿¡æ¯ï¼Œæ ¹æ®èƒŒæ™¯ä¿¡æ¯æ™ºèƒ½ç”Ÿæˆ
3. ç¡®ä¿å†…å®¹ä¸“ä¸šã€è§„èŒƒã€å®Œæ•´
4. ä¿æŒåŸæœ‰çš„Markdownæ ¼å¼

è¯·ç›´æ¥è¿”å›å¡«å……åçš„å®Œæ•´æ–‡æ¡£ï¼Œä¸è¦æœ‰ä»»ä½•è§£é‡Šã€‚
    `;
    
    const response = await openai.chat.completions.create({
      model: "gpt-4",
      messages: [
        { role: "system", content: "ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„å¹¼å„¿å›­æ–‡æ¡£åŠ©æ‰‹" },
        { role: "user", content: prompt }
      ],
      temperature: 0.3
    });
    
    return response.choices[0].message.content;
  }
  
  // AIæ£€æŸ¥å†…å®¹
  async aiCheckContent(content: string): Promise<{
    isComplete: boolean;
    issues: string[];
    suggestions: string[];
  }> {
    const prompt = `
è¯·æ£€æŸ¥ä»¥ä¸‹å¹¼å„¿å›­æ–‡æ¡£çš„å®Œæ•´æ€§å’Œè§„èŒƒæ€§ï¼š

${content}

è¯·è¿”å›JSONæ ¼å¼ï¼š
{
  "isComplete": true/false,
  "issues": ["é—®é¢˜1", "é—®é¢˜2"],
  "suggestions": ["å»ºè®®1", "å»ºè®®2"]
}
    `;
    
    const response = await openai.chat.completions.create({
      model: "gpt-4",
      messages: [{ role: "user", content: prompt }],
      response_format: { type: "json_object" }
    });
    
    return JSON.parse(response.choices[0].message.content);
  }
}
```

---

## ğŸ“‹ æœ€ç»ˆå»ºè®®

### æ¨èæ–¹æ¡ˆï¼š**æ··åˆæ–¹æ¡ˆï¼ˆé˜¶æ®µæ€§å®æ–½ï¼‰**

**ç¬¬ä¸€é˜¶æ®µ**ï¼ˆ2å‘¨ï¼‰ï¼š
- âœ… ä½¿ç”¨Markdownå­˜å‚¨ï¼ˆæ–¹æ¡ˆBï¼‰
- âœ… ç®€å•çš„å˜é‡æå–å’Œæ›¿æ¢
- âœ… åŸºç¡€AIè¾…åŠ©å¡«å……
- âœ… å¿«é€Ÿä¸Šçº¿éªŒè¯

**ç¬¬äºŒé˜¶æ®µ**ï¼ˆ4-6å‘¨ï¼‰ï¼š
- âœ… æ·»åŠ JSONå…ƒæ•°æ®
- âœ… å®Œå–„å˜é‡å®šä¹‰å’Œè‡ªåŠ¨å¡«å……
- âœ… æ·»åŠ è¡¨å•é…ç½®
- âœ… ä¼˜åŒ–AIåŠŸèƒ½

**é•¿æœŸä¼˜åŒ–**ï¼š
- âœ… æ ¹æ®ä½¿ç”¨æƒ…å†µï¼Œå°†é«˜é¢‘æ¨¡æ¿è½¬ä¸ºå®Œå…¨ç»“æ„åŒ–ï¼ˆJSONï¼‰
- âœ… ä¿ç•™ä½é¢‘æ¨¡æ¿ä¸ºMarkdownæ ¼å¼
- âœ… æŒç»­ä¼˜åŒ–AIè¾…åŠ©åŠŸèƒ½

---

**æ€»ç»“**: 
- åˆæœŸç”¨Markdownå¿«é€Ÿä¸Šçº¿
- é€æ­¥æ·»åŠ ç»“æ„åŒ–å…ƒæ•°æ®
- æœ€ç»ˆå½¢æˆæ··åˆæ–¹æ¡ˆ
- AIä½œä¸ºè¾…åŠ©å·¥å…·ï¼Œä¸å®Œå…¨ä¾èµ–

è¿™æ ·æ—¢èƒ½å¿«é€Ÿä¸Šçº¿ï¼Œåˆèƒ½ä¿è¯é•¿æœŸçš„å¯ç»´æŠ¤æ€§å’Œæ‰©å±•æ€§ï¼

