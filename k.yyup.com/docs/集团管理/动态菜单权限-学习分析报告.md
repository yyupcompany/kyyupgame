# åŠ¨æ€èœå•æƒé™ - å­¦ä¹ åˆ†ææŠ¥å‘Š

**åˆ†ææ—¶é—´**: 2025-10-11  
**ç›®çš„**: å­¦ä¹ å…¶ä»–ä¸­å¿ƒçš„åŠ¨æ€èœå•æƒé™å®ç°æ–¹å¼

---

## ğŸ“š å…¶ä»–ä¸­å¿ƒçš„æƒé™ç»“æ„

### 1. äººå‘˜ä¸­å¿ƒ (PERSONNEL_CENTER)

**æ•°æ®åº“é…ç½®**:
```sql
-- ä¸€çº§èœå• (category)
code: PERSONNEL_CENTER
type: category
parent_id: null
path: /centers/personnel
component: PersonnelCenter

-- äºŒçº§èœå• (menu)
1. å­¦ç”Ÿç®¡ç† (type=menu, path=/student)
2. æ•™å¸ˆç®¡ç† (type=menu, path=/teacher)
3. å®¶é•¿ç®¡ç† (type=menu, path=/parent)
4. ç­çº§ç®¡ç† (type=menu, path=/class)
```

**å‰ç«¯è·¯ç”±** (`optimized-routes.ts`):
```typescript
{
  path: 'personnel',
  name: 'PersonnelCenter',
  component: PersonnelCenter,  // ä¸­å¿ƒé¡µé¢ç»„ä»¶
  meta: {
    title: 'äººäº‹ä¸­å¿ƒ',
    permission: 'PERSONNEL_CENTER'
  }
}
```

**ä¾§è¾¹æ æ˜¾ç¤º**:
```
äººå‘˜ä¸­å¿ƒ
â”œâ”€â”€ å­¦ç”Ÿç®¡ç†
â”œâ”€â”€ æ•™å¸ˆç®¡ç†
â”œâ”€â”€ å®¶é•¿ç®¡ç†
â””â”€â”€ ç­çº§ç®¡ç†
```

---

### 2. æ´»åŠ¨ä¸­å¿ƒ (activity_center_timeline_page)

**æ•°æ®åº“é…ç½®**:
```sql
-- ä¸€çº§èœå• (category)
code: activity_center_timeline_page
type: category
parent_id: null
path: /centers/activity
component: pages/centers/ActivityCenter

-- äºŒçº§èœå• (menu)
1. æ´»åŠ¨ç®¡ç† (type=menu, path=/activity)
2. æ´»åŠ¨æ¨¡æ¿ (type=menu, path=/activity/template)
3. æ´»åŠ¨æŠ¥å (type=menu, path=/activity/registration)
4. æ´»åŠ¨è¯„ä¼° (type=menu, path=/activity/evaluation)
5. æ´»åŠ¨åˆ†äº« (type=menu, path=/activity/share)
```

**å‰ç«¯è·¯ç”±**:
```typescript
{
  path: 'activity',
  name: 'ActivityCenter',
  component: ActivityCenter,  // ä¸­å¿ƒé¡µé¢ç»„ä»¶
  meta: {
    title: 'æ´»åŠ¨ä¸­å¿ƒ',
    permission: 'ACTIVITY_CENTER_VIEW'
  }
}
```

**ä¾§è¾¹æ æ˜¾ç¤º**:
```
æ´»åŠ¨ä¸­å¿ƒ
â”œâ”€â”€ æ´»åŠ¨ç®¡ç†
â”œâ”€â”€ æ´»åŠ¨æ¨¡æ¿
â”œâ”€â”€ æ´»åŠ¨æŠ¥å
â”œâ”€â”€ æ´»åŠ¨è¯„ä¼°
â””â”€â”€ æ´»åŠ¨åˆ†äº«
```

---

### 3. è¥é”€ä¸­å¿ƒ (MARKETING_CENTER)

**æ•°æ®åº“é…ç½®**:
```sql
-- ä¸€çº§èœå• (category)
code: MARKETING_CENTER
type: category
parent_id: null
path: /centers/marketing
component: MarketingCenter

-- äºŒçº§èœå• (menu)
1. è¥é”€æ´»åŠ¨ (type=menu, path=/marketing)
2. å¹¿å‘Šç®¡ç† (type=menu, path=/advertisement)
3. æµ·æŠ¥ç”Ÿæˆ (type=menu, path=/poster)
4. æ•°æ®åˆ†æ (type=menu, path=/marketing/analytics)
5. æ¨å¹¿ä¸­å¿ƒ (type=menu, path=/marketing/referrals)
```

**å‰ç«¯è·¯ç”±**:
```typescript
{
  path: 'marketing',
  name: 'MarketingCenter',
  component: MarketingCenter,  // ä¸­å¿ƒé¡µé¢ç»„ä»¶
  meta: {
    title: 'è¥é”€ä¸­å¿ƒ',
    permission: 'MARKETING_CENTER_VIEW'
  },
  children: [
    {
      path: 'channels',
      name: 'MarketingChannels',
      component: () => import('@/pages/marketing/channels/index.vue'),
      meta: { title: 'æ¸ é“ç®¡ç†', permission: 'MARKETING_CHANNELS_MANAGE' }
    },
    // ... æ›´å¤šå­è·¯ç”±
  ]
}
```

**ä¾§è¾¹æ æ˜¾ç¤º**:
```
è¥é”€ä¸­å¿ƒ
â”œâ”€â”€ è¥é”€æ´»åŠ¨
â”œâ”€â”€ å¹¿å‘Šç®¡ç†
â”œâ”€â”€ æµ·æŠ¥ç”Ÿæˆ
â”œâ”€â”€ æ•°æ®åˆ†æ
â””â”€â”€ æ¨å¹¿ä¸­å¿ƒ
```

---

## ğŸ” ä¸‰ä¸ªæ–°ä¸­å¿ƒçš„å¯¹æ¯”

### è€ƒå‹¤ä¸­å¿ƒ (ATTENDANCE_CENTER)

**æ•°æ®åº“é…ç½®**:
```sql
-- ä¸€çº§èœå• (category)
code: ATTENDANCE_CENTER
type: category âœ…
parent_id: null âœ…
path: /centers/attendance âœ…
component: pages/centers/AttendanceCenter.vue âœ…

-- äºŒçº§èœå• (menu) - 5ä¸ª
1. è€ƒå‹¤ç»Ÿè®¡ (path=/centers/attendance/statistics)
2. ç­çº§ç»Ÿè®¡ (path=/centers/attendance/class-statistics)
3. å¼‚å¸¸åˆ†æ (path=/centers/attendance/abnormal)
4. å¥åº·ç›‘æµ‹ (path=/centers/attendance/health)
5. è®°å½•ç®¡ç† (path=/centers/attendance/records)
```

**çŠ¶æ€**: âœ… **å®Œå…¨ç¬¦åˆæ ‡å‡†æ¨¡å¼**

---

### é›†å›¢ç®¡ç† (GROUP_MANAGEMENT)

**æ•°æ®åº“é…ç½®**:
```sql
-- ä¸€çº§èœå• (category)
code: GROUP_MANAGEMENT
type: category âœ…
parent_id: null âœ…
path: /group âœ…
component: pages/group/group-list.vue âœ…

-- äºŒçº§èœå• (menu) - 5ä¸ª
1. é›†å›¢åˆ—è¡¨ (path=/group/list)
2. é›†å›¢è¯¦æƒ… (path=/group/detail/:id)
3. åˆ›å»ºé›†å›¢ (path=/group/create)
4. ç¼–è¾‘é›†å›¢ (path=/group/edit/:id)
5. å‡çº§ä¸ºé›†å›¢ (path=/group/upgrade)
```

**çŠ¶æ€**: âœ… **å®Œå…¨ç¬¦åˆæ ‡å‡†æ¨¡å¼**

---

### ç”¨é‡ä¸­å¿ƒ (USAGE_CENTER)

**æ•°æ®åº“é…ç½®**:
```sql
-- ä¸€çº§èœå• (category)
code: USAGE_CENTER
type: category âœ…
parent_id: null âœ…
path: /usage-center âœ…
component: pages/usage-center/index.vue âœ…

-- äºŒçº§èœå• (menu) - 0ä¸ª
(æ²¡æœ‰å­èœå•) âš ï¸
```

**çŠ¶æ€**: âš ï¸ **æ²¡æœ‰å­èœå•ï¼Œä½†è¿™æ˜¯åˆç†çš„**

**è¯´æ˜**: ç”¨é‡ä¸­å¿ƒå¯èƒ½æ˜¯ä¸€ä¸ªå•é¡µé¢åº”ç”¨ï¼Œä¸éœ€è¦å­èœå•ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„å‰ç«¯ä¿®å¤ï¼ˆå°†categoryæœ¬èº«ä½œä¸ºèœå•é¡¹ï¼‰æ˜¯æ­£ç¡®çš„ã€‚

---

## ğŸ“Š æ ‡å‡†æƒé™æ¨¡å¼æ€»ç»“

### æ¨¡å¼1: æœ‰å­èœå•çš„ä¸­å¿ƒï¼ˆæ ‡å‡†æ¨¡å¼ï¼‰

**æ•°æ®åº“ç»“æ„**:
```
category (ä¸€çº§èœå•)
â”œâ”€â”€ menu (äºŒçº§èœå•1)
â”œâ”€â”€ menu (äºŒçº§èœå•2)
â”œâ”€â”€ menu (äºŒçº§èœå•3)
â””â”€â”€ ...
```

**åç«¯APIè¿”å›**:
```json
{
  "id": "personnel-center",
  "chinese_name": "äººå‘˜ä¸­å¿ƒ",
  "type": "category",
  "path": "/centers/personnel",
  "component": "PersonnelCenter",
  "children": [
    {
      "chinese_name": "å­¦ç”Ÿç®¡ç†",
      "type": "menu",
      "path": "/student"
    },
    // ... æ›´å¤šå­èœå•
  ]
}
```

**å‰ç«¯menuGroupsè½¬æ¢**:
```json
{
  "id": "personnel-center",
  "title": "äººå‘˜ä¸­å¿ƒ",
  "items": [
    {
      "title": "å­¦ç”Ÿç®¡ç†",
      "route": "/student"
    },
    // ... æ›´å¤šå­èœå•
  ]
}
```

**ä¾§è¾¹æ æ¸²æŸ“**:
```
äººå‘˜ä¸­å¿ƒ (section)
â”œâ”€â”€ å­¦ç”Ÿç®¡ç† (item)
â”œâ”€â”€ æ•™å¸ˆç®¡ç† (item)
â””â”€â”€ ...
```

---

### æ¨¡å¼2: æ²¡æœ‰å­èœå•çš„ä¸­å¿ƒï¼ˆç‰¹æ®Šæ¨¡å¼ï¼‰

**æ•°æ®åº“ç»“æ„**:
```
category (ä¸€çº§èœå•)
(æ²¡æœ‰å­èœå•)
```

**åç«¯APIè¿”å›**:
```json
{
  "id": "usage-center",
  "chinese_name": "ç”¨é‡ä¸­å¿ƒ",
  "type": "category",
  "path": "/usage-center",
  "component": "pages/usage-center/index.vue",
  "children": []  // ç©ºæ•°ç»„
}
```

**å‰ç«¯menuGroupsè½¬æ¢ï¼ˆä¿®å¤å‰ï¼‰**:
```json
{
  "id": "usage-center",
  "title": "ç”¨é‡ä¸­å¿ƒ",
  "items": []  // âŒ ç©ºæ•°ç»„ï¼Œä¾§è¾¹æ ä¸æ˜¾ç¤º
}
```

**å‰ç«¯menuGroupsè½¬æ¢ï¼ˆä¿®å¤åï¼‰**:
```json
{
  "id": "usage-center",
  "title": "ç”¨é‡ä¸­å¿ƒ",
  "items": [
    {
      "title": "ç”¨é‡ä¸­å¿ƒ",
      "route": "/usage-center"
    }
  ]  // âœ… å°†categoryæœ¬èº«ä½œä¸ºèœå•é¡¹
}
```

**ä¾§è¾¹æ æ¸²æŸ“**:
```
ç”¨é‡ä¸­å¿ƒ (section)
â””â”€â”€ ç”¨é‡ä¸­å¿ƒ (item) - ç›´æ¥è·³è½¬åˆ° /usage-center
```

---

## ğŸ¯ å…³é”®å‘ç°

### 1. æƒé™å±‚çº§ç»“æ„

**æ ‡å‡†ä¸‰å±‚ç»“æ„**:
```
category (ä¸€çº§åˆ†ç±») - åœ¨ä¾§è¾¹æ æ˜¾ç¤ºä¸ºsection
â”œâ”€â”€ menu (äºŒçº§èœå•) - åœ¨ä¾§è¾¹æ æ˜¾ç¤ºä¸ºitem
â”‚   â””â”€â”€ button (ä¸‰çº§æŒ‰é’®) - åœ¨é¡µé¢å†…æ˜¾ç¤ºä¸ºæŒ‰é’®æƒé™
```

**ç¤ºä¾‹**:
```
äººå‘˜ä¸­å¿ƒ (category)
â”œâ”€â”€ å­¦ç”Ÿç®¡ç† (menu)
â”‚   â”œâ”€â”€ æ·»åŠ å­¦ç”Ÿ (button)
â”‚   â”œâ”€â”€ ç¼–è¾‘å­¦ç”Ÿ (button)
â”‚   â””â”€â”€ åˆ é™¤å­¦ç”Ÿ (button)
â”œâ”€â”€ æ•™å¸ˆç®¡ç† (menu)
â””â”€â”€ ...
```

---

### 2. componentå­—æ®µçš„ä½œç”¨

**categoryçš„component**:
- æŒ‡å‘ä¸­å¿ƒé¡µé¢çš„ç»„ä»¶
- ä¾‹å¦‚: `PersonnelCenter`, `pages/centers/ActivityCenter`
- ç”¨äºåŠ¨æ€è·¯ç”±ç”Ÿæˆ

**menuçš„component**:
- æŒ‡å‘å…·ä½“åŠŸèƒ½é¡µé¢çš„ç»„ä»¶
- ä¾‹å¦‚: `pages/student/index.vue`, `pages/teacher/index.vue`
- ç”¨äºå­è·¯ç”±ç”Ÿæˆ

---

### 3. ä¾§è¾¹æ æ¸²æŸ“é€»è¾‘

**ImprovedSidebar.vue**:
```vue
<div v-for="section in filteredNavigation" :key="section.id">
  <!-- sectionæ ‡é¢˜ -->
  <div class="nav-section-title">{{ section.title }}</div>
  
  <!-- sectionçš„èœå•é¡¹ -->
  <template v-for="item in section.items" :key="item.id">
    <a :href="item.route">{{ item.title }}</a>
  </template>
</div>
```

**å…³é”®ç‚¹**:
- `filteredNavigation` = `menuGroups`
- æ¯ä¸ª `section` = ä¸€ä¸ª `category`
- æ¯ä¸ª `item` = ä¸€ä¸ª `menu`ï¼ˆæˆ–categoryæœ¬èº«ï¼Œå¦‚æœæ²¡æœ‰childrenï¼‰

---

### 4. å‰ç«¯menuGroupsè½¬æ¢é€»è¾‘

**ä¿®å¤å‰çš„é—®é¢˜**:
```typescript
items: (category.children || []).map(...)
// å¦‚æœchildrenä¸ºç©ºæ•°ç»„ï¼Œitemsä¹Ÿæ˜¯ç©ºæ•°ç»„
// ä¾§è¾¹æ ä¸æ˜¾ç¤ºä»»ä½•å†…å®¹
```

**ä¿®å¤åçš„é€»è¾‘**:
```typescript
const items = children.length > 0 
  ? children.map(...)  // æœ‰childrenï¼Œæ˜ å°„children
  : [{
      // æ²¡æœ‰childrenï¼Œå°†categoryæœ¬èº«ä½œä¸ºèœå•é¡¹
      id: category.id,
      title: category.chinese_name,
      route: category.path,
      icon: category.icon,
      children: []
    }];
```

---

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. æ·»åŠ æ–°ä¸­å¿ƒçš„æ ‡å‡†æµç¨‹

#### æ­¥éª¤1: æ•°æ®åº“é…ç½®

```sql
-- 1. åˆ›å»ºcategoryæƒé™
INSERT INTO permissions (
  name, chinese_name, code, type, parent_id, 
  path, component, icon, sort, status
) VALUES (
  'New Center', 'æ–°ä¸­å¿ƒ', 'NEW_CENTER', 'category', NULL,
  '/centers/new', 'pages/centers/NewCenter.vue', 'Icon', 100, 1
);

-- 2. åˆ›å»ºmenuæƒé™ï¼ˆå¦‚æœæœ‰å­èœå•ï¼‰
INSERT INTO permissions (
  name, chinese_name, code, type, parent_id,
  path, component, icon, sort, status
) VALUES (
  'Feature 1', 'åŠŸèƒ½1', 'NEW_CENTER_FEATURE1', 'menu', 
  (SELECT id FROM permissions WHERE code = 'NEW_CENTER'),
  '/centers/new/feature1', 'pages/new/feature1.vue', 'Icon', 1, 1
);
```

#### æ­¥éª¤2: åˆ†é…æƒé™ç»™è§’è‰²

```sql
INSERT INTO role_permissions (role_id, permission_id)
SELECT 1, id FROM permissions WHERE code IN ('NEW_CENTER', 'NEW_CENTER_FEATURE1');
```

#### æ­¥éª¤3: å‰ç«¯ç»„ä»¶æ˜ å°„

åœ¨ `client/src/router/dynamic-routes.ts` ä¸­æ·»åŠ ç»„ä»¶æ˜ å°„ï¼š

```typescript
const componentMap = {
  // ... å…¶ä»–æ˜ å°„
  'pages/centers/NewCenter.vue': () => import('../pages/centers/NewCenter.vue'),
  'pages/new/feature1.vue': () => import('../pages/new/feature1.vue'),
};
```

#### æ­¥éª¤4: éªŒè¯

1. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜
2. é‡æ–°ç™»å½•
3. æ£€æŸ¥ä¾§è¾¹æ æ˜¯å¦æ˜¾ç¤ºæ–°ä¸­å¿ƒ

---

### 2. æ²¡æœ‰å­èœå•çš„ä¸­å¿ƒ

å¦‚æœä¸­å¿ƒä¸éœ€è¦å­èœå•ï¼ˆå¦‚ç”¨é‡ä¸­å¿ƒï¼‰ï¼š

**æ•°æ®åº“é…ç½®**:
```sql
-- åªåˆ›å»ºcategoryï¼Œä¸åˆ›å»ºmenu
INSERT INTO permissions (
  name, chinese_name, code, type, parent_id,
  path, component, icon, sort, status
) VALUES (
  'Usage Center', 'ç”¨é‡ä¸­å¿ƒ', 'USAGE_CENTER', 'category', NULL,
  '/usage-center', 'pages/usage-center/index.vue', 'data-analysis', 100, 1
);
```

**å‰ç«¯å¤„ç†**:
- menuGroupsè½¬æ¢é€»è¾‘ä¼šè‡ªåŠ¨å°†categoryæœ¬èº«ä½œä¸ºèœå•é¡¹
- ä¾§è¾¹æ æ˜¾ç¤ºä¸€ä¸ªå¯ç‚¹å‡»çš„èœå•é¡¹
- ç‚¹å‡»åç›´æ¥è·³è½¬åˆ° `/usage-center`

---

## ğŸ“ æ€»ç»“

### æ ‡å‡†æƒé™æ¨¡å¼

1. **category** (ä¸€çº§åˆ†ç±»)
   - `type = 'category'`
   - `parent_id = null`
   - `component` æŒ‡å‘ä¸­å¿ƒé¡µé¢ç»„ä»¶
   - åœ¨ä¾§è¾¹æ æ˜¾ç¤ºä¸ºsectionæ ‡é¢˜

2. **menu** (äºŒçº§èœå•)
   - `type = 'menu'`
   - `parent_id = category.id`
   - `component` æŒ‡å‘åŠŸèƒ½é¡µé¢ç»„ä»¶
   - åœ¨ä¾§è¾¹æ æ˜¾ç¤ºä¸ºå¯ç‚¹å‡»çš„èœå•é¡¹

3. **button** (ä¸‰çº§æŒ‰é’®)
   - `type = 'button'`
   - `parent_id = menu.id`
   - åœ¨é¡µé¢å†…æ§åˆ¶æŒ‰é’®æ˜¾ç¤º/éšè—

### ä¸‰ä¸ªæ–°ä¸­å¿ƒçš„çŠ¶æ€

| ä¸­å¿ƒ | é…ç½® | å­èœå• | çŠ¶æ€ |
|------|------|--------|------|
| è€ƒå‹¤ä¸­å¿ƒ | âœ… æ­£ç¡® | 5ä¸ª | âœ… å®Œå…¨ç¬¦åˆæ ‡å‡† |
| é›†å›¢ç®¡ç† | âœ… æ­£ç¡® | 5ä¸ª | âœ… å®Œå…¨ç¬¦åˆæ ‡å‡† |
| ç”¨é‡ä¸­å¿ƒ | âœ… æ­£ç¡® | 0ä¸ª | âœ… ç‰¹æ®Šä½†åˆç† |

### å‰ç«¯ä¿®å¤çš„å¿…è¦æ€§

- âœ… ä¿®å¤äº†æ²¡æœ‰å­èœå•çš„categoryæ— æ³•æ˜¾ç¤ºçš„é—®é¢˜
- âœ… æ”¯æŒäº†ä¸¤ç§æ¨¡å¼ï¼šæœ‰å­èœå•å’Œæ²¡æœ‰å­èœå•
- âœ… ä¿æŒäº†ä¸å…¶ä»–ä¸­å¿ƒçš„ä¸€è‡´æ€§

---

**å­¦ä¹ å®Œæˆï¼** ğŸ“

ç°åœ¨æˆ‘ä»¬å®Œå…¨ç†è§£äº†åŠ¨æ€èœå•æƒé™çš„å®ç°æ–¹å¼ï¼Œå¹¶ä¸”å·²ç»æ­£ç¡®é…ç½®äº†ä¸‰ä¸ªæ–°ä¸­å¿ƒï¼

