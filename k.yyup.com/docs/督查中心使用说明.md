# 督查中心使用说明

## 📋 目录

1. [功能概述](#功能概述)
2. [核心功能使用说明](#核心功能使用说明)
3. [任务评论功能使用](#任务评论功能使用)
4. [提醒日志功能使用](#提醒日志功能使用)
5. [API接口说明](#api接口说明)
6. [常见问题](#常见问题)

---

## 功能概述

督查中心是幼儿园管理系统的核心模块之一,提供全年检查计划管理、文档管理、智能提醒等功能。

### 主要特点

- ✅ **可视化时间轴** - 全年检查计划一目了然
- ✅ **智能提醒** - 自动提醒检查任务,不遗漏
- ✅ **文档管理** - 78个文档模板,26个文档实例
- ✅ **任务评论** - 支持任务协作和沟通
- ✅ **提醒日志** - 完整的提醒记录和统计
- ✅ **AI智能分析** - AI辅助文档填写和分析

### 数据统计

| 统计项 | 数量 |
|--------|------|
| 待开始检查 | 23个 |
| 准备中检查 | 2个 |
| 进行中检查 | 2个 |
| 已完成检查 | 22个 |
| 文档模板 | 78个 |
| 文档实例 | 26个 |

---

## 核心功能使用说明

### 1. 年度检查时间轴

#### 访问路径
```
系统首页 → 督查中心 → 年度检查时间轴
```

#### 功能说明

**时间轴视图**
- 按时间顺序展示全年49个检查计划
- 每个检查计划显示:
  - 检查名称和类型(年度检查/专项检查/常态化督导)
  - 检查状态(待开始/准备中/进行中/已完成)
  - 检查部门、频次、时长
  - 计划日期和备注信息

**视图切换**
- **时间轴视图** - 按时间线展示(默认)
- **月度视图** - 按月份分组展示
- **列表视图** - 表格形式展示

**年份选择**
- 支持切换查看不同年份的检查计划
- 默认显示2025年

#### 操作步骤

1. **查看检查计划**
   - 进入督查中心页面
   - 在时间轴中浏览检查计划
   - 点击检查计划卡片查看详情

2. **编辑检查计划**
   - 点击检查计划卡片上的"编辑"按钮
   - 在弹出的对话框中修改:
     - 检查类型
     - 计划日期
     - 负责人和联系电话
     - 检查状态
     - 备注信息
   - 点击"保存"按钮提交修改

3. **创建任务**
   - 点击检查计划卡片上的"任务"按钮
   - 为检查计划创建具体的执行任务
   - 分配任务负责人和截止时间

### 2. 文档管理中心

#### 访问路径
```
系统首页 → 督查中心 → 文档管理中心
```

#### 功能说明

**文档模板库**
- 78个预置文档模板
- 7个模板分类:
  - 幼儿园年检自查报告
  - 幼儿园年检评分表
  - 幼儿园基本情况统计表
  - 办园行为督导评估自评表
  - 办学许可证及相关证照
  - 等级评估自评报告
  - 等级评估申报表

**文档实例管理**
- 26个文档实例
- 支持文档状态管理:
  - 草稿 - 正在编辑中
  - 待审核 - 已提交待审核
  - 已审核 - 审核通过
- 显示文档完成率进度条
- 记录创建时间和截止日期

#### 操作步骤

1. **创建文档**
   - 点击"创建文档"按钮
   - 选择文档模板
   - 填写文档标题和基本信息
   - 开始填写文档内容

2. **查看文档**
   - 在文档列表中找到目标文档
   - 点击"查看"按钮
   - 查看文档详细内容

3. **编辑文档**
   - 点击文档行的"编辑"按钮
   - 修改文档内容
   - 保存修改

4. **AI智能辅助**
   - 点击文档行的"AI辅助"按钮
   - AI自动分析文档内容
   - 提供填写建议和优化建议

5. **删除文档**
   - 点击文档行的"删除"按钮
   - 确认删除操作

6. **筛选和搜索**
   - 使用模板类别下拉框筛选
   - 使用文档模板下拉框筛选
   - 使用搜索框搜索文档标题

### 3. 生成年度计划

#### 功能说明
- 自动生成全年检查计划
- 根据检查类型和频次智能安排时间
- 支持批量创建检查计划

#### 操作步骤
1. 点击页面顶部"生成年度计划"按钮
2. 选择年份和检查类型
3. 系统自动生成检查计划
4. 确认并保存

### 4. 上传检查文档

#### 功能说明
- 支持上传检查相关文档
- 支持多种文件格式(PDF, Word, Excel等)
- 自动关联到对应的检查计划

#### 操作步骤
1. 点击页面顶部"上传检查文档"按钮
2. 选择要上传的文件
3. 选择关联的检查计划
4. 填写文档说明
5. 确认上传

---

## 任务评论功能使用

### 功能概述
任务评论功能允许团队成员对检查任务进行讨论和协作。

### API端点

#### 1. 获取任务评论列表
```
GET /api/inspection-tasks/:taskId/comments
```

**参数**:
- `taskId` - 任务ID

**返回示例**:
```json
{
  "success": true,
  "data": [
    {
      "id": 1,
      "taskId": 123,
      "userId": 456,
      "content": "这个检查项需要重点关注消防设施",
      "createdAt": "2025-01-15T10:30:00Z",
      "user": {
        "id": 456,
        "name": "张三",
        "avatar": "..."
      }
    }
  ]
}
```

#### 2. 创建任务评论
```
POST /api/inspection-tasks/:taskId/comments
```

**请求体**:
```json
{
  "content": "评论内容"
}
```

#### 3. 删除任务评论
```
DELETE /api/task-comments/:commentId
```

**权限**: 只有评论作者可以删除自己的评论

### 使用场景

1. **任务讨论**
   - 团队成员对任务进行讨论
   - 提出问题和建议
   - 分享经验和最佳实践

2. **进度更新**
   - 汇报任务执行进度
   - 说明遇到的问题
   - 请求支持和帮助

3. **结果反馈**
   - 分享检查结果
   - 提出改进建议
   - 记录重要发现

---

## 提醒日志功能使用

### 功能概述
提醒日志功能记录所有检查提醒的发送情况,支持统计和分析。

### API端点

#### 1. 获取提醒日志列表
```
GET /api/reminder-logs
```

**查询参数**:
- `page` - 页码(默认1)
- `pageSize` - 每页数量(默认10)
- `status` - 提醒状态(pending/sent/failed)
- `inspectionPlanId` - 检查计划ID
- `startDate` - 开始日期
- `endDate` - 结束日期

**返回示例**:
```json
{
  "success": true,
  "data": {
    "items": [
      {
        "id": 1,
        "inspectionPlanId": 123,
        "sentTo": 456,
        "sentAt": "2025-01-15T09:00:00Z",
        "status": "sent",
        "message": "提醒: 年度办园行为督导评估将于明天开始",
        "inspectionPlan": {
          "id": 123,
          "title": "年度办园行为督导评估"
        },
        "recipient": {
          "id": 456,
          "name": "张三"
        }
      }
    ],
    "total": 100,
    "page": 1,
    "pageSize": 10
  }
}
```

#### 2. 获取提醒统计
```
GET /api/reminder-logs/stats
```

**返回示例**:
```json
{
  "success": true,
  "data": {
    "total": 150,
    "sent": 140,
    "pending": 5,
    "failed": 5,
    "successRate": 93.33
  }
}
```

#### 3. 获取提醒日志详情
```
GET /api/reminder-logs/:id
```

#### 4. 创建提醒日志
```
POST /api/reminder-logs
```

**请求体**:
```json
{
  "inspectionPlanId": 123,
  "sentTo": 456,
  "message": "提醒内容"
}
```

#### 5. 更新提醒日志状态
```
PUT /api/reminder-logs/:id/status
```

**请求体**:
```json
{
  "status": "sent"
}
```

### 使用场景

1. **提醒发送监控**
   - 查看提醒发送状态
   - 监控发送成功率
   - 处理发送失败的提醒

2. **提醒历史查询**
   - 查询某个检查计划的提醒历史
   - 查询某个用户收到的提醒
   - 按时间范围筛选提醒

3. **提醒效果分析**
   - 统计提醒发送数量
   - 分析提醒成功率
   - 优化提醒策略

---

## API接口说明

### 完整API列表

#### 检查计划管理
- `GET /api/inspection/plans` - 获取检查计划列表
- `GET /api/inspection/plans/:id` - 获取检查计划详情
- `POST /api/inspection/plans` - 创建检查计划
- `PUT /api/inspection/plans/:id` - 更新检查计划
- `DELETE /api/inspection/plans/:id` - 删除检查计划

#### 文档管理
- `GET /api/document-instances` - 获取文档实例列表
- `GET /api/document-instances/:id` - 获取文档实例详情
- `POST /api/document-instances` - 创建文档实例
- `PUT /api/document-instances/:id` - 更新文档实例
- `DELETE /api/document-instances/:id` - 删除文档实例

#### 任务评论 (新增)
- `GET /api/inspection-tasks/:taskId/comments` - 获取任务评论列表
- `POST /api/inspection-tasks/:taskId/comments` - 创建任务评论
- `DELETE /api/task-comments/:commentId` - 删除任务评论

#### 提醒日志 (新增)
- `GET /api/reminder-logs` - 获取提醒日志列表
- `GET /api/reminder-logs/stats` - 获取提醒统计
- `GET /api/reminder-logs/:id` - 获取提醒日志详情
- `POST /api/reminder-logs` - 创建提醒日志
- `PUT /api/reminder-logs/:id/status` - 更新提醒日志状态

### 认证说明
所有API端点都需要JWT认证,请在请求头中包含:
```
Authorization: Bearer <your-jwt-token>
```

---

## 常见问题

### Q1: 如何修改检查计划的状态?
**A**: 点击检查计划卡片上的"编辑"按钮,在弹出的对话框中修改"检查状态"字段,然后保存。

### Q2: 文档完成率是如何计算的?
**A**: 文档完成率 = (已填写字段数 / 总字段数) × 100%

### Q3: 如何使用AI智能分析功能?
**A**: 在文档列表中点击"AI辅助"按钮,AI会自动分析文档内容并提供填写建议。

### Q4: 任务评论可以删除吗?
**A**: 可以。只有评论作者可以删除自己的评论。点击评论旁边的删除按钮即可。

### Q5: 提醒日志的状态有哪些?
**A**: 提醒日志有三种状态:
- `pending` - 待发送
- `sent` - 已发送
- `failed` - 发送失败

### Q6: 如何查看某个检查计划的所有提醒记录?
**A**: 使用提醒日志API,传入`inspectionPlanId`参数进行筛选。

### Q7: 文档模板可以自定义吗?
**A**: 目前系统提供78个预置模板。如需自定义模板,请联系系统管理员。

### Q8: 检查计划可以批量导入吗?
**A**: 可以。使用"生成年度计划"功能可以批量创建检查计划。

---

## 技术支持

如有任何问题,请联系:
- **技术支持邮箱**: support@yyup.cc
- **系统管理员**: admin@yyup.cc
- **在线帮助**: 点击页面右上角的"帮助"按钮

---

**最后更新**: 2025-10-13  
**版本**: v1.0.0  
**文档状态**: ✅ 已完成

