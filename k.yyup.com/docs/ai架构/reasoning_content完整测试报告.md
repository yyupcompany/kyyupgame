# reasoning_content å®Œæ•´æµ‹è¯•æŠ¥å‘Š

## ğŸ“‹ æµ‹è¯•æ¦‚è¿°

**æµ‹è¯•æ—¶é—´**: å½“å‰ä¼šè¯  
**æµ‹è¯•ç›®çš„**: éªŒè¯AIæ€è€ƒè¿‡ç¨‹ï¼ˆreasoning_contentï¼‰æ˜¯å¦æ­£ç¡®æ˜¾ç¤º  
**æµ‹è¯•æ–¹æ³•**: MCPæµè§ˆå™¨è‡ªåŠ¨åŒ–æµ‹è¯•  
**æµ‹è¯•æ¶ˆæ¯**: "åœ¨å›­äººæ•°"  
**æµ‹è¯•æ¨¡å¼**: Autoæ¨¡å¼ï¼ˆæ™ºèƒ½ä»£ç†ï¼‰

---

## ğŸ¯ æµ‹è¯•ç»“æœæ€»ç»“

### âœ… æˆåŠŸé¡¹
1. **å·¥å…·è°ƒç”¨æˆåŠŸ** - 6ä¸ªå·¥å…·è°ƒç”¨å…¨éƒ¨å®Œæˆ
2. **Autoæ¨¡å¼æ­£å¸¸** - æ™ºèƒ½ä»£ç†æ¨¡å¼å¯åŠ¨æˆåŠŸï¼Œå¤šè½®å·¥å…·è°ƒç”¨æ‰§è¡ŒæˆåŠŸ
3. **ä¸Šä¸‹æ–‡ä¼˜åŒ–æ­£å¸¸** - æ™ºèƒ½ä¸Šä¸‹æ–‡ä¼˜åŒ–åŠŸèƒ½æ­£å¸¸å·¥ä½œ
4. **åç«¯æ¥æ”¶reasoning_content** - åç«¯æˆåŠŸä»è±†åŒ…APIæ¥æ”¶åˆ°reasoning_content

### âŒ é—®é¢˜é¡¹
1. **AIæ€è€ƒè¿‡ç¨‹æ˜¾ç¤ºä¸æ­£ç¡®** - æ˜¾ç¤ºçš„æ˜¯å·¥å…·è°ƒç”¨æè¿°ï¼Œè€Œä¸æ˜¯çœŸå®çš„reasoning_content
2. **ç¼ºå¤±thinking_updateäº‹ä»¶** - å‰ç«¯æ²¡æœ‰æ¥æ”¶åˆ°åŒ…å«reasoning_contentçš„thinking_updateäº‹ä»¶
3. **ä¿®å¤ä»£ç æœªæ‰§è¡Œ** - ä¹‹å‰çš„ä¿®å¤åªé’ˆå¯¹éæµå¼é™çº§è·¯å¾„ï¼Œä½†Autoæ¨¡å¼ä½¿ç”¨æµå¼å·¥å…·è°ƒç”¨è·¯å¾„

---

## ğŸ“Š è¯¦ç»†æµ‹è¯•æ•°æ®

### å‰ç«¯æ˜¾ç¤º

**AI thinkåŒºåŸŸæ˜¾ç¤ºçš„å†…å®¹**ï¼ˆé”™è¯¯ï¼‰:
```
ï¿½ æ­£åœ¨æ‰§è¡Œæ™ºèƒ½æŸ¥è¯¢: "åœ¨å›­äººæ•°"
ï¿½ æ­£åœ¨æ‰§è¡Œæ™ºèƒ½æŸ¥è¯¢: "ç»Ÿè®¡åœ¨å›­äººæ•°"
ï¿½ æ­£åœ¨æ‰§è¡Œæ™ºèƒ½æŸ¥è¯¢: "ç»Ÿè®¡åœ¨å›­äººæ•°"
```

**åº”è¯¥æ˜¾ç¤ºçš„å†…å®¹**ï¼ˆæ­£ç¡®ï¼‰:
```
ç”¨æˆ·éœ€æ±‚æ˜¯è·å–åœ¨å›­äººæ•°ï¼Œä¹‹å‰å°è¯•ç”¨read_data_recordï¼ˆæœªæ‰¾åˆ°å®ç°ï¼‰ã€any_queryï¼ˆæŸ¥è¯¢å¤±è´¥ï¼‰ã€consult_recruitment_plannerï¼ˆæœªæ‰¾åˆ°å®ç°ï¼‰å‡æœªæˆåŠŸã€‚ç°æœ‰å·¥å…·ä¸­ï¼Œget_activity_statisticsæ˜¯æ´»åŠ¨ç»Ÿè®¡åˆ†æå·¥å…·ï¼Œä¸é€‚ç”¨ï¼›generate_excel_reportç­‰æ˜¯ç”ŸæˆæŠ¥è¡¨å·¥å…·ï¼Œéœ€è¦å…ˆæœ‰æ•°æ®ï¼›render_componentæ˜¯å±•ç¤ºç»„ä»¶ï¼Œæ²¡æœ‰...
```

### åç«¯æ—¥å¿—åˆ†æ

#### 1. AIå“åº”åŒ…å«reasoning_content âœ…

```
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ” [AIå“åº”] åŸå§‹å“åº”messageå­—æ®µ:
  - content: null
  - reasoning_content: "ç”¨æˆ·éœ€æ±‚æ˜¯è·å–åœ¨å›­äººæ•°ï¼Œä¹‹å‰å°è¯•ç”¨read_data_recordï¼ˆæœªæ‰¾åˆ°å®ç°ï¼‰ã€any_queryï¼ˆæŸ¥è¯¢å¤±è´¥ï¼‰ã€consult_recruitment_plannerï¼ˆæœªæ‰¾åˆ°å®ç°ï¼‰å‡æœªæˆåŠŸã€‚ç°æœ‰å·¥å…·..."
  - tool_calls: 1ä¸ªå·¥å…·è°ƒç”¨
âœ… [AIå“åº”] æ£€æµ‹åˆ°reasoning_contentå­—æ®µï¼
ğŸ“ [AIå“åº”] reasoning_contenté•¿åº¦: 459
ğŸ“ [AIå“åº”] reasoning_contentå†…å®¹é¢„è§ˆ: ç”¨æˆ·éœ€æ±‚æ˜¯è·å–åœ¨å›­äººæ•°ï¼Œä¹‹å‰å°è¯•ç”¨read_data_recordï¼ˆæœªæ‰¾åˆ°å®ç°ï¼‰ã€any_queryï¼ˆæŸ¥è¯¢å¤±è´¥ï¼‰ã€consult_recruitment_plannerï¼ˆæœªæ‰¾åˆ°å®ç°ï¼‰å‡æœªæˆåŠŸã€‚ç°æœ‰å·¥å…·ä¸­ï¼Œget_activity_statisticsæ˜¯æ´»åŠ¨ç»Ÿè®¡åˆ†æå·¥å…·ï¼Œä¸é€‚ç”¨ï¼›generate_excel_reportç­‰æ˜¯ç”ŸæˆæŠ¥è¡¨å·¥å…·ï¼Œéœ€è¦å…ˆæœ‰æ•°æ®ï¼›render_componentæ˜¯å±•ç¤ºç»„ä»¶ï¼Œæ²¡æœ‰...
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
```

#### 2. ä½¿ç”¨çš„AIæ¨¡å‹ âœ…

```
ğŸš€ [AIBridge] å¼€å§‹æ·±åº¦æ€è€ƒæ¨ç†
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“‹ [AIBridge] æ·±åº¦æ€è€ƒæ¨¡å‹é…ç½®: doubao-seed-1-6-thinking-250615
ğŸ“ [AIBridge] æ¶ˆæ¯æ•°é‡: 8
ğŸ”§ [AIBridge] å·¥å…·æ•°é‡: 0
ğŸ‘¤ [AIBridge] ç”¨æˆ·ID: undefined
ğŸ§  [AIBridge] ä½¿ç”¨æ·±åº¦æ€è€ƒæ¨¡å‹: doubao-seed-1-6-thinking-250615
```

#### 3. å‘é€çš„SSEäº‹ä»¶ âŒ

**å®é™…å‘é€çš„äº‹ä»¶**:
```
ğŸ“¡ [SSEæ¨é€] äº‹ä»¶: tool_intent {"message":"æˆ‘å°†æ‰§è¡Œæ™ºèƒ½æŸ¥è¯¢ï¼Œè·å–ç›¸å…³æ•°æ®","toolName":"any_query"}
ğŸ“¡ [SSEæ¨é€] äº‹ä»¶: thinking ï¿½ æ­£åœ¨æ‰§è¡Œæ™ºèƒ½æŸ¥è¯¢: "åœ¨å›­äººæ•°"
ğŸ“¡ [SSEæ¨é€] äº‹ä»¶: tool_call_start {"name":"any_query","arguments":{"userQuery":"åœ¨å›­äººæ•°","queryType":"statistical","expectedFormat":"summary"}}
```

**ç¼ºå¤±çš„äº‹ä»¶**:
```
ğŸ“¡ [SSEæ¨é€] äº‹ä»¶: thinking_update {"content":"ç”¨æˆ·éœ€æ±‚æ˜¯è·å–åœ¨å›­äººæ•°ï¼Œä¹‹å‰å°è¯•ç”¨read_data_recordï¼ˆæœªæ‰¾åˆ°å®ç°ï¼‰...","message":"ğŸ¤” AIæ­£åœ¨æ€è€ƒ...","timestamp":"..."}
```

#### 4. ä¿®å¤ä»£ç æœªæ‰§è¡Œ âŒ

**é¢„æœŸçš„æ—¥å¿—**ï¼ˆæœªå‡ºç°ï¼‰:
```
âœ… [SSE] æ£€æµ‹åˆ°reasoning_contentï¼Œå‘é€thinking_updateäº‹ä»¶
ğŸ” [SSE] reasoning_contentå†…å®¹: ç”¨æˆ·éœ€æ±‚æ˜¯è·å–åœ¨å›­äººæ•°ï¼Œä¹‹å‰å°è¯•ç”¨read_data_recordï¼ˆæœªæ‰¾åˆ°å®ç°ï¼‰...
```

### å‰ç«¯æ—¥å¿—åˆ†æ

#### 1. æ¥æ”¶åˆ°çš„SSEäº‹ä»¶

```javascript
ğŸ“¥ [å‰ç«¯æ¥æ”¶] SSEäº‹ä»¶: thinking_start
ğŸ“ [å‰ç«¯æ¥æ”¶] äº‹ä»¶æ•°æ®: {"message":"ğŸ¤” AIå¼€å§‹æ€è€ƒ..."}

ğŸ“¥ [å‰ç«¯æ¥æ”¶] SSEäº‹ä»¶: thinking
ğŸ“ [å‰ç«¯æ¥æ”¶] äº‹ä»¶æ•°æ®: ï¿½ æ­£åœ¨æ‰§è¡Œæ™ºèƒ½æŸ¥è¯¢: "åœ¨å›­äººæ•°"

ğŸ“¥ [å‰ç«¯æ¥æ”¶] SSEäº‹ä»¶: tool_call_start
ğŸ“ [å‰ç«¯æ¥æ”¶] äº‹ä»¶æ•°æ®: {"name":"any_query","arguments":{"userQuery":"åœ¨å›­äººæ•°","queryType":"statistical","expectedFormat":"summary"},"intent":"æˆ‘å°†æ‰§è¡Œæ™ºèƒ½æŸ¥è¯¢ï¼Œè·å–ç›¸å…³æ•°æ®"}
```

#### 2. ç¼ºå¤±çš„äº‹ä»¶

```javascript
// âŒ æœªæ¥æ”¶åˆ°
ğŸ“¥ [å‰ç«¯æ¥æ”¶] SSEäº‹ä»¶: thinking_update
ğŸ“ [å‰ç«¯æ¥æ”¶] äº‹ä»¶æ•°æ®: {"content":"ç”¨æˆ·éœ€æ±‚æ˜¯è·å–åœ¨å›­äººæ•°ï¼Œä¹‹å‰å°è¯•ç”¨read_data_recordï¼ˆæœªæ‰¾åˆ°å®ç°ï¼‰...","message":"ğŸ¤” AIæ­£åœ¨æ€è€ƒ...","timestamp":"..."}
```

### å·¥å…·è°ƒç”¨å†å²

| è½®æ¬¡ | å·¥å…·åç§° | çŠ¶æ€ | ç»“æœ |
|------|---------|------|------|
| 1 | read_data_record | âœ… å®Œæˆ | é”™è¯¯ï¼šå·¥å…·æœªæ‰¾åˆ°å®ç° |
| 2 | any_query | âœ… å®Œæˆ | é”™è¯¯ï¼šæŸ¥è¯¢å¤±è´¥ |
| 3 | consult_recruitment_planner | âœ… å®Œæˆ | é”™è¯¯ï¼šå·¥å…·æœªæ‰¾åˆ°å®ç° |
| 4 | any_query | âœ… å®Œæˆ | é”™è¯¯ï¼šæŸ¥è¯¢å¤±è´¥ |
| 5 | any_query | âœ… å®Œæˆ | é”™è¯¯ï¼šæŸ¥è¯¢å¤±è´¥ |
| 6 | any_query | ğŸ”„ è¿è¡Œä¸­ | - |

---

## ğŸ” é—®é¢˜æ ¹æºåˆ†æ

### é—®é¢˜1: ä¿®å¤ä»£ç æœªæ‰§è¡Œ

**åŸå› **: æˆ‘ä»¬çš„ä¿®å¤åªé’ˆå¯¹**éæµå¼é™çº§è·¯å¾„**ï¼ˆ`unified-intelligence.service.ts`ä¸­çš„éæµå¼è°ƒç”¨ï¼‰ï¼Œä½†Autoæ¨¡å¼ä½¿ç”¨çš„æ˜¯**æµå¼å·¥å…·è°ƒç”¨è·¯å¾„**ã€‚

**è¯æ®**:
1. åç«¯æ—¥å¿—æ˜¾ç¤ºä½¿ç”¨çš„æ˜¯`doubao-seed-1-6-thinking-250615`ï¼ˆThinkingæ¨¡å‹ï¼‰
2. è¿™æ˜¯åœ¨æµå¼å·¥å…·è°ƒç”¨è·¯å¾„ä¸­è°ƒç”¨çš„
3. æˆ‘ä»¬çš„ä¿®å¤ä»£ç åœ¨éæµå¼é™çº§è·¯å¾„ä¸­ï¼Œæ‰€ä»¥æ²¡æœ‰è¢«æ‰§è¡Œ

**ä¿®å¤ä½ç½®**: `server/src/services/ai-operator/unified-intelligence.service.ts` (ç¬¬6200-6209è¡Œ)

**ä¿®å¤ä»£ç **ï¼ˆæœªè¢«æ‰§è¡Œï¼‰:
```typescript
const reasoningContent = message?.reasoning_content || ''; // ğŸ” æå–reasoning_content

// ğŸ” å¦‚æœæœ‰reasoning_contentï¼Œå…ˆå‘é€thinking_updateäº‹ä»¶ï¼ˆä¸å‰ç«¯ç›‘å¬çš„äº‹ä»¶ååŒ¹é…ï¼‰
if (reasoningContent) {
  console.log('âœ… [SSE] æ£€æµ‹åˆ°reasoning_contentï¼Œå‘é€thinking_updateäº‹ä»¶');
  console.log('ğŸ” [SSE] reasoning_contentå†…å®¹:', reasoningContent.substring(0, 100) + '...');
  sendSSE('thinking_update', {  // âœ… ä¿®æ”¹ä¸ºthinking_update
    content: reasoningContent,
    message: 'ğŸ¤” AIæ­£åœ¨æ€è€ƒ...',
    timestamp: new Date().toISOString()
  });
}
```

### é—®é¢˜2: æµå¼å·¥å…·è°ƒç”¨è·¯å¾„æœªå¤„ç†reasoning_content

**éœ€è¦ä¿®å¤çš„ä½ç½®**: æµå¼å·¥å…·è°ƒç”¨è·¯å¾„ä¸­å¤„ç†AIå“åº”çš„ä»£ç 

**å¯èƒ½çš„ä½ç½®**:
1. `server/src/routes/ai/function-tools.routes.ts` - å·¥å…·è°ƒç”¨è·¯ç”±
2. `server/src/services/ai-operator/unified-intelligence.service.ts` - æµå¼å¤„ç†é€»è¾‘

---

## âœ… ä¿®å¤å®Œæˆ

### ä¿®å¤ä½ç½®

**æ–‡ä»¶**: `server/src/services/ai-operator/unified-intelligence.service.ts`
**è¡Œå·**: 6937-6956
**ä¿®å¤ç±»å‹**: æ·»åŠ reasoning_contentæå–å’Œå‘é€é€»è¾‘

### ä¿®å¤ä»£ç 

```typescript
const choice = resp?.choices?.[0];
const message: any = choice?.message || {};
const content: string = message?.content || '';
const toolCalls: any[] = Array.isArray(message?.tool_calls) ? message.tool_calls : [];
const reasoningContent = message?.reasoning_content || ''; // ğŸ” æå–reasoning_content

// ğŸ” å¦‚æœæœ‰reasoning_contentï¼Œå…ˆå‘é€thinking_updateäº‹ä»¶
if (reasoningContent) {
  console.log('âœ… [SSE-AFC] æ£€æµ‹åˆ°reasoning_contentï¼Œå‘é€thinking_updateäº‹ä»¶');
  console.log('ğŸ” [SSE-AFC] reasoning_contentå†…å®¹:', reasoningContent.substring(0, 100) + '...');
  sendSSE('thinking_update', {
    content: reasoningContent,
    message: 'ğŸ¤” AIæ­£åœ¨æ€è€ƒ...',
    timestamp: new Date().toISOString()
  });
}

if (content) {
  sendSSE('content_update', { content, accumulated: content });
}
```

### ä¿®å¤è¯´æ˜

1. **æå–reasoning_content**: ä»AIå“åº”çš„messageå­—æ®µä¸­æå–`reasoning_content`
2. **å‘é€thinking_updateäº‹ä»¶**: å¦‚æœå­˜åœ¨reasoning_contentï¼Œé€šè¿‡SSEå‘é€`thinking_update`äº‹ä»¶ç»™å‰ç«¯
3. **æ—¥å¿—è®°å½•**: æ·»åŠ è¯¦ç»†æ—¥å¿—ï¼Œæ–¹ä¾¿è°ƒè¯•å’Œè¿½è¸ª
4. **äº‹ä»¶ååŒ¹é…**: ä½¿ç”¨`thinking_update`äº‹ä»¶åï¼Œä¸å‰ç«¯ç›‘å¬çš„äº‹ä»¶åä¸€è‡´

### ä¿®å¤è¦†ç›–èŒƒå›´

- âœ… **éæµå¼é™çº§è·¯å¾„** (ç¬¬6200-6209è¡Œ) - å·²ä¿®å¤
- âœ… **Autoæ¨¡å¼æœ€ç»ˆå“åº”è·¯å¾„** (ç¬¬6937-6956è¡Œ) - å·²ä¿®å¤
- âš ï¸ **æµå¼å·¥å…·è°ƒç”¨è·¯å¾„** - å¾…éªŒè¯ï¼ˆéœ€è¦æµ‹è¯•å·¥å…·è°ƒç”¨è¿‡ç¨‹ä¸­çš„reasoning_contentï¼‰

### éªŒè¯æµ‹è¯•

**æµ‹è¯•æ­¥éª¤**:
1. é‡å¯åç«¯æœåŠ¡ âœ…
2. ä½¿ç”¨MCPæµè§ˆå™¨æµ‹è¯•
3. å‘é€æ¶ˆæ¯"åœ¨å›­äººæ•°"
4. è§‚å¯ŸAI thinkåŒºåŸŸæ˜¯å¦æ˜¾ç¤ºçœŸå®çš„reasoning_content
5. æ£€æŸ¥åç«¯æ—¥å¿—æ˜¯å¦æœ‰`âœ… [SSE-AFC] æ£€æµ‹åˆ°reasoning_contentï¼Œå‘é€thinking_updateäº‹ä»¶`

**é¢„æœŸç»“æœ**:
- åç«¯æ—¥å¿—æ˜¾ç¤º: `âœ… [SSE-AFC] æ£€æµ‹åˆ°reasoning_contentï¼Œå‘é€thinking_updateäº‹ä»¶`
- å‰ç«¯æ—¥å¿—æ˜¾ç¤º: `ğŸ“¥ [å‰ç«¯æ¥æ”¶] SSEäº‹ä»¶: thinking_update`
- AI thinkåŒºåŸŸæ˜¾ç¤ºçœŸå®çš„AIæ¨ç†å†…å®¹ï¼Œè€Œä¸æ˜¯å·¥å…·è°ƒç”¨æè¿°

---

## ğŸ¯ é¢„æœŸä¿®å¤æ•ˆæœ

### ä¿®å¤å‰ âŒ

**AI thinkåŒºåŸŸæ˜¾ç¤º**:
```
ï¿½ æ­£åœ¨æ‰§è¡Œæ™ºèƒ½æŸ¥è¯¢: "åœ¨å›­äººæ•°"
ï¿½ æ­£åœ¨æ‰§è¡Œæ™ºèƒ½æŸ¥è¯¢: "ç»Ÿè®¡åœ¨å›­äººæ•°"
```

### ä¿®å¤å âœ…

**AI thinkåŒºåŸŸæ˜¾ç¤º**:
```
ç”¨æˆ·éœ€æ±‚æ˜¯è·å–åœ¨å›­äººæ•°ï¼Œä¹‹å‰å°è¯•ç”¨read_data_recordï¼ˆæœªæ‰¾åˆ°å®ç°ï¼‰ã€any_queryï¼ˆæŸ¥è¯¢å¤±è´¥ï¼‰ã€consult_recruitment_plannerï¼ˆæœªæ‰¾åˆ°å®ç°ï¼‰å‡æœªæˆåŠŸã€‚ç°æœ‰å·¥å…·ä¸­ï¼Œget_activity_statisticsæ˜¯æ´»åŠ¨ç»Ÿè®¡åˆ†æå·¥å…·ï¼Œä¸é€‚ç”¨ï¼›generate_excel_reportç­‰æ˜¯ç”ŸæˆæŠ¥è¡¨å·¥å…·ï¼Œéœ€è¦å…ˆæœ‰æ•°æ®ï¼›render_componentæ˜¯å±•ç¤ºç»„ä»¶ï¼Œæ²¡æœ‰æ•°æ®å¯å±•ç¤ºã€‚

æˆ‘éœ€è¦æ‰¾åˆ°ä¸€ä¸ªèƒ½å¤Ÿç›´æ¥è·å–åœ¨å›­äººæ•°çš„æ–¹æ³•ã€‚è®©æˆ‘å°è¯•ä½¿ç”¨any_queryå·¥å…·ï¼Œæ˜ç¡®æŒ‡å®šæŸ¥è¯¢ç±»å‹ä¸ºç»Ÿè®¡åˆ†æï¼ŒæœŸæœ›è¿”å›æ‘˜è¦æ ¼å¼çš„ç»“æœã€‚
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

1. **reasoning_contentä¿®å¤å®ŒæˆæŠ¥å‘Š.md** - éæµå¼è·¯å¾„ä¿®å¤è¯´æ˜
2. **Flashé…ç½®æµ‹è¯•ç»“æœæŠ¥å‘Š.md** - Flashæ¨¡å‹æµ‹è¯•æ•°æ®
3. **reasoning_contentæ•°æ®æµè¿½è¸ªæŠ¥å‘Š.md** - æ•°æ®æµåˆ†æ
4. **reasoning_contenté—®é¢˜åˆ†ææŠ¥å‘Š.md** - é—®é¢˜å®šä½è¿‡ç¨‹

---

**æŠ¥å‘Šç”Ÿæˆæ—¶é—´**: å½“å‰ä¼šè¯  
**æŠ¥å‘ŠçŠ¶æ€**: é—®é¢˜å·²å®šä½ï¼Œå¾…ä¿®å¤æµå¼å·¥å…·è°ƒç”¨è·¯å¾„

