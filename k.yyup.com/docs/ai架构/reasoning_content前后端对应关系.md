# AIåŠ©æ‰‹ThinkingåŠŸèƒ½å‰åç«¯å¯¹åº”å…³ç³»è¯¦è§£

## ğŸ“‹ æ¦‚è¿°

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜AIåŠ©æ‰‹thinkingåŠŸèƒ½çš„å‰åç«¯å®ç°ï¼ŒåŒ…æ‹¬æ•°æ®æµã€äº‹ä»¶ä¼ é€’ã€ä»£ç å¯¹åº”å…³ç³»ç­‰ã€‚

---

## ğŸ”„ å®Œæ•´æ•°æ®æµç¨‹å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ç”¨æˆ·å‘é€æ¶ˆæ¯                              â”‚
â”‚                    "æŸ¥è¯¢æ‰€æœ‰ç­çº§ä¿¡æ¯"                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å‰ç«¯ (AIAssistantRefactored.vue)                               â”‚
â”‚  - ç”¨æˆ·ç‚¹å‡»å‘é€æŒ‰é’®                                              â”‚
â”‚  - è°ƒç”¨ sendMessage() æ–¹æ³•                                       â”‚
â”‚  - é€šè¿‡ HTTP POST å‘é€åˆ°åç«¯                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åç«¯è·¯ç”± (unified-stream.routes.ts)                            â”‚
â”‚  - æ¥æ”¶ POST /api/ai/unified/stream-chat                        â”‚
â”‚  - è°ƒç”¨ unifiedIntelligenceService.processUserRequestStream()   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åç«¯æœåŠ¡ (unified-intelligence.service.ts)                     â”‚
â”‚  - processUserRequestStream() æ–¹æ³•                              â”‚
â”‚  - è°ƒç”¨ callDoubaoAfcLoopSSE() æ–¹æ³•                             â”‚
â”‚  - è®¾ç½® think: true å‚æ•° (ç¬¬1156è¡Œ)                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AIæ¨¡å‹ (è±†åŒ… Doubao)                                            â”‚
â”‚  - æ¥æ”¶è¯·æ±‚ï¼ŒåŒ…å« think: true å‚æ•°                               â”‚
â”‚  - è¿”å›å“åº”ï¼ŒåŒ…å« reasoning_content å­—æ®µ                         â”‚
â”‚  - reasoning_content: "æˆ‘ç°åœ¨éœ€è¦å¤„ç†ç”¨æˆ·çš„è¯·æ±‚..."             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åç«¯å¤„ç† (unified-intelligence.service.ts)                     â”‚
â”‚  - callDoubaoAfcLoopSSE() æ–¹æ³•                                  â”‚
â”‚  - ç¬¬7006è¡Œ: æå– reasoning_content                             â”‚
â”‚    const reasoningContent = message?.reasoning_content || ''    â”‚
â”‚  - ç¬¬7015-7023è¡Œ: å‘é€ thinking_update äº‹ä»¶                     â”‚
â”‚    sendSSE('thinking_update', { content: reasoningContent })    â”‚
â”‚  - ç¬¬7123-7126è¡Œ: å‘é€ thinking äº‹ä»¶                            â”‚
â”‚    const thinkingToSend = reasoningContent || toolDescription   â”‚
â”‚    sendSSE('thinking', thinkingToSend)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SSE äº‹ä»¶æµ (Server-Sent Events)                                â”‚
â”‚  - äº‹ä»¶1: thinking_update                                        â”‚
â”‚    data: { content: "æˆ‘ç°åœ¨éœ€è¦å¤„ç†...", timestamp: ... }       â”‚
â”‚  - äº‹ä»¶2: thinking                                               â”‚
â”‚    data: "æˆ‘ç°åœ¨éœ€è¦å¤„ç†ç”¨æˆ·çš„è¯·æ±‚..."                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å‰ç«¯æ¥æ”¶ (function-tools.ts)                                   â”‚
â”‚  - ç¬¬74-98è¡Œ: å¤„ç† SSE äº‹ä»¶                                      â”‚
â”‚  - ç¬¬92-98è¡Œ: thinking_update äº‹ä»¶å¤„ç†                          â”‚
â”‚    console.log('ğŸ¤” [å‰ç«¯æ¥æ”¶] thinking_updateäº‹ä»¶')             â”‚
â”‚    onProgress({ type: 'thinking_update', data: eventData })     â”‚
â”‚  - ç¬¬84-90è¡Œ: thinking äº‹ä»¶å¤„ç†                                  â”‚
â”‚    console.log('ğŸ¤” [å‰ç«¯æ¥æ”¶] thinkingäº‹ä»¶')                    â”‚
â”‚    onProgress({ type: 'thinking', data: thinkingMessage })      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å‰ç«¯å¤„ç† (AIAssistantRefactored.vue)                           â”‚
â”‚  - handleToolCallProgress() æ–¹æ³•                                â”‚
â”‚  - ç¬¬1095-1100è¡Œ: thinking_update å¤„ç†                          â”‚
â”‚    case 'thinking_update':                                      â”‚
â”‚      console.log('ğŸ’­ [AIæ€è€ƒ] reasoning_content:', ...)         â”‚
â”‚      æ›´æ–°å³ä¾§ä¾§è¾¹æ  AI think åŒºåŸŸ                                â”‚
â”‚  - ç¬¬1102-1107è¡Œ: thinking å¤„ç†                                  â”‚
â”‚    case 'thinking':                                             â”‚
â”‚      console.log('ğŸ¤” [æ€è€ƒ] æ›´æ–°å³ä¾§ä¾§è¾¹æ AI thinkåŒºåŸŸ:', ...)  â”‚
â”‚      æ˜¾ç¤º AI çš„å®é™…æ€è€ƒå†…å®¹                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  UI æ˜¾ç¤º                                                         â”‚
â”‚  - å³ä¾§ä¾§è¾¹æ  AI think åŒºåŸŸæ˜¾ç¤ºå®Œæ•´æ€è€ƒå†…å®¹                      â”‚
â”‚  - å·¥å…·è°ƒç”¨å†å²è®°å½•                                              â”‚
â”‚  - æ‰§è¡Œæ­¥éª¤é¢æ¿                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š å…³é”®ä»£ç å¯¹åº”è¡¨

### 1. åç«¯å‘é€ â†’ å‰ç«¯æ¥æ”¶

| åç«¯ä»£ç ä½ç½® | åç«¯å‘é€å†…å®¹ | å‰ç«¯æ¥æ”¶ä½ç½® | å‰ç«¯å¤„ç†æ–¹æ³• |
|-------------|-------------|-------------|-------------|
| `unified-intelligence.service.ts:7015-7023` | `thinking_update` äº‹ä»¶ | `function-tools.ts:92-98` | `onProgress({ type: 'thinking_update' })` |
| `unified-intelligence.service.ts:7123-7126` | `thinking` äº‹ä»¶ | `function-tools.ts:84-90` | `onProgress({ type: 'thinking' })` |
| `unified-intelligence.service.ts:7117-7121` | `tool_intent` äº‹ä»¶ | `function-tools.ts:è¡Œå·` | `onProgress({ type: 'tool_intent' })` |
| `unified-intelligence.service.ts:7128-7133` | `tool_call_start` äº‹ä»¶ | `function-tools.ts:è¡Œå·` | `onProgress({ type: 'tool_call_start' })` |

### 2. æ•°æ®å­—æ®µå¯¹åº”

| åç«¯å­—æ®µ | åç«¯ç±»å‹ | å‰ç«¯æ¥æ”¶å­—æ®µ | å‰ç«¯ç±»å‹ | è¯´æ˜ |
|---------|---------|-------------|---------|------|
| `message.reasoning_content` | `string` | `event.data.content` | `string` | AIçš„æ€è€ƒå†…å®¹ |
| `reasoningContent` | `string` | `event.data` | `string` | å®Œæ•´æ€è€ƒå†…å®¹ |
| `toolDescription` | `string` | `event.data` | `string` | Fallbackå·¥å…·æè¿° |
| `toolIntent` | `string` | `event.data.message` | `string` | å·¥å…·æ„å›¾æè¿° |

### 3. äº‹ä»¶ç±»å‹å¯¹åº”

| äº‹ä»¶ç±»å‹ | åç«¯å‘é€æ—¶æœº | å‰ç«¯å¤„ç†æ–¹æ³• | UIæ›´æ–°ä½ç½® |
|---------|-------------|-------------|-----------|
| `thinking_update` | AIè¿”å›reasoning_contentæ—¶ | `handleToolCallProgress` | å³ä¾§ä¾§è¾¹æ  AI think åŒºåŸŸ |
| `thinking` | å·¥å…·è°ƒç”¨å‰ | `handleToolCallProgress` | å³ä¾§ä¾§è¾¹æ  AI think åŒºåŸŸ |
| `tool_intent` | å·¥å…·è°ƒç”¨å‰ | `handleToolCallProgress` | å·¥å…·è°ƒç”¨å†å² |
| `tool_call_start` | å·¥å…·å¼€å§‹æ‰§è¡Œ | `handleToolCallProgress` | æ‰§è¡Œæ­¥éª¤é¢æ¿ |
| `tool_call_complete` | å·¥å…·æ‰§è¡Œå®Œæˆ | `handleToolCallProgress` | æ‰§è¡Œæ­¥éª¤é¢æ¿ |

---

## ğŸ” è¯¦ç»†ä»£ç å¯¹åº”

### åç«¯æ ¸å¿ƒä»£ç 

#### 1. å¯ç”¨æ€è€ƒæ¨¡å¼ (unified-intelligence.service.ts:1156)

```typescript
const apiRequest = {
  model: modelConfig.name,
  messages: aiBridgeMessages,
  tools: finalTools,
  tool_choice: toolChoice,
  temperature: modelConfig.modelParameters?.temperature || 0.7,
  max_tokens: modelConfig.modelParameters?.maxTokens || 2000,
  stream: useStream,
  think: true  // ğŸ§  å¯ç”¨æ€è€ƒæ¨¡å¼ï¼Œè®©AIåœ¨è°ƒç”¨å·¥å…·æ—¶ä¹Ÿè¿”å›reasoning_content
};
```

**ä½œç”¨**: å‘Šè¯‰AIæ¨¡å‹è¿”å›reasoning_contentå­—æ®µ

#### 2. æå–reasoning_content (unified-intelligence.service.ts:7006)

```typescript
const reasoningContent = message?.reasoning_content || ''; // ğŸ” æå–reasoning_content
```

**ä½œç”¨**: ä»AIå“åº”ä¸­æå–æ€è€ƒå†…å®¹

#### 3. å‘é€thinking_updateäº‹ä»¶ (unified-intelligence.service.ts:7015-7023)

```typescript
// ğŸ” å¦‚æœæœ‰reasoning_contentï¼Œå…ˆå‘é€thinking_updateäº‹ä»¶
if (reasoningContent) {
  console.log(`âœ… [SSE-AFC-${remoteCalls + 1}] æ£€æµ‹åˆ°reasoning_contentï¼Œå‘é€thinking_updateäº‹ä»¶`);
  console.log(`ğŸ” [SSE-AFC-${remoteCalls + 1}] reasoning_contentå†…å®¹:`, reasoningContent.substring(0, 100) + '...');
  sendSSE('thinking_update', {
    content: reasoningContent,
    message: 'ğŸ¤” AIæ­£åœ¨æ€è€ƒ...',
    timestamp: new Date().toISOString()
  });
}
```

**ä½œç”¨**: å®æ—¶å‘é€AIçš„æ€è€ƒå†…å®¹ï¼ˆæµå¼æ›´æ–°ï¼‰

#### 4. å‘é€thinkingäº‹ä»¶ (unified-intelligence.service.ts:7123-7126)

```typescript
// ğŸ¯ ç¬¬2æ­¥ï¼šå‘é€thinkingäº‹ä»¶ - ä½¿ç”¨AIçš„reasoning_contentè€Œä¸æ˜¯ç”Ÿæˆçš„å·¥å…·æè¿°
const thinkingToSend = reasoningContent || toolDescription;
console.log(`ğŸ¤” [AFC-å·¥å…·-${remoteCalls}] å‘é€thinking (æ¥è‡ªAI):`, thinkingToSend.substring(0, 200));
sendSSE('thinking', thinkingToSend);
```

**ä½œç”¨**: å‘é€å®Œæ•´çš„æ€è€ƒå†…å®¹ï¼ˆæ‰¹é‡æ›´æ–°ï¼‰

### å‰ç«¯æ ¸å¿ƒä»£ç 

#### 1. æ¥æ”¶SSEäº‹ä»¶ (function-tools.ts:74-98)

```typescript
// è§£æäº‹ä»¶ç±»å‹å’Œæ•°æ®
const eventType = line.substring(6).trim();
const dataLine = lines[i + 1];
if (dataLine && dataLine.startsWith('data: ')) {
  const eventData = JSON.parse(dataLine.substring(6));
  
  // thinking_updateäº‹ä»¶å¤„ç†
  if (eventType === 'thinking_update') {
    console.log('ğŸ¤” [å‰ç«¯æ¥æ”¶] thinking_updateäº‹ä»¶');
    console.log('ğŸ“ [å‰ç«¯æ¥æ”¶] eventData:', eventData);
    console.log('ğŸ’­ [AIæ€è€ƒ] reasoning_content:', eventData.content);
    console.log('ğŸ’¬ [å­—å¹•] æ›´æ–°AIæ€è€ƒå­—å¹•:', eventData.content);
    onProgress({
      type: 'thinking_update',
      data: eventData,
      message: 'ğŸ¤” æ€è€ƒä¸­...',
      round: currentRound
    });
  }
  
  // thinkingäº‹ä»¶å¤„ç†
  if (eventType === 'thinking') {
    console.log('ğŸ¤” [å‰ç«¯æ¥æ”¶] thinkingäº‹ä»¶');
    console.log('ğŸ“ [å‰ç«¯æ¥æ”¶] eventData:', eventData);
    const thinkingMessage = typeof eventData === 'string' ? eventData : eventData.message || eventData.content || '';
    console.log('ğŸ“ [å‰ç«¯æ¥æ”¶] thinkingMessage:', thinkingMessage);
    onProgress({
      type: 'thinking',
      data: thinkingMessage,
      message: thinkingMessage,
      round: currentRound
    });
  }
}
```

**ä½œç”¨**: æ¥æ”¶å¹¶è§£æSSEäº‹ä»¶æµ

#### 2. å¤„ç†thinkingäº‹ä»¶ (AIAssistantRefactored.vue:1095-1107)

```typescript
case 'thinking_update':
  console.log('ğŸ’­ [AIæ€è€ƒ] reasoning_content:', event.data?.content);
  console.log('ğŸ’¬ [å­—å¹•] æ›´æ–°AIæ€è€ƒå­—å¹•:', event.data?.content);
  // æ›´æ–°å³ä¾§ä¾§è¾¹æ AI thinkåŒºåŸŸ
  break;

case 'thinking':
  console.log('ğŸ¤” [æ€è€ƒ] æ›´æ–°å³ä¾§ä¾§è¾¹æ AI thinkåŒºåŸŸ:', event.data);
  console.log('ğŸ¤” [æ€è€ƒ] AI thinkæ˜¾ç¤º (6è¡Œ):', event.data);
  // æ˜¾ç¤ºAIçš„å®é™…æ€è€ƒå†…å®¹
  break;
```

**ä½œç”¨**: æ›´æ–°UIæ˜¾ç¤ºAIçš„æ€è€ƒå†…å®¹

---

## ğŸ¯ å…³é”®ä¿®å¤ç‚¹æ€»ç»“

### ä¿®å¤å‰çš„é—®é¢˜

1. **åç«¯**: ä½¿ç”¨ `toolDescription` è€Œä¸æ˜¯ `reasoning_content`
2. **å‰ç«¯**: æ¥æ”¶åˆ°çš„thinkingå†…å®¹ä¸tool_intentç›¸åŒ
3. **ç”¨æˆ·ä½“éªŒ**: çœ‹ä¸åˆ°AIçš„å®é™…æ€è€ƒè¿‡ç¨‹

### ä¿®å¤åçš„æ”¹è¿›

1. **åç«¯**: 
   - âœ… æ·»åŠ  `think: true` å‚æ•°
   - âœ… æå– `reasoning_content` å­—æ®µ
   - âœ… ä½¿ç”¨ `reasoning_content` å‘é€thinkingäº‹ä»¶
   - âœ… æä¾›fallbackæœºåˆ¶

2. **å‰ç«¯**:
   - âœ… æ­£ç¡®æ¥æ”¶thinking_updateäº‹ä»¶
   - âœ… æ­£ç¡®æ¥æ”¶thinkingäº‹ä»¶
   - âœ… æ›´æ–°å³ä¾§ä¾§è¾¹æ AI thinkåŒºåŸŸ
   - âœ… æ˜¾ç¤ºå®Œæ•´çš„AIæ€è€ƒå†…å®¹

3. **ç”¨æˆ·ä½“éªŒ**:
   - âœ… å¯ä»¥çœ‹åˆ°AIçš„å®é™…æ€è€ƒè¿‡ç¨‹
   - âœ… ç†è§£AIä¸ºä»€ä¹ˆé€‰æ‹©è¿™ä¸ªå·¥å…·
   - âœ… äº†è§£AIçš„å‚æ•°è®¾ç½®ç†ç”±

---

## ğŸ“ éªŒè¯æ–¹æ³•

### åç«¯éªŒè¯

æŸ¥çœ‹åç«¯æ—¥å¿—ï¼Œåº”è¯¥çœ‹åˆ°ï¼š

```
âœ… [SSE-AFC-1] æ£€æµ‹åˆ°reasoning_contentï¼Œå‘é€thinking_updateäº‹ä»¶
ğŸ” [SSE-AFC-1] reasoning_contentå†…å®¹: æˆ‘ç°åœ¨éœ€è¦å¤„ç†ç”¨æˆ·çš„è¯·æ±‚ï¼š"æŸ¥è¯¢æ‰€æœ‰ç­çº§ä¿¡æ¯"...
ğŸ“¡ [SSEæ¨é€] äº‹ä»¶: thinking_update {"content":"æˆ‘ç°åœ¨éœ€è¦å¤„ç†ç”¨æˆ·çš„è¯·æ±‚..."}
ğŸ¤” [AFC-å·¥å…·-0] å‘é€thinking (æ¥è‡ªAI): æˆ‘ç°åœ¨éœ€è¦å¤„ç†ç”¨æˆ·çš„è¯·æ±‚ï¼š"æŸ¥è¯¢æ‰€æœ‰ç­çº§ä¿¡æ¯"...
ğŸ“¡ [SSEæ¨é€] äº‹ä»¶: thinking æˆ‘ç°åœ¨éœ€è¦å¤„ç†ç”¨æˆ·çš„è¯·æ±‚ï¼š"æŸ¥è¯¢æ‰€æœ‰ç­çº§ä¿¡æ¯"...
```

### å‰ç«¯éªŒè¯

æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°ï¼Œåº”è¯¥çœ‹åˆ°ï¼š

```
ğŸ¤” [å‰ç«¯æ¥æ”¶] thinking_updateäº‹ä»¶
ğŸ’­ [AIæ€è€ƒ] reasoning_content: æˆ‘ç°åœ¨éœ€è¦å¤„ç†ç”¨æˆ·çš„è¯·æ±‚ï¼š"æŸ¥è¯¢æ‰€æœ‰ç­çº§ä¿¡æ¯"...
ğŸ’¬ [å­—å¹•] æ›´æ–°AIæ€è€ƒå­—å¹•: æˆ‘ç°åœ¨éœ€è¦å¤„ç†ç”¨æˆ·çš„è¯·æ±‚ï¼š"æŸ¥è¯¢æ‰€æœ‰ç­çº§ä¿¡æ¯"...
ğŸ¤” [å‰ç«¯æ¥æ”¶] thinkingäº‹ä»¶
ğŸ¤” [æ€è€ƒ] æ›´æ–°å³ä¾§ä¾§è¾¹æ AI thinkåŒºåŸŸ: æˆ‘ç°åœ¨éœ€è¦å¤„ç†ç”¨æˆ·çš„è¯·æ±‚ï¼š"æŸ¥è¯¢æ‰€æœ‰ç­çº§ä¿¡æ¯"...
```

### UIéªŒè¯

1. è®¿é—® http://localhost:5173/ai
2. å‘é€æ¶ˆæ¯: "æŸ¥è¯¢æ‰€æœ‰ç­çº§ä¿¡æ¯"
3. è§‚å¯Ÿå³ä¾§ä¾§è¾¹æ  AI think åŒºåŸŸ
4. åº”è¯¥æ˜¾ç¤ºå®Œæ•´çš„AIæ€è€ƒå†…å®¹

---

## ğŸ”§ æ•…éšœæ’æŸ¥

### é—®é¢˜1: å‰ç«¯æ²¡æœ‰æ˜¾ç¤ºthinkingå†…å®¹

**æ£€æŸ¥ç‚¹**:
1. åç«¯æ˜¯å¦æ·»åŠ äº† `think: true` å‚æ•°ï¼Ÿ
2. åç«¯æ˜¯å¦æ­£ç¡®æå–äº† `reasoning_content`ï¼Ÿ
3. åç«¯æ˜¯å¦å‘é€äº† `thinking` äº‹ä»¶ï¼Ÿ
4. å‰ç«¯æ˜¯å¦æ­£ç¡®æ¥æ”¶äº†äº‹ä»¶ï¼Ÿ

**è§£å†³æ–¹æ³•**:
- æŸ¥çœ‹åç«¯æ—¥å¿—ï¼Œç¡®è®¤ `reasoning_content` è¢«æå–
- æŸ¥çœ‹å‰ç«¯æ§åˆ¶å°ï¼Œç¡®è®¤äº‹ä»¶è¢«æ¥æ”¶
- æ£€æŸ¥ç½‘ç»œé¢æ¿ï¼Œç¡®è®¤SSEè¿æ¥æ­£å¸¸

### é—®é¢˜2: thinkingå†…å®¹ä¸tool_intentç›¸åŒ

**åŸå› **: åç«¯ä½¿ç”¨äº† `toolDescription` è€Œä¸æ˜¯ `reasoning_content`

**è§£å†³æ–¹æ³•**:
- æ£€æŸ¥ `unified-intelligence.service.ts` ç¬¬7123-7126è¡Œ
- ç¡®è®¤ä½¿ç”¨äº† `const thinkingToSend = reasoningContent || toolDescription`

### é—®é¢˜3: AIæ²¡æœ‰è¿”å›reasoning_content

**åŸå› **: æ²¡æœ‰æ·»åŠ  `think: true` å‚æ•°

**è§£å†³æ–¹æ³•**:
- æ£€æŸ¥ `unified-intelligence.service.ts` ç¬¬1156è¡Œ
- ç¡®è®¤APIè¯·æ±‚ä¸­åŒ…å« `think: true`

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [reasoning_contentä¿®å¤å®ŒæˆæŠ¥å‘Š](./reasoning_contentä¿®å¤å®ŒæˆæŠ¥å‘Š.md)
- [reasoning_contentå®Œæ•´æµ‹è¯•æŠ¥å‘Š](./reasoning_contentå®Œæ•´æµ‹è¯•æŠ¥å‘Š.md)
- [reasoning_contentæ•°æ®æµè¿½è¸ªæŠ¥å‘Š](./reasoning_contentæ•°æ®æµè¿½è¸ªæŠ¥å‘Š.md)

---

**æœ€åæ›´æ–°**: 2025-10-13
**ç‰ˆæœ¬**: 1.0
**çŠ¶æ€**: âœ… å·²å®Œæˆå¹¶éªŒè¯

