# Redisç¼“å­˜ç³»ç»Ÿå®æ–½è®¡åˆ’ 001

> **é¡¹ç›®åç§°**: å¹¼å„¿å›­ç®¡ç†ç³»ç»ŸRedisç¼“å­˜é›†æˆ
> **é¡¹ç›®ç¼–å·**: REDIS-IMPL-001
> **åˆ›å»ºæ—¥æœŸ**: 2025-01-06
> **è®¡åˆ’å‘¨æœŸ**: 9å‘¨
> **é¡¹ç›®è´Ÿè´£äºº**: [å¾…æŒ‡å®š]
> **æ–‡æ¡£ç‰ˆæœ¬**: v1.1
> **æ›´æ–°è¯´æ˜**: æš‚æ—¶ç§»é™¤AIç¼“å­˜åŠŸèƒ½ï¼ˆAIåŠŸèƒ½è°ƒè¯•ä¸­ï¼‰

---

## ğŸ“‹ ç›®å½•

1. [é¡¹ç›®æ¦‚è¿°](#ä¸€é¡¹ç›®æ¦‚è¿°)
2. [é¡¹ç›®ç›®æ ‡](#äºŒé¡¹ç›®ç›®æ ‡)
3. [å®æ–½é˜¶æ®µ](#ä¸‰å®æ–½é˜¶æ®µ)
4. [è¯¦ç»†ä»»åŠ¡æ¸…å•](#å››è¯¦ç»†ä»»åŠ¡æ¸…å•)
5. [é£é™©ç®¡ç†](#äº”é£é™©ç®¡ç†)
6. [éªŒæ”¶æ ‡å‡†](#å…­éªŒæ”¶æ ‡å‡†)
7. [èµ„æºéœ€æ±‚](#ä¸ƒèµ„æºéœ€æ±‚)

---

## ä¸€ã€é¡¹ç›®æ¦‚è¿°

### 1.1 é¡¹ç›®èƒŒæ™¯

å½“å‰ç³»ç»Ÿå­˜åœ¨ä»¥ä¸‹æ€§èƒ½ç“¶é¢ˆï¼š
- âŒ æƒé™æŸ¥è¯¢æ¶‰åŠUser-Role-Permissionä¸‰è¡¨å…³è”ï¼Œå¹³å‡å“åº”æ—¶é—´200ms
- âŒ Dashboardç­‰ä¸­å¿ƒé¡µé¢å¤šè¡¨èšåˆæŸ¥è¯¢ï¼ŒåŠ è½½æ—¶é—´1-2ç§’
- âŒ é«˜å¹¶å‘æ—¶æ•°æ®åº“å‹åŠ›å¤§ï¼Œç³»ç»Ÿç¨³å®šæ€§å·®

### 1.2 è§£å†³æ–¹æ¡ˆ

å¼•å…¥Redisç¼“å­˜ç³»ç»Ÿï¼Œå®ç°ï¼š
- âœ… æƒé™è·¯ç”±ç¼“å­˜ - å“åº”æ—¶é—´é™ä½97.5%
- âœ… 15ä¸ªä¸­å¿ƒé¡µé¢æ•°æ®ç¼“å­˜ - åŠ è½½æ—¶é—´é™ä½85%
- âœ… ä¼šè¯ç®¡ç†å’Œé™æµ - æå‡å®‰å…¨æ€§å’Œç¨³å®šæ€§
- â¸ï¸ AIæŸ¥è¯¢ç»“æœç¼“å­˜ - æš‚ç¼“å®æ–½ï¼ˆAIåŠŸèƒ½è°ƒè¯•ä¸­ï¼‰

### 1.3 æŠ€æœ¯æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      åº”ç”¨å±‚ (Node.js)                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ Express  â”‚  â”‚ Express  â”‚        â”‚
â”‚  â”‚ Instance â”‚  â”‚ Instance â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚             â”‚
        â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
               â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Redis Sentinel     â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
    â”‚  â”‚ Sentinel Ã— 3   â”‚ â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Redis Cluster      â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
    â”‚  â”‚ Master         â”‚ â”‚
    â”‚  â”‚ Slave Ã— 2      â”‚ â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## äºŒã€é¡¹ç›®ç›®æ ‡

### 2.1 æ€§èƒ½ç›®æ ‡

| æŒ‡æ ‡ | å½“å‰å€¼ | ç›®æ ‡å€¼ | æå‡å¹…åº¦ |
|------|--------|--------|---------|
| æƒé™æŸ¥è¯¢å“åº”æ—¶é—´ | 200ms | 5ms | 97.5% |
| DashboardåŠ è½½æ—¶é—´ | 1.5s | 200ms | 86.7% |
| æ´»åŠ¨ä¸­å¿ƒåŠ è½½æ—¶é—´ | 1.2s | 150ms | 87.5% |
| ç³»ç»Ÿå¹¶å‘èƒ½åŠ› | 100 QPS | 1000+ QPS | 10å€ |
| æ•°æ®åº“æŸ¥è¯¢æ¬¡æ•° | åŸºå‡† | -80% | 80% |

### 2.2 ä¸šåŠ¡ç›®æ ‡

- âœ… ç”¨æˆ·ä½“éªŒæå‡ï¼šé¡µé¢åŠ è½½é€Ÿåº¦æå‡85%
- âœ… ç³»ç»Ÿç¨³å®šæ€§ï¼šæ•°æ®åº“è´Ÿè½½é™ä½80%ï¼Œæ•…éšœç‡é™ä½40%
- âœ… å¯æ‰©å±•æ€§ï¼šæ”¯æŒæœªæ¥3å¹´ä¸šåŠ¡å¢é•¿

### 2.3 æŠ€æœ¯ç›®æ ‡

- âœ… Redisé«˜å¯ç”¨é›†ç¾¤éƒ¨ç½²ï¼ˆSentinelæ¨¡å¼ï¼‰
- âœ… å®Œæ•´çš„ç¼“å­˜æœåŠ¡å°è£…ï¼ˆRedisServiceï¼‰
- âœ… æƒé™è·¯ç”±ç¼“å­˜ç³»ç»Ÿ
- âœ… 15ä¸ªä¸­å¿ƒé¡µé¢ç¼“å­˜ç³»ç»Ÿ
- âœ… ä¼šè¯ç®¡ç†ç³»ç»Ÿï¼ˆTokené»‘åå•ã€åœ¨çº¿ç”¨æˆ·ï¼‰
- âœ… é™æµé˜²åˆ·ç³»ç»Ÿ
- âœ… å®Œå–„çš„ç¼“å­˜å¤±æ•ˆæœºåˆ¶
- âœ… ç›‘æ§å‘Šè­¦ç³»ç»Ÿ
- âœ… æµ‹è¯•è¦†ç›–ç‡ > 80%

---

## ä¸‰ã€å®æ–½é˜¶æ®µ

### é˜¶æ®µåˆ’åˆ†

| é˜¶æ®µ | å‘¨æœŸ | ä¸»è¦ä»»åŠ¡ | é‡Œç¨‹ç¢‘ |
|------|------|---------|--------|
| **é˜¶æ®µ1: åŸºç¡€è®¾æ–½** | Week 1-2 | Redisç¯å¢ƒéƒ¨ç½²ã€å®¢æˆ·ç«¯é›†æˆ | Redisé›†ç¾¤å¯ç”¨ |
| **é˜¶æ®µ2: æ ¸å¿ƒåŠŸèƒ½** | Week 3-5 | æƒé™ç¼“å­˜ã€ä¼šè¯ç®¡ç†ã€ä¸­å¿ƒç¼“å­˜ | æ ¸å¿ƒç¼“å­˜ä¸Šçº¿ |
| **é˜¶æ®µ3: é«˜çº§åŠŸèƒ½** | Week 6-7 | é™æµé˜²åˆ·ã€å®æ—¶æ¨é€ | é«˜çº§åŠŸèƒ½ä¸Šçº¿ |
| **é˜¶æ®µ4: æµ‹è¯•ä¸Šçº¿** | Week 8-9 | å…¨é¢æµ‹è¯•ã€ç°åº¦ä¸Šçº¿ | ç”Ÿäº§ç¯å¢ƒä¸Šçº¿ |

### å…³é”®é‡Œç¨‹ç¢‘

```mermaid
gantt
    title Rediså®æ–½è®¡åˆ’ç”˜ç‰¹å›¾
    dateFormat  YYYY-MM-DD
    section é˜¶æ®µ1
    Redisç¯å¢ƒéƒ¨ç½²           :a1, 2025-01-06, 7d
    å®¢æˆ·ç«¯é›†æˆ              :a2, after a1, 7d
    section é˜¶æ®µ2
    æƒé™è·¯ç”±ç¼“å­˜            :b1, after a2, 7d
    ä¼šè¯ç®¡ç†                :b2, after b1, 7d
    ä¸­å¿ƒé¡µé¢ç¼“å­˜            :b3, after b2, 7d
    section é˜¶æ®µ3
    é™æµé˜²åˆ·                :c1, after b3, 7d
    å®æ—¶æ¨é€å’Œæ’è¡Œæ¦œ        :c2, after c1, 7d
    section é˜¶æ®µ4
    å…¨é¢æµ‹è¯•                :d1, after c2, 7d
    ç°åº¦ä¸Šçº¿                :d2, after d1, 7d
```

---

## å››ã€è¯¦ç»†ä»»åŠ¡æ¸…å•

### Week 1: Redisç¯å¢ƒéƒ¨ç½² (2025-01-06 ~ 2025-01-12)

#### ä»»åŠ¡1.1: æœåŠ¡å™¨å‡†å¤‡ â° 1å¤©

**è´Ÿè´£äºº**: è¿ç»´å·¥ç¨‹å¸ˆ  
**ä¼˜å…ˆçº§**: P0

**ä»»åŠ¡æ¸…å•**:
- [ ] ç”³è¯·3å°æœåŠ¡å™¨ï¼ˆMaster + Slave Ã— 2ï¼‰
  - é…ç½®: 4GBå†…å­˜, 2æ ¸CPU, 40GB SSD
  - æ“ä½œç³»ç»Ÿ: Ubuntu 22.04 LTS
- [ ] ç”³è¯·3å°è½»é‡æœåŠ¡å™¨ï¼ˆSentinel Ã— 3ï¼‰
  - é…ç½®: 512MBå†…å­˜, 1æ ¸CPU
- [ ] é…ç½®æœåŠ¡å™¨ç½‘ç»œå’Œå®‰å…¨ç»„
  - å¼€æ”¾ç«¯å£: 6379 (Redis), 26379 (Sentinel)
  - é…ç½®é˜²ç«å¢™è§„åˆ™
- [ ] é…ç½®SSHå¯†é’¥è®¤è¯

**éªŒæ”¶æ ‡å‡†**:
- âœ… æ‰€æœ‰æœåŠ¡å™¨å¯é€šè¿‡SSHè®¿é—®
- âœ… æœåŠ¡å™¨ä¹‹é—´ç½‘ç»œäº’é€š
- âœ… é˜²ç«å¢™è§„åˆ™é…ç½®æ­£ç¡®

#### ä»»åŠ¡1.2: Rediså®‰è£…é…ç½® â° 2å¤©

**è´Ÿè´£äºº**: åç«¯å·¥ç¨‹å¸ˆ  
**ä¼˜å…ˆçº§**: P0

**ä»»åŠ¡æ¸…å•**:
- [ ] å®‰è£…Redis 7.x
  ```bash
  # åœ¨æ‰€æœ‰RedisæœåŠ¡å™¨ä¸Šæ‰§è¡Œ
  sudo apt update
  sudo apt install redis-server
  redis-server --version  # éªŒè¯ç‰ˆæœ¬
  ```

- [ ] é…ç½®Redis Master
  ```bash
  # /etc/redis/redis.conf
  bind 0.0.0.0
  port 6379
  requirepass your_strong_password
  maxmemory 3gb
  maxmemory-policy allkeys-lru
  
  # æŒä¹…åŒ–é…ç½®
  save 900 1
  save 300 10
  save 60 10000
  appendonly yes
  appendfsync everysec
  ```

- [ ] é…ç½®Redis Slave
  ```bash
  # /etc/redis/redis.conf
  bind 0.0.0.0
  port 6379
  requirepass your_strong_password
  replicaof <master_ip> 6379
  masterauth your_strong_password
  ```

- [ ] å¯åŠ¨RedisæœåŠ¡
  ```bash
  sudo systemctl start redis-server
  sudo systemctl enable redis-server
  sudo systemctl status redis-server
  ```

- [ ] éªŒè¯ä¸»ä»å¤åˆ¶
  ```bash
  # åœ¨Masterä¸Š
  redis-cli -a your_strong_password
  INFO replication
  
  # åœ¨Slaveä¸Š
  redis-cli -a your_strong_password
  INFO replication
  ```

**éªŒæ”¶æ ‡å‡†**:
- âœ… RedisæœåŠ¡æ­£å¸¸è¿è¡Œ
- âœ… ä¸»ä»å¤åˆ¶æ­£å¸¸å·¥ä½œ
- âœ… æŒä¹…åŒ–é…ç½®ç”Ÿæ•ˆ

#### ä»»åŠ¡1.3: Sentinelé…ç½® â° 1å¤©

**è´Ÿè´£äºº**: åç«¯å·¥ç¨‹å¸ˆ  
**ä¼˜å…ˆçº§**: P0

**ä»»åŠ¡æ¸…å•**:
- [ ] é…ç½®Sentinel
  ```bash
  # /etc/redis/sentinel.conf
  port 26379
  sentinel monitor mymaster <master_ip> 6379 2
  sentinel auth-pass mymaster your_strong_password
  sentinel down-after-milliseconds mymaster 5000
  sentinel parallel-syncs mymaster 1
  sentinel failover-timeout mymaster 10000
  ```

- [ ] å¯åŠ¨SentinelæœåŠ¡
  ```bash
  sudo systemctl start redis-sentinel
  sudo systemctl enable redis-sentinel
  sudo systemctl status redis-sentinel
  ```

- [ ] éªŒè¯Sentinelç›‘æ§
  ```bash
  redis-cli -p 26379
  SENTINEL masters
  SENTINEL slaves mymaster
  ```

**éªŒæ”¶æ ‡å‡†**:
- âœ… 3ä¸ªSentinelæ­£å¸¸è¿è¡Œ
- âœ… Sentinelæ­£ç¡®ç›‘æ§Master
- âœ… æ•…éšœè½¬ç§»æµ‹è¯•é€šè¿‡

#### ä»»åŠ¡1.4: ç›‘æ§å‘Šè­¦é…ç½® â° 1å¤©

**è´Ÿè´£äºº**: è¿ç»´å·¥ç¨‹å¸ˆ  
**ä¼˜å…ˆçº§**: P1

**ä»»åŠ¡æ¸…å•**:
- [ ] å®‰è£…Redis Exporter
  ```bash
  wget https://github.com/oliver006/redis_exporter/releases/download/v1.55.0/redis_exporter-v1.55.0.linux-amd64.tar.gz
  tar xvfz redis_exporter-v1.55.0.linux-amd64.tar.gz
  sudo mv redis_exporter /usr/local/bin/
  ```

- [ ] é…ç½®Prometheusç›‘æ§
  ```yaml
  # prometheus.yml
  scrape_configs:
    - job_name: 'redis'
      static_configs:
        - targets: ['<redis_ip>:9121']
  ```

- [ ] é…ç½®Grafanaä»ªè¡¨æ¿
  - å¯¼å…¥Redis Dashboard (ID: 11835)
  - é…ç½®æ•°æ®æº

- [ ] é…ç½®å‘Šè­¦è§„åˆ™
  ```yaml
  # alerts.yml
  groups:
    - name: redis_alerts
      rules:
        - alert: RedisDown
          expr: redis_up == 0
          for: 1m
          labels:
            severity: critical
          annotations:
            summary: "Rediså®ä¾‹å®•æœº"
  ```

**éªŒæ”¶æ ‡å‡†**:
- âœ… Prometheusæ­£å¸¸é‡‡é›†RedisæŒ‡æ ‡
- âœ… Grafanaä»ªè¡¨æ¿æ˜¾ç¤ºæ­£å¸¸
- âœ… å‘Šè­¦è§„åˆ™æµ‹è¯•é€šè¿‡

#### ä»»åŠ¡1.5: å¤‡ä»½æ¢å¤æµ‹è¯• â° 1å¤©

**è´Ÿè´£äºº**: è¿ç»´å·¥ç¨‹å¸ˆ  
**ä¼˜å…ˆçº§**: P1

**ä»»åŠ¡æ¸…å•**:
- [ ] é…ç½®è‡ªåŠ¨å¤‡ä»½è„šæœ¬
  ```bash
  #!/bin/bash
  # /usr/local/bin/redis-backup.sh
  DATE=$(date +%Y%m%d_%H%M%S)
  BACKUP_DIR="/backup/redis"
  
  # å¤‡ä»½RDBæ–‡ä»¶
  cp /var/lib/redis/dump.rdb $BACKUP_DIR/dump_$DATE.rdb
  
  # å¤‡ä»½AOFæ–‡ä»¶
  cp /var/lib/redis/appendonly.aof $BACKUP_DIR/appendonly_$DATE.aof
  
  # ä¸Šä¼ åˆ°å¯¹è±¡å­˜å‚¨
  aws s3 cp $BACKUP_DIR/dump_$DATE.rdb s3://your-bucket/redis-backup/
  
  # æ¸…ç†7å¤©å‰çš„å¤‡ä»½
  find $BACKUP_DIR -name "*.rdb" -mtime +7 -delete
  ```

- [ ] é…ç½®å®šæ—¶ä»»åŠ¡
  ```bash
  # crontab -e
  0 2 * * * /usr/local/bin/redis-backup.sh
  ```

- [ ] æ‰§è¡Œæ¢å¤æµ‹è¯•
  ```bash
  # åœæ­¢Redis
  sudo systemctl stop redis-server
  
  # æ¢å¤å¤‡ä»½
  sudo cp /backup/redis/dump_latest.rdb /var/lib/redis/dump.rdb
  
  # å¯åŠ¨Redis
  sudo systemctl start redis-server
  
  # éªŒè¯æ•°æ®
  redis-cli -a your_strong_password
  KEYS *
  ```

**éªŒæ”¶æ ‡å‡†**:
- âœ… è‡ªåŠ¨å¤‡ä»½è„šæœ¬æ­£å¸¸è¿è¡Œ
- âœ… å¤‡ä»½æ–‡ä»¶ä¸Šä¼ åˆ°å¯¹è±¡å­˜å‚¨
- âœ… æ¢å¤æµ‹è¯•æˆåŠŸ

**Week 1 äº¤ä»˜ç‰©**:
- âœ… Redisé«˜å¯ç”¨é›†ç¾¤ï¼ˆ1 Master + 2 Slave + 3 Sentinelï¼‰
- âœ… ç›‘æ§å‘Šè­¦ç³»ç»Ÿ
- âœ… å¤‡ä»½æ¢å¤æ–¹æ¡ˆ
- âœ… éƒ¨ç½²æ–‡æ¡£

---

### Week 2: å®¢æˆ·ç«¯é›†æˆ (2025-01-13 ~ 2025-01-19)

#### ä»»åŠ¡2.1: å®‰è£…ä¾èµ– â° 0.5å¤©

**è´Ÿè´£äºº**: åç«¯å·¥ç¨‹å¸ˆ  
**ä¼˜å…ˆçº§**: P0

**ä»»åŠ¡æ¸…å•**:
- [ ] å®‰è£…ioredis
  ```bash
  cd server
  npm install ioredis
  npm install @types/ioredis --save-dev
  ```

- [ ] æ›´æ–°package.json
  ```json
  {
    "dependencies": {
      "ioredis": "^5.3.2"
    },
    "devDependencies": {
      "@types/ioredis": "^5.0.0"
    }
  }
  ```

**éªŒæ”¶æ ‡å‡†**:
- âœ… ä¾èµ–å®‰è£…æˆåŠŸ
- âœ… TypeScriptç±»å‹å®šä¹‰æ­£å¸¸

#### ä»»åŠ¡2.2: Redisé…ç½®æ–‡ä»¶ â° 0.5å¤©

**è´Ÿè´£äºº**: åç«¯å·¥ç¨‹å¸ˆ  
**ä¼˜å…ˆçº§**: P0

**ä»»åŠ¡æ¸…å•**:
- [ ] åˆ›å»ºé…ç½®æ–‡ä»¶ `server/src/config/redis.config.ts`
- [ ] é…ç½®ç¯å¢ƒå˜é‡ `server/.env`
  ```env
  REDIS_SENTINEL_1=sentinel1.example.com:26379
  REDIS_SENTINEL_2=sentinel2.example.com:26379
  REDIS_SENTINEL_3=sentinel3.example.com:26379
  REDIS_MASTER_NAME=mymaster
  REDIS_PASSWORD=your_strong_password
  ```

**éªŒæ”¶æ ‡å‡†**:
- âœ… é…ç½®æ–‡ä»¶åˆ›å»ºå®Œæˆ
- âœ… ç¯å¢ƒå˜é‡é…ç½®æ­£ç¡®

#### ä»»åŠ¡2.3: RedisServiceå®ç° â° 2å¤©

**è´Ÿè´£äºº**: åç«¯å·¥ç¨‹å¸ˆ  
**ä¼˜å…ˆçº§**: P0

**ä»»åŠ¡æ¸…å•**:
- [ ] åˆ›å»º `server/src/services/redis.service.ts`
- [ ] å®ç°åŸºç¡€æ–¹æ³•ï¼šget, set, del, exists, expire
- [ ] å®ç°Hashæ–¹æ³•ï¼šhset, hget, hgetall, hdel
- [ ] å®ç°Setæ–¹æ³•ï¼šsadd, smembers, sismember, srem
- [ ] å®ç°åˆ†å¸ƒå¼é”ï¼šacquireLock, releaseLock
- [ ] å®ç°è®¡æ•°å™¨ï¼šincr, decr
- [ ] æ·»åŠ é”™è¯¯å¤„ç†å’Œæ—¥å¿—

**éªŒæ”¶æ ‡å‡†**:
- âœ… æ‰€æœ‰æ–¹æ³•å®ç°å®Œæˆ
- âœ… é”™è¯¯å¤„ç†å®Œå–„
- âœ… æ—¥å¿—è®°å½•æ¸…æ™°

#### ä»»åŠ¡2.4: å•å…ƒæµ‹è¯• â° 1å¤©

**è´Ÿè´£äºº**: åç«¯å·¥ç¨‹å¸ˆ  
**ä¼˜å…ˆçº§**: P0

**ä»»åŠ¡æ¸…å•**:
- [ ] åˆ›å»ºæµ‹è¯•æ–‡ä»¶ `server/tests/unit/services/redis.service.test.ts`
- [ ] æµ‹è¯•åŸºç¡€æ–¹æ³•
- [ ] æµ‹è¯•Hashæ–¹æ³•
- [ ] æµ‹è¯•Setæ–¹æ³•
- [ ] æµ‹è¯•åˆ†å¸ƒå¼é”
- [ ] æµ‹è¯•é”™è¯¯åœºæ™¯

**éªŒæ”¶æ ‡å‡†**:
- âœ… æµ‹è¯•è¦†ç›–ç‡ > 80%
- âœ… æ‰€æœ‰æµ‹è¯•é€šè¿‡

#### ä»»åŠ¡2.5: é›†æˆæµ‹è¯• â° 1å¤©

**è´Ÿè´£äºº**: åç«¯å·¥ç¨‹å¸ˆ  
**ä¼˜å…ˆçº§**: P0

**ä»»åŠ¡æ¸…å•**:
- [ ] åˆ›å»ºé›†æˆæµ‹è¯• `server/tests/integration/redis.integration.test.ts`
- [ ] æµ‹è¯•Redisè¿æ¥
- [ ] æµ‹è¯•ä¸»ä»å¤åˆ¶
- [ ] æµ‹è¯•Sentinelæ•…éšœè½¬ç§»
- [ ] æµ‹è¯•å¹¶å‘åœºæ™¯
- [ ] æµ‹è¯•æ€§èƒ½åŸºå‡†

**éªŒæ”¶æ ‡å‡†**:
- âœ… é›†æˆæµ‹è¯•é€šè¿‡
- âœ… æ€§èƒ½åŸºå‡†è¾¾æ ‡

**Week 2 äº¤ä»˜ç‰©**:
- âœ… RedisServiceå®Œæ•´å®ç°
- âœ… å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•
- âœ… APIæ–‡æ¡£

---

### Week 3: æƒé™è·¯ç”±ç¼“å­˜ (2025-01-20 ~ 2025-01-26)

#### ä»»åŠ¡3.1: PermissionCacheServiceå®ç° â° 2å¤©

**è´Ÿè´£äºº**: åç«¯å·¥ç¨‹å¸ˆ  
**ä¼˜å…ˆçº§**: P0

**ä»»åŠ¡æ¸…å•**:
- [ ] åˆ›å»º `server/src/services/permission-cache.service.ts`
- [ ] å®ç°getUserPermissionsï¼ˆå¸¦ç¼“å­˜ï¼‰
- [ ] å®ç°getDynamicRoutesï¼ˆå¸¦ç¼“å­˜ï¼‰
- [ ] å®ç°checkPermissionï¼ˆå¸¦ç¼“å­˜ï¼‰
- [ ] å®ç°ç¼“å­˜å¤±æ•ˆæ–¹æ³•

**éªŒæ”¶æ ‡å‡†**:
- âœ… æ‰€æœ‰æ–¹æ³•å®ç°å®Œæˆ
- âœ… ç¼“å­˜å‘½ä¸­ç‡ > 90%

#### ä»»åŠ¡3.2: æ”¹é€ æƒé™Controller â° 1å¤©

**è´Ÿè´£äºº**: åç«¯å·¥ç¨‹å¸ˆ  
**ä¼˜å…ˆçº§**: P0

**ä»»åŠ¡æ¸…å•**:
- [ ] ä¿®æ”¹ `server/src/controllers/permissions.controller.ts`
- [ ] é›†æˆPermissionCacheService
- [ ] æ·»åŠ ç¼“å­˜å‘½ä¸­ç‡ç»Ÿè®¡
- [ ] æ·»åŠ æ€§èƒ½æ—¥å¿—

**éªŒæ”¶æ ‡å‡†**:
- âœ… æƒé™æŸ¥è¯¢ä½¿ç”¨ç¼“å­˜
- âœ… å“åº”æ—¶é—´ < 10ms

#### ä»»åŠ¡3.3: ç¼“å­˜å¤±æ•ˆé›†æˆ â° 1å¤©

**è´Ÿè´£äºº**: åç«¯å·¥ç¨‹å¸ˆ  
**ä¼˜å…ˆçº§**: P0

**ä»»åŠ¡æ¸…å•**:
- [ ] ä¿®æ”¹ç”¨æˆ·ç®¡ç†Controller
- [ ] ä¿®æ”¹è§’è‰²ç®¡ç†Controller
- [ ] ä¿®æ”¹æƒé™ç®¡ç†Controller
- [ ] æ·»åŠ ç¼“å­˜å¤±æ•ˆè°ƒç”¨

**éªŒæ”¶æ ‡å‡†**:
- âœ… æƒé™å˜æ›´æ—¶ç¼“å­˜è‡ªåŠ¨å¤±æ•ˆ
- âœ… ç¼“å­˜ä¸€è‡´æ€§ä¿è¯

#### ä»»åŠ¡3.4: æ€§èƒ½æµ‹è¯• â° 1å¤©

**è´Ÿè´£äºº**: æµ‹è¯•å·¥ç¨‹å¸ˆ  
**ä¼˜å…ˆçº§**: P0

**ä»»åŠ¡æ¸…å•**:
- [ ] ç¼–å†™æ€§èƒ½æµ‹è¯•è„šæœ¬
- [ ] æµ‹è¯•æƒé™æŸ¥è¯¢æ€§èƒ½
- [ ] æµ‹è¯•åŠ¨æ€è·¯ç”±ç”Ÿæˆæ€§èƒ½
- [ ] æµ‹è¯•å¹¶å‘åœºæ™¯
- [ ] ç”Ÿæˆæ€§èƒ½æŠ¥å‘Š

**éªŒæ”¶æ ‡å‡†**:
- âœ… å“åº”æ—¶é—´ < 10ms
- âœ… å¹¶å‘1000 QPSæ— å‹åŠ›
- âœ… ç¼“å­˜å‘½ä¸­ç‡ > 90%

**Week 3 äº¤ä»˜ç‰©**:
- âœ… æƒé™è·¯ç”±ç¼“å­˜ç³»ç»Ÿ
- âœ… æ€§èƒ½æµ‹è¯•æŠ¥å‘Š
- âœ… ä½¿ç”¨æ–‡æ¡£

---

### Week 4: ä¼šè¯ç®¡ç† (2025-01-27 ~ 2025-02-02)

#### ä»»åŠ¡4.1: SessionServiceå®ç° â° 2å¤©

**è´Ÿè´£äºº**: åç«¯å·¥ç¨‹å¸ˆ
**ä¼˜å…ˆçº§**: P0

**ä»»åŠ¡æ¸…å•**:
- [ ] åˆ›å»º `server/src/services/session.service.ts`
- [ ] å®ç°Tokené»‘åå•åŠŸèƒ½
  ```typescript
  // æ·»åŠ Tokenåˆ°é»‘åå•
  async addToBlacklist(token: string, expiresIn: number)

  // æ£€æŸ¥Tokenæ˜¯å¦åœ¨é»‘åå•
  async isBlacklisted(token: string): Promise<boolean>
  ```

- [ ] å®ç°åœ¨çº¿ç”¨æˆ·ç®¡ç†
  ```typescript
  // æ·»åŠ åœ¨çº¿ç”¨æˆ·
  async addOnlineUser(userId: number, sessionData: any)

  // ç§»é™¤åœ¨çº¿ç”¨æˆ·
  async removeOnlineUser(userId: number)

  // è·å–åœ¨çº¿ç”¨æˆ·åˆ—è¡¨
  async getOnlineUsers(): Promise<number[]>

  // è·å–åœ¨çº¿ç”¨æˆ·æ•°é‡
  async getOnlineUserCount(): Promise<number>
  ```

- [ ] å®ç°å•ç‚¹ç™»å½•æ§åˆ¶
  ```typescript
  // è®¾ç½®ç”¨æˆ·æ´»è·ƒToken
  async setActiveToken(userId: number, token: string)

  // è·å–ç”¨æˆ·æ´»è·ƒToken
  async getActiveToken(userId: number): Promise<string | null>

  // è¸¢å‡ºå…¶ä»–è®¾å¤‡
  async kickOtherDevices(userId: number, currentToken: string)
  ```

**éªŒæ”¶æ ‡å‡†**:
- âœ… æ‰€æœ‰æ–¹æ³•å®ç°å®Œæˆ
- âœ… å•å…ƒæµ‹è¯•è¦†ç›–ç‡ > 80%

#### ä»»åŠ¡4.2: æ”¹é€ è®¤è¯ä¸­é—´ä»¶ â° 1å¤©

**è´Ÿè´£äºº**: åç«¯å·¥ç¨‹å¸ˆ
**ä¼˜å…ˆçº§**: P0

**ä»»åŠ¡æ¸…å•**:
- [ ] ä¿®æ”¹ `server/src/middlewares/auth.middleware.ts`
- [ ] é›†æˆTokené»‘åå•æ£€æŸ¥
  ```typescript
  // éªŒè¯Tokenå‰æ£€æŸ¥é»‘åå•
  const isBlacklisted = await SessionService.isBlacklisted(token);
  if (isBlacklisted) {
    return res.status(401).json({ message: 'Tokenå·²å¤±æ•ˆ' });
  }
  ```

- [ ] æ›´æ–°ç”¨æˆ·æœ€åæ´»è·ƒæ—¶é—´
  ```typescript
  // TokenéªŒè¯æˆåŠŸåæ›´æ–°æ´»è·ƒæ—¶é—´
  await SessionService.updateLastActive(userId);
  ```

- [ ] æ·»åŠ å•ç‚¹ç™»å½•æ£€æŸ¥ï¼ˆå¯é€‰ï¼‰
  ```typescript
  // æ£€æŸ¥æ˜¯å¦æ˜¯æ´»è·ƒToken
  const activeToken = await SessionService.getActiveToken(userId);
  if (activeToken && activeToken !== token) {
    return res.status(401).json({ message: 'æ‚¨çš„è´¦å·åœ¨å…¶ä»–è®¾å¤‡ç™»å½•' });
  }
  ```

**éªŒæ”¶æ ‡å‡†**:
- âœ… Tokené»‘åå•æ£€æŸ¥ç”Ÿæ•ˆ
- âœ… åœ¨çº¿ç”¨æˆ·ç»Ÿè®¡å‡†ç¡®

#### ä»»åŠ¡4.3: ç™»å½•ç™»å‡ºæ”¹é€  â° 1å¤©

**è´Ÿè´£äºº**: åç«¯å·¥ç¨‹å¸ˆ
**ä¼˜å…ˆçº§**: P0

**ä»»åŠ¡æ¸…å•**:
- [ ] ä¿®æ”¹ç™»å½•æ¥å£ `server/src/controllers/auth.controller.ts`
  ```typescript
  // ç™»å½•æˆåŠŸå
  await SessionService.addOnlineUser(user.id, {
    token,
    loginTime: new Date(),
    device: req.headers['user-agent'],
    ip: req.ip
  });

  // å¯é€‰: å•ç‚¹ç™»å½•
  await SessionService.setActiveToken(user.id, token);
  ```

- [ ] ä¿®æ”¹ç™»å‡ºæ¥å£
  ```typescript
  // ç™»å‡ºæ—¶
  await SessionService.addToBlacklist(token, tokenExpiresIn);
  await SessionService.removeOnlineUser(userId);
  ```

- [ ] æ·»åŠ å¼ºåˆ¶ç™»å‡ºæ¥å£ï¼ˆç®¡ç†å‘˜åŠŸèƒ½ï¼‰
  ```typescript
  // POST /api/admin/force-logout
  async forceLogout(req: Request, res: Response) {
    const { userId } = req.body;
    const activeToken = await SessionService.getActiveToken(userId);
    if (activeToken) {
      await SessionService.addToBlacklist(activeToken, 3600);
      await SessionService.removeOnlineUser(userId);
    }
    return ApiResponse.success(res, null, 'å¼ºåˆ¶ç™»å‡ºæˆåŠŸ');
  }
  ```

**éªŒæ”¶æ ‡å‡†**:
- âœ… ç™»å½•ç™»å‡ºæµç¨‹æ­£å¸¸
- âœ… å¼ºåˆ¶ç™»å‡ºåŠŸèƒ½æ­£å¸¸

#### ä»»åŠ¡4.4: åœ¨çº¿ç”¨æˆ·ç›‘æ§ â° 1å¤©

**è´Ÿè´£äºº**: åç«¯å·¥ç¨‹å¸ˆ
**ä¼˜å…ˆçº§**: P1

**ä»»åŠ¡æ¸…å•**:
- [ ] åˆ›å»ºåœ¨çº¿ç”¨æˆ·ç›‘æ§æ¥å£
  ```typescript
  // GET /api/admin/online-users
  async getOnlineUsers(req: Request, res: Response) {
    const count = await SessionService.getOnlineUserCount();
    const users = await SessionService.getOnlineUsers();

    return ApiResponse.success(res, {
      count,
      users: users.slice(0, 100) // åªè¿”å›å‰100ä¸ª
    });
  }
  ```

- [ ] æ·»åŠ åœ¨çº¿ç”¨æˆ·ç»Ÿè®¡åˆ°Dashboard
- [ ] åˆ›å»ºåœ¨çº¿ç”¨æˆ·åˆ—è¡¨é¡µé¢ï¼ˆå‰ç«¯ï¼‰

**éªŒæ”¶æ ‡å‡†**:
- âœ… åœ¨çº¿ç”¨æˆ·ç»Ÿè®¡å‡†ç¡®
- âœ… Dashboardæ˜¾ç¤ºåœ¨çº¿ç”¨æˆ·æ•°

#### ä»»åŠ¡4.5: ä¼šè¯è¶…æ—¶æ¸…ç† â° 1å¤©

**è´Ÿè´£äºº**: åç«¯å·¥ç¨‹å¸ˆ
**ä¼˜å…ˆçº§**: P1

**ä»»åŠ¡æ¸…å•**:
- [ ] åˆ›å»ºå®šæ—¶ä»»åŠ¡æ¸…ç†è¿‡æœŸä¼šè¯
  ```typescript
  // server/src/jobs/session-cleanup.job.ts
  import schedule from 'node-schedule';

  // æ¯å°æ—¶æ‰§è¡Œä¸€æ¬¡
  schedule.scheduleJob('0 * * * *', async () => {
    console.log('ğŸ§¹ å¼€å§‹æ¸…ç†è¿‡æœŸä¼šè¯...');

    const onlineUsers = await SessionService.getOnlineUsers();
    let cleanedCount = 0;

    for (const userId of onlineUsers) {
      const lastActive = await SessionService.getLastActive(userId);
      const now = Date.now();

      // è¶…è¿‡30åˆ†é’Ÿæœªæ´»è·ƒï¼Œç§»é™¤åœ¨çº¿çŠ¶æ€
      if (now - lastActive > 30 * 60 * 1000) {
        await SessionService.removeOnlineUser(userId);
        cleanedCount++;
      }
    }

    console.log(`âœ… æ¸…ç†å®Œæˆï¼Œå…±æ¸…ç† ${cleanedCount} ä¸ªè¿‡æœŸä¼šè¯`);
  });
  ```

- [ ] åœ¨åº”ç”¨å¯åŠ¨æ—¶æ³¨å†Œå®šæ—¶ä»»åŠ¡

**éªŒæ”¶æ ‡å‡†**:
- âœ… å®šæ—¶ä»»åŠ¡æ­£å¸¸è¿è¡Œ
- âœ… è¿‡æœŸä¼šè¯è‡ªåŠ¨æ¸…ç†

**Week 4 äº¤ä»˜ç‰©**:
- âœ… ä¼šè¯ç®¡ç†ç³»ç»Ÿ
- âœ… Tokené»‘åå•åŠŸèƒ½
- âœ… åœ¨çº¿ç”¨æˆ·ç›‘æ§
- âœ… å•ç‚¹ç™»å½•æ§åˆ¶ï¼ˆå¯é€‰ï¼‰

---

### Week 5: ä¸­å¿ƒé¡µé¢ç¼“å­˜ (2025-02-03 ~ 2025-02-09)

#### ä»»åŠ¡5.1: CenterCacheServiceå®ç° â° 2å¤©

**è´Ÿè´£äºº**: åç«¯å·¥ç¨‹å¸ˆ
**ä¼˜å…ˆçº§**: P0

**ä»»åŠ¡æ¸…å•**:
- [ ] åˆ›å»º `server/src/services/center-cache.service.ts`
- [ ] å®ç°æ··åˆç¼“å­˜ç­–ç•¥
  ```typescript
  // è·å–ä¸­å¿ƒæ•°æ®ï¼ˆå…¬å…±ç»Ÿè®¡ + è§’è‰²åˆ—è¡¨ + ç”¨æˆ·æ•°æ®ï¼‰
  async getCenterData(
    centerName: string,
    userId: number,
    userRole: string,
    options: { page?: number; filters?: any }
  )
  ```

- [ ] å®ç°15ä¸ªä¸­å¿ƒçš„æ•°æ®åŠ è½½æ–¹æ³•
  ```typescript
  private async loadDashboardData(userId: number, userRole: string)
  private async loadActivityCenterData(userId: number, userRole: string)
  private async loadEnrollmentCenterData(userId: number, userRole: string)
  // ... å…¶ä»–12ä¸ªä¸­å¿ƒ
  ```

- [ ] å®ç°æ•™å¸ˆä¸“ç”¨æ•°æ®åŠ è½½
  ```typescript
  private async loadTeacherCenterData(
    centerName: string,
    teacherId: number
  )
  ```

**éªŒæ”¶æ ‡å‡†**:
- âœ… 15ä¸ªä¸­å¿ƒæ•°æ®åŠ è½½æ–¹æ³•å®ç°å®Œæˆ
- âœ… æ··åˆç¼“å­˜ç­–ç•¥æ­£ç¡®å®ç°

#### ä»»åŠ¡5.2: Dashboardç¼“å­˜é›†æˆ â° 1å¤©

**è´Ÿè´£äºº**: åç«¯å·¥ç¨‹å¸ˆ
**ä¼˜å…ˆçº§**: P0

**ä»»åŠ¡æ¸…å•**:
- [ ] ä¿®æ”¹ `server/src/controllers/dashboard.controller.ts`
- [ ] é›†æˆCenterCacheService
  ```typescript
  async getDashboardStats(req: Request, res: Response) {
    const userId = req.user.id;
    const userRole = req.user.role;

    // ä½¿ç”¨ç¼“å­˜
    const data = await CenterCacheService.getCenterData(
      'dashboard',
      userId,
      userRole
    );

    return ApiResponse.success(res, data);
  }
  ```

- [ ] æ·»åŠ ç¼“å­˜å‘½ä¸­ç‡ç»Ÿè®¡
- [ ] æ€§èƒ½æµ‹è¯•

**éªŒæ”¶æ ‡å‡†**:
- âœ… DashboardåŠ è½½æ—¶é—´ < 300ms
- âœ… ç¼“å­˜å‘½ä¸­ç‡ > 85%

#### ä»»åŠ¡5.3: æ´»åŠ¨ä¸­å¿ƒç¼“å­˜é›†æˆ â° 1å¤©

**è´Ÿè´£äºº**: åç«¯å·¥ç¨‹å¸ˆ
**ä¼˜å…ˆçº§**: P0

**ä»»åŠ¡æ¸…å•**:
- [ ] ä¿®æ”¹ `server/src/controllers/centers/activity-center.controller.ts`
- [ ] é›†æˆç¼“å­˜æœåŠ¡
- [ ] æ·»åŠ æ•™å¸ˆä¸“ç”¨æ•°æ®ç¼“å­˜
- [ ] æ€§èƒ½æµ‹è¯•

**éªŒæ”¶æ ‡å‡†**:
- âœ… æ´»åŠ¨ä¸­å¿ƒåŠ è½½æ—¶é—´ < 200ms
- âœ… æ•™å¸ˆå’Œç®¡ç†å‘˜æ•°æ®éš”ç¦»

#### ä»»åŠ¡5.4: å…¶ä»–ä¸­å¿ƒç¼“å­˜é›†æˆ â° 2å¤©

**è´Ÿè´£äºº**: åç«¯å·¥ç¨‹å¸ˆ
**ä¼˜å…ˆçº§**: P0

**ä»»åŠ¡æ¸…å•**:
- [ ] æ‹›ç”Ÿä¸­å¿ƒç¼“å­˜é›†æˆ
- [ ] äººå‘˜ä¸­å¿ƒç¼“å­˜é›†æˆ
- [ ] è¥é”€ä¸­å¿ƒç¼“å­˜é›†æˆ
- [ ] ä»»åŠ¡ä¸­å¿ƒç¼“å­˜é›†æˆ
- [ ] è´¢åŠ¡ä¸­å¿ƒç¼“å­˜é›†æˆ
- [ ] æ•™å­¦ä¸­å¿ƒç¼“å­˜é›†æˆ
- [ ] å…¶ä»–7ä¸ªä¸­å¿ƒç¼“å­˜é›†æˆ

**éªŒæ”¶æ ‡å‡†**:
- âœ… æ‰€æœ‰15ä¸ªä¸­å¿ƒç¼“å­˜é›†æˆå®Œæˆ
- âœ… å¹³å‡åŠ è½½æ—¶é—´ < 300ms

#### ä»»åŠ¡5.5: ç¼“å­˜é¢„çƒ­ â° 1å¤©

**è´Ÿè´£äºº**: åç«¯å·¥ç¨‹å¸ˆ
**ä¼˜å…ˆçº§**: P1

**ä»»åŠ¡æ¸…å•**:
- [ ] åˆ›å»ºç¼“å­˜é¢„çƒ­è„šæœ¬ `server/src/scripts/cache-warmup.ts`
  ```typescript
  async function warmupCenterCache() {
    console.log('ğŸ”¥ å¼€å§‹é¢„çƒ­ä¸­å¿ƒé¡µé¢ç¼“å­˜...');

    // é¢„çƒ­å…¬å…±ç»Ÿè®¡æ•°æ®
    const centers = [
      'dashboard', 'activity', 'enrollment', 'personnel',
      'marketing', 'ai', 'system', 'customer-pool',
      'analytics', 'task', 'finance', 'script',
      'teaching', 'media', 'business'
    ];

    for (const center of centers) {
      await CenterCacheService.warmupCenter(center);
      console.log(`âœ… ${center} é¢„çƒ­å®Œæˆ`);
    }

    console.log('ğŸ‰ ç¼“å­˜é¢„çƒ­å®Œæˆ');
  }
  ```

- [ ] åœ¨åº”ç”¨å¯åŠ¨æ—¶æ‰§è¡Œé¢„çƒ­
- [ ] æ·»åŠ é¢„çƒ­è¿›åº¦æ—¥å¿—

**éªŒæ”¶æ ‡å‡†**:
- âœ… åº”ç”¨å¯åŠ¨æ—¶è‡ªåŠ¨é¢„çƒ­
- âœ… é¢„çƒ­æ—¶é—´ < 30ç§’

**Week 5 äº¤ä»˜ç‰©**:
- âœ… 15ä¸ªä¸­å¿ƒé¡µé¢ç¼“å­˜ç³»ç»Ÿ
- âœ… æ•™å¸ˆä¸“ç”¨æ•°æ®ç¼“å­˜
- âœ… ç¼“å­˜é¢„çƒ­æœºåˆ¶
- âœ… æ€§èƒ½æµ‹è¯•æŠ¥å‘Š

---

### Week 6: é™æµé˜²åˆ· (2025-02-10 ~ 2025-02-16)

#### ä»»åŠ¡6.1: é™æµä¸­é—´ä»¶å®ç° â° 2å¤©

**è´Ÿè´£äºº**: åç«¯å·¥ç¨‹å¸ˆ
**ä¼˜å…ˆçº§**: P0

**ä»»åŠ¡æ¸…å•**:
- [ ] åˆ›å»º `server/src/middlewares/rate-limit.middleware.ts`
- [ ] å®ç°APIé™æµ
  ```typescript
  export function rateLimitMiddleware(options: {
    windowMs: number;  // æ—¶é—´çª—å£ï¼ˆæ¯«ç§’ï¼‰
    max: number;       // æœ€å¤§è¯·æ±‚æ•°
    keyGenerator?: (req: Request) => string;
  }) {
    return async (req: Request, res: Response, next: NextFunction) => {
      const key = options.keyGenerator
        ? options.keyGenerator(req)
        : `ratelimit:api:${req.user?.id}:${req.path}`;

      const count = await RedisService.incr(key);

      if (count === 1) {
        await RedisService.expire(key, Math.ceil(options.windowMs / 1000));
      }

      if (count > options.max) {
        return res.status(429).json({
          success: false,
          message: 'è¯·æ±‚è¿‡äºé¢‘ç¹ï¼Œè¯·ç¨åå†è¯•'
        });
      }

      // è®¾ç½®å“åº”å¤´
      res.setHeader('X-RateLimit-Limit', options.max);
      res.setHeader('X-RateLimit-Remaining', Math.max(0, options.max - count));

      next();
    };
  }
  ```

- [ ] å®ç°IPé™æµ
  ```typescript
  export function ipRateLimitMiddleware(options: {
    windowMs: number;
    max: number;
  }) {
    return rateLimitMiddleware({
      ...options,
      keyGenerator: (req) => `ratelimit:ip:${req.ip}`
    });
  }
  ```

**éªŒæ”¶æ ‡å‡†**:
- âœ… é™æµä¸­é—´ä»¶æ­£å¸¸å·¥ä½œ
- âœ… è¶…è¿‡é™åˆ¶è¿”å›429çŠ¶æ€ç 

#### ä»»åŠ¡6.2: åº”ç”¨é™æµç­–ç•¥ â° 1å¤©

**è´Ÿè´£äºº**: åç«¯å·¥ç¨‹å¸ˆ
**ä¼˜å…ˆçº§**: P0

**ä»»åŠ¡æ¸…å•**:
- [ ] ä¸ºä¸åŒAPIè®¾ç½®é™æµç­–ç•¥
  ```typescript
  // é€šç”¨API: æ¯åˆ†é’Ÿ100æ¬¡
  router.use('/api', rateLimitMiddleware({
    windowMs: 60 * 1000,
    max: 100
  }));

  // ç™»å½•æ¥å£: æ¯15åˆ†é’Ÿ5æ¬¡
  router.post('/api/auth/login', rateLimitMiddleware({
    windowMs: 15 * 60 * 1000,
    max: 5,
    keyGenerator: (req) => `ratelimit:login:${req.ip}`
  }));

  // æ•æ„Ÿæ“ä½œ: æ¯å°æ—¶20æ¬¡
  router.use('/api/admin', rateLimitMiddleware({
    windowMs: 60 * 60 * 1000,
    max: 20
  }));
  ```

**éªŒæ”¶æ ‡å‡†**:
- âœ… æ‰€æœ‰å…³é”®APIåº”ç”¨é™æµ
- âœ… é™æµç­–ç•¥åˆç†

#### ä»»åŠ¡6.3: é˜²åˆ·æœºåˆ¶ â° 1å¤©

**è´Ÿè´£äºº**: åç«¯å·¥ç¨‹å¸ˆ
**ä¼˜å…ˆçº§**: P1

**ä»»åŠ¡æ¸…å•**:
- [ ] å®ç°éªŒè¯ç æœºåˆ¶ï¼ˆç™»å½•ã€æ³¨å†Œï¼‰
- [ ] å®ç°æ»‘åŠ¨éªŒè¯ï¼ˆæ•æ„Ÿæ“ä½œï¼‰
- [ ] å®ç°è¡Œä¸ºåˆ†æï¼ˆå¼‚å¸¸æ£€æµ‹ï¼‰
  ```typescript
  async detectAbnormalBehavior(userId: number, action: string) {
    const key = `behavior:${userId}:${action}`;
    const count = await RedisService.incr(key);

    if (count === 1) {
      await RedisService.expire(key, 60); // 1åˆ†é’Ÿçª—å£
    }

    // 1åˆ†é’Ÿå†…è¶…è¿‡10æ¬¡ç›¸åŒæ“ä½œï¼Œæ ‡è®°ä¸ºå¼‚å¸¸
    if (count > 10) {
      await this.markAsAbnormal(userId);
      return true;
    }

    return false;
  }
  ```

**éªŒæ”¶æ ‡å‡†**:
- âœ… é˜²åˆ·æœºåˆ¶æ­£å¸¸å·¥ä½œ
- âœ… å¼‚å¸¸è¡Œä¸ºèƒ½è¢«æ£€æµ‹

#### ä»»åŠ¡6.4: æµ‹è¯•å’Œä¼˜åŒ– â° 1å¤©

**è´Ÿè´£äºº**: æµ‹è¯•å·¥ç¨‹å¸ˆ
**ä¼˜å…ˆçº§**: P0

**ä»»åŠ¡æ¸…å•**:
- [ ] æµ‹è¯•é™æµåŠŸèƒ½
- [ ] æµ‹è¯•é˜²åˆ·æœºåˆ¶
- [ ] å‹åŠ›æµ‹è¯•
- [ ] ä¼˜åŒ–é™æµå‚æ•°

**éªŒæ”¶æ ‡å‡†**:
- âœ… é™æµåŠŸèƒ½æ­£å¸¸
- âœ… ä¸å½±å“æ­£å¸¸ç”¨æˆ·ä½¿ç”¨

**Week 6 äº¤ä»˜ç‰©**:
- âœ… é™æµä¸­é—´ä»¶
- âœ… APIé™æµç­–ç•¥
- âœ… é˜²åˆ·æœºåˆ¶
- âœ… æµ‹è¯•æŠ¥å‘Š

---

### Week 7: å®æ—¶æ¨é€å’Œæ’è¡Œæ¦œ (2025-02-17 ~ 2025-02-23)

#### ä»»åŠ¡7.1: Redis Pub/Subé›†æˆ â° 2å¤©

**è´Ÿè´£äºº**: åç«¯å·¥ç¨‹å¸ˆ
**ä¼˜å…ˆçº§**: P1

**ä»»åŠ¡æ¸…å•**:
- [ ] åˆ›å»º `server/src/services/pubsub.service.ts`
- [ ] å®ç°å‘å¸ƒè®¢é˜…åŠŸèƒ½
  ```typescript
  // å‘å¸ƒæ¶ˆæ¯
  async publish(channel: string, message: any) {
    await redisClient.publish(channel, JSON.stringify(message));
  }

  // è®¢é˜…é¢‘é“
  async subscribe(channel: string, callback: (message: any) => void) {
    const subscriber = redisClient.duplicate();
    await subscriber.subscribe(channel);

    subscriber.on('message', (ch, msg) => {
      if (ch === channel) {
        callback(JSON.parse(msg));
      }
    });
  }
  ```

- [ ] å®ç°WebSocketé›†æˆ
- [ ] å®ç°æ¶ˆæ¯æ¨é€

**éªŒæ”¶æ ‡å‡†**:
- âœ… Pub/SubåŠŸèƒ½æ­£å¸¸
- âœ… WebSocketæ¨é€æ­£å¸¸

#### ä»»åŠ¡7.2: æ’è¡Œæ¦œå®ç° â° 1å¤©

**è´Ÿè´£äºº**: åç«¯å·¥ç¨‹å¸ˆ
**ä¼˜å…ˆçº§**: P1

**ä»»åŠ¡æ¸…å•**:
- [ ] åˆ›å»º `server/src/services/ranking.service.ts`
- [ ] å®ç°æ´»åŠ¨æŠ¥åæ’è¡Œ
  ```typescript
  async updateActivityRanking(activityId: number, studentId: number) {
    const key = `ranking:activity:registrations:${activityId}`;
    const score = Date.now();

    await RedisService.zadd(key, score, `student:${studentId}`);
  }

  async getActivityRanking(activityId: number, limit: number = 10) {
    const key = `ranking:activity:registrations:${activityId}`;
    return await RedisService.zrange(key, 0, limit - 1, true);
  }
  ```

- [ ] å®ç°æ•™å¸ˆç»©æ•ˆæ’è¡Œ
- [ ] å®ç°ç­çº§æ’è¡Œ

**éªŒæ”¶æ ‡å‡†**:
- âœ… æ’è¡Œæ¦œåŠŸèƒ½æ­£å¸¸
- âœ… å®æ—¶æ›´æ–°

#### ä»»åŠ¡7.3: åˆ†å¸ƒå¼é”åº”ç”¨ â° 1å¤©

**è´Ÿè´£äºº**: åç«¯å·¥ç¨‹å¸ˆ
**ä¼˜å…ˆçº§**: P1

**ä»»åŠ¡æ¸…å•**:
- [ ] åœ¨æ‹›ç”Ÿåé¢æ‰£å‡ä¸­ä½¿ç”¨åˆ†å¸ƒå¼é”
  ```typescript
  async enrollStudent(planId: number, studentId: number) {
    const lockKey = `lock:enrollment:quota:${planId}`;
    const acquired = await RedisService.acquireLock(lockKey, 30);

    if (!acquired) {
      throw new Error('ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨åå†è¯•');
    }

    try {
      // æ£€æŸ¥åé¢
      const quota = await this.getAvailableQuota(planId);
      if (quota <= 0) {
        throw new Error('åé¢å·²æ»¡');
      }

      // æ‰£å‡åé¢
      await this.deductQuota(planId);

      // åˆ›å»ºæŠ¥åè®°å½•
      await this.createEnrollment(planId, studentId);

    } finally {
      await RedisService.releaseLock(lockKey);
    }
  }
  ```

- [ ] åœ¨æ´»åŠ¨æŠ¥åä¸­ä½¿ç”¨åˆ†å¸ƒå¼é”
- [ ] åœ¨æ•°æ®å¯¼å‡ºä¸­ä½¿ç”¨åˆ†å¸ƒå¼é”

**éªŒæ”¶æ ‡å‡†**:
- âœ… åˆ†å¸ƒå¼é”æ­£å¸¸å·¥ä½œ
- âœ… é˜²æ­¢å¹¶å‘é—®é¢˜

**Week 7 äº¤ä»˜ç‰©**:
- âœ… å®æ—¶æ¨é€ç³»ç»Ÿ
- âœ… æ’è¡Œæ¦œåŠŸèƒ½
- âœ… åˆ†å¸ƒå¼é”åº”ç”¨

---

### Week 8: å…¨é¢æµ‹è¯• (2025-02-24 ~ 2025-03-02)

#### ä»»åŠ¡8.1: å•å…ƒæµ‹è¯•è¡¥å…… â° 2å¤©

**è´Ÿè´£äºº**: æµ‹è¯•å·¥ç¨‹å¸ˆ
**ä¼˜å…ˆçº§**: P0

**ä»»åŠ¡æ¸…å•**:
- [ ] è¡¥å……æ‰€æœ‰æœåŠ¡çš„å•å…ƒæµ‹è¯•
- [ ] ç¡®ä¿æµ‹è¯•è¦†ç›–ç‡ > 80%
- [ ] ä¿®å¤æµ‹è¯•å¤±è´¥çš„ç”¨ä¾‹

**éªŒæ”¶æ ‡å‡†**:
- âœ… å•å…ƒæµ‹è¯•è¦†ç›–ç‡ > 80%
- âœ… æ‰€æœ‰æµ‹è¯•é€šè¿‡

#### ä»»åŠ¡8.2: é›†æˆæµ‹è¯• â° 2å¤©

**è´Ÿè´£äºº**: æµ‹è¯•å·¥ç¨‹å¸ˆ
**ä¼˜å…ˆçº§**: P0

**ä»»åŠ¡æ¸…å•**:
- [ ] ç¼–å†™ç«¯åˆ°ç«¯é›†æˆæµ‹è¯•
- [ ] æµ‹è¯•å®Œæ•´ä¸šåŠ¡æµç¨‹
- [ ] æµ‹è¯•ç¼“å­˜ä¸€è‡´æ€§
- [ ] æµ‹è¯•æ•…éšœæ¢å¤

**éªŒæ”¶æ ‡å‡†**:
- âœ… é›†æˆæµ‹è¯•é€šè¿‡
- âœ… ä¸šåŠ¡æµç¨‹æ­£å¸¸

#### ä»»åŠ¡8.3: å‹åŠ›æµ‹è¯• â° 1å¤©

**è´Ÿè´£äºº**: æµ‹è¯•å·¥ç¨‹å¸ˆ
**ä¼˜å…ˆçº§**: P0

**ä»»åŠ¡æ¸…å•**:
- [ ] ä½¿ç”¨JMeter/K6è¿›è¡Œå‹åŠ›æµ‹è¯•
- [ ] æµ‹è¯•å¹¶å‘1000 QPS
- [ ] æµ‹è¯•é•¿æ—¶é—´è¿è¡Œç¨³å®šæ€§
- [ ] ç”Ÿæˆå‹åŠ›æµ‹è¯•æŠ¥å‘Š

**éªŒæ”¶æ ‡å‡†**:
- âœ… å¹¶å‘1000 QPSæ— å‹åŠ›
- âœ… é•¿æ—¶é—´è¿è¡Œç¨³å®š

#### ä»»åŠ¡8.4: æ•…éšœæ¼”ç»ƒ â° 1å¤©

**è´Ÿè´£äºº**: è¿ç»´å·¥ç¨‹å¸ˆ
**ä¼˜å…ˆçº§**: P0

**ä»»åŠ¡æ¸…å•**:
- [ ] Redis Masterå®•æœºæ¼”ç»ƒ
- [ ] Redis Slaveå®•æœºæ¼”ç»ƒ
- [ ] Sentinelå®•æœºæ¼”ç»ƒ
- [ ] ç½‘ç»œæ•…éšœæ¼”ç»ƒ
- [ ] éªŒè¯æ•…éšœè½¬ç§»å’Œæ¢å¤

**éªŒæ”¶æ ‡å‡†**:
- âœ… æ•…éšœè‡ªåŠ¨è½¬ç§»
- âœ… æœåŠ¡å¿«é€Ÿæ¢å¤

**Week 8 äº¤ä»˜ç‰©**:
- âœ… å®Œæ•´æµ‹è¯•æŠ¥å‘Š
- âœ… å‹åŠ›æµ‹è¯•æŠ¥å‘Š
- âœ… æ•…éšœæ¼”ç»ƒæŠ¥å‘Š

---

### Week 9: ç°åº¦ä¸Šçº¿ (2025-03-03 ~ 2025-03-09)

#### ä»»åŠ¡9.1: ç°åº¦å‘å¸ƒå‡†å¤‡ â° 1å¤©

**è´Ÿè´£äºº**: è¿ç»´å·¥ç¨‹å¸ˆ
**ä¼˜å…ˆçº§**: P0

**ä»»åŠ¡æ¸…å•**:
- [ ] å‡†å¤‡ç°åº¦å‘å¸ƒæ–¹æ¡ˆ
- [ ] é…ç½®ç°åº¦æµé‡è§„åˆ™
- [ ] å‡†å¤‡å›æ»šæ–¹æ¡ˆ
- [ ] é€šçŸ¥ç›¸å…³äººå‘˜

**éªŒæ”¶æ ‡å‡†**:
- âœ… ç°åº¦æ–¹æ¡ˆå®Œæ•´
- âœ… å›æ»šæ–¹æ¡ˆå¯è¡Œ

#### ä»»åŠ¡9.2: 10%æµé‡ç°åº¦ â° 2å¤©

**è´Ÿè´£äºº**: è¿ç»´å·¥ç¨‹å¸ˆ
**ä¼˜å…ˆçº§**: P0

**ä»»åŠ¡æ¸…å•**:
- [ ] å‘å¸ƒåˆ°10%ç”¨æˆ·
- [ ] ç›‘æ§ç³»ç»ŸæŒ‡æ ‡
- [ ] æ”¶é›†ç”¨æˆ·åé¦ˆ
- [ ] ä¿®å¤å‘ç°çš„é—®é¢˜

**éªŒæ”¶æ ‡å‡†**:
- âœ… 10%æµé‡è¿è¡Œæ­£å¸¸
- âœ… æ— ä¸¥é‡é—®é¢˜

#### ä»»åŠ¡9.3: 50%æµé‡ç°åº¦ â° 2å¤©

**è´Ÿè´£äºº**: è¿ç»´å·¥ç¨‹å¸ˆ
**ä¼˜å…ˆçº§**: P0

**ä»»åŠ¡æ¸…å•**:
- [ ] æ‰©å¤§åˆ°50%ç”¨æˆ·
- [ ] æŒç»­ç›‘æ§
- [ ] æ€§èƒ½è°ƒä¼˜
- [ ] é—®é¢˜ä¿®å¤

**éªŒæ”¶æ ‡å‡†**:
- âœ… 50%æµé‡è¿è¡Œæ­£å¸¸
- âœ… æ€§èƒ½è¾¾æ ‡

#### ä»»åŠ¡9.4: 100%å…¨é‡ä¸Šçº¿ â° 1å¤©

**è´Ÿè´£äºº**: è¿ç»´å·¥ç¨‹å¸ˆ
**ä¼˜å…ˆçº§**: P0

**ä»»åŠ¡æ¸…å•**:
- [ ] å…¨é‡å‘å¸ƒ
- [ ] å…¨é¢ç›‘æ§
- [ ] æ€§èƒ½éªŒè¯
- [ ] é¡¹ç›®æ€»ç»“

**éªŒæ”¶æ ‡å‡†**:
- âœ… å…¨é‡ä¸Šçº¿æˆåŠŸ
- âœ… æ‰€æœ‰æŒ‡æ ‡è¾¾æ ‡

**Week 9 äº¤ä»˜ç‰©**:
- âœ… ç”Ÿäº§ç¯å¢ƒä¸Šçº¿
- âœ… ä¸Šçº¿æŠ¥å‘Š
- âœ… é¡¹ç›®æ€»ç»“æ–‡æ¡£

---

## äº”ã€é£é™©ç®¡ç†

### 5.1 æŠ€æœ¯é£é™©

| é£é™© | æ¦‚ç‡ | å½±å“ | åº”å¯¹æªæ–½ | è´Ÿè´£äºº |
|------|------|------|---------|--------|
| Rediså®•æœº | ä¸­ | é«˜ | Sentinelè‡ªåŠ¨æ•…éšœè½¬ç§» + é™çº§ç­–ç•¥ | è¿ç»´ |
| ç¼“å­˜é›ªå´© | ä½ | é«˜ | éšæœºTTL + ç¼“å­˜é¢„çƒ­ + äº’æ–¥é” | åç«¯ |
| æ•°æ®ä¸ä¸€è‡´ | ä¸­ | ä¸­ | å®Œå–„ç¼“å­˜å¤±æ•ˆæœºåˆ¶ + ç›‘æ§å‘Šè­¦ | åç«¯ |
| å†…å­˜æº¢å‡º | ä½ | ä¸­ | maxmemoryé™åˆ¶ + LRUæ·˜æ±° | è¿ç»´ |

### 5.2 è¿›åº¦é£é™©

| é£é™© | æ¦‚ç‡ | å½±å“ | åº”å¯¹æªæ–½ |
|------|------|------|---------|
| äººå‘˜ä¸è¶³ | ä¸­ | é«˜ | æå‰æ‹›è˜ + å¤–éƒ¨æ”¯æŒ |
| éœ€æ±‚å˜æ›´ | ä¸­ | ä¸­ | æ•æ·å¼€å‘ + å¿«é€Ÿå“åº” |
| æµ‹è¯•ä¸å……åˆ† | ä½ | é«˜ | å¢åŠ æµ‹è¯•æ—¶é—´ + è‡ªåŠ¨åŒ–æµ‹è¯• |

---

## å…­ã€éªŒæ”¶æ ‡å‡†

### 6.1 åŠŸèƒ½éªŒæ”¶

- [ ] Redisé«˜å¯ç”¨é›†ç¾¤éƒ¨ç½²å®Œæˆ
- [ ] RedisServiceå®Œæ•´å®ç°
- [ ] æƒé™è·¯ç”±ç¼“å­˜ç³»ç»Ÿä¸Šçº¿
- [ ] 15ä¸ªä¸­å¿ƒé¡µé¢ç¼“å­˜ç³»ç»Ÿä¸Šçº¿
- [ ] ä¼šè¯ç®¡ç†ç³»ç»Ÿä¸Šçº¿
- [ ] é™æµé˜²åˆ·ç³»ç»Ÿä¸Šçº¿
- [ ] å®æ—¶æ¨é€å’Œæ’è¡Œæ¦œç³»ç»Ÿä¸Šçº¿
- [ ] ç›‘æ§å‘Šè­¦ç³»ç»Ÿä¸Šçº¿

### 6.2 æ€§èƒ½éªŒæ”¶

- [ ] æƒé™æŸ¥è¯¢å“åº”æ—¶é—´ < 10ms
- [ ] DashboardåŠ è½½æ—¶é—´ < 300ms
- [ ] æ´»åŠ¨ä¸­å¿ƒåŠ è½½æ—¶é—´ < 200ms
- [ ] ç³»ç»Ÿå¹¶å‘èƒ½åŠ› > 1000 QPS
- [ ] ç¼“å­˜å‘½ä¸­ç‡ > 85%
- [ ] æ•°æ®åº“æŸ¥è¯¢æ¬¡æ•°é™ä½ > 70%

### 6.3 è´¨é‡éªŒæ”¶

- [ ] å•å…ƒæµ‹è¯•è¦†ç›–ç‡ > 80%
- [ ] é›†æˆæµ‹è¯•é€šè¿‡ç‡ 100%
- [ ] å‹åŠ›æµ‹è¯•é€šè¿‡
- [ ] æ•…éšœæ¼”ç»ƒé€šè¿‡
- [ ] ä»£ç å®¡æŸ¥é€šè¿‡
- [ ] æ–‡æ¡£å®Œæ•´

---

## ä¸ƒã€èµ„æºéœ€æ±‚

### 7.1 äººåŠ›èµ„æº

| è§’è‰² | äººæ•° | æŠ•å…¥æ—¶é—´ | ä¸»è¦èŒè´£ |
|------|------|---------|---------|
| åç«¯å·¥ç¨‹å¸ˆ | 2 | å…¨èŒ9å‘¨ | ä»£ç å¼€å‘ã€æµ‹è¯• |
| è¿ç»´å·¥ç¨‹å¸ˆ | 1 | å‰2å‘¨å…¨èŒ | ç¯å¢ƒéƒ¨ç½²ã€ç›‘æ§ |
| æµ‹è¯•å·¥ç¨‹å¸ˆ | 1 | å3å‘¨å…¨èŒ | æµ‹è¯•ã€éªŒæ”¶ |
| é¡¹ç›®ç»ç† | 1 | å…¼èŒ9å‘¨ | é¡¹ç›®ç®¡ç†ã€åè°ƒ |

### 7.2 ç¡¬ä»¶èµ„æº

| èµ„æº | æ•°é‡ | é…ç½® | æœˆæˆæœ¬ |
|------|------|------|--------|
| Redis Master | 1 | 4GB/2æ ¸/40GB | Â¥200 |
| Redis Slave | 2 | 4GB/2æ ¸/40GB | Â¥400 |
| Sentinel | 3 | 512MB/1æ ¸ | Â¥150 |
| **æ€»è®¡** | 6 | - | **Â¥750** |

### 7.3 è½¯ä»¶èµ„æº

- Redis 7.x (å¼€æºå…è´¹)
- ioredis (å¼€æºå…è´¹)
- Prometheus + Grafana (å¼€æºå…è´¹)

---

## å…«ã€æ²Ÿé€šè®¡åˆ’

### 8.1 ä¼šè®®å®‰æ’

| ä¼šè®® | é¢‘ç‡ | å‚ä¸äºº | ç›®çš„ |
|------|------|--------|------|
| é¡¹ç›®å¯åŠ¨ä¼š | ä¸€æ¬¡ | å…¨å‘˜ | é¡¹ç›®ä»‹ç»ã€ä»»åŠ¡åˆ†é… |
| æ¯æ—¥ç«™ä¼š | æ¯å¤© | å¼€å‘å›¢é˜Ÿ | è¿›åº¦åŒæ­¥ã€é—®é¢˜è®¨è®º |
| å‘¨ä¾‹ä¼š | æ¯å‘¨ | å…¨å‘˜ | å‘¨æ€»ç»“ã€ä¸‹å‘¨è®¡åˆ’ |
| é‡Œç¨‹ç¢‘è¯„å®¡ | æ¯é˜¶æ®µ | å…¨å‘˜+ç®¡ç†å±‚ | é˜¶æ®µéªŒæ”¶ã€å†³ç­– |

### 8.2 æ²Ÿé€šæ¸ é“

- å³æ—¶æ²Ÿé€š: ä¼ä¸šå¾®ä¿¡/é’‰é’‰
- æ–‡æ¡£åä½œ: é£ä¹¦æ–‡æ¡£/Notion
- ä»£ç åä½œ: Git + Code Review
- é—®é¢˜è·Ÿè¸ª: Jira/ç¦…é“

---

## ä¹ã€é™„å½•

### é™„å½•A: å¿«é€Ÿå¯åŠ¨æŒ‡å—

```bash
# 1. å…‹éš†ä»£ç 
git clone <repository>
cd kindergarten-management-system

# 2. å®‰è£…ä¾èµ–
cd server && npm install

# 3. é…ç½®ç¯å¢ƒå˜é‡
cp .env.example .env
# ç¼–è¾‘.envï¼Œå¡«å…¥Redisé…ç½®

# 4. å¯åŠ¨æœåŠ¡
npm run dev

# 5. éªŒè¯Redisè¿æ¥
curl http://localhost:3000/api/health/redis
```

### é™„å½•B: å¸¸ç”¨å‘½ä»¤

```bash
# Redisè¿æ¥æµ‹è¯•
redis-cli -h <host> -p 6379 -a <password> PING

# æŸ¥çœ‹Redisä¿¡æ¯
redis-cli -a <password> INFO

# æŸ¥çœ‹ç¼“å­˜key
redis-cli -a <password> KEYS "user:permissions:*"

# æ¸…ç©ºç¼“å­˜
redis-cli -a <password> FLUSHDB

# ç›‘æ§Rediså‘½ä»¤
redis-cli -a <password> MONITOR
```

### é™„å½•C: æ•…éšœæ’æŸ¥

| é—®é¢˜ | å¯èƒ½åŸå›  | è§£å†³æ–¹æ¡ˆ |
|------|---------|---------|
| è¿æ¥å¤±è´¥ | ç½‘ç»œ/å¯†ç é”™è¯¯ | æ£€æŸ¥ç½‘ç»œå’Œå¯†ç é…ç½® |
| ç¼“å­˜æœªå‘½ä¸­ | TTLè¿‡æœŸ/æœªå†™å…¥ | æ£€æŸ¥TTLè®¾ç½®å’Œå†™å…¥é€»è¾‘ |
| å†…å­˜ä¸è¶³ | æ•°æ®é‡è¿‡å¤§ | å¢åŠ å†…å­˜æˆ–è°ƒæ•´æ·˜æ±°ç­–ç•¥ |
| ä¸»ä»å»¶è¿Ÿ | ç½‘ç»œå¸¦å®½ä¸è¶³ | ä¼˜åŒ–ç½‘ç»œæˆ–è¯»ä¸»åº“ |

---

**æ–‡æ¡£ç»“æŸ**

**ä¸‹ä¸€æ­¥è¡ŒåŠ¨**:
1. å¬å¼€é¡¹ç›®å¯åŠ¨ä¼š
2. åˆ†é…ä»»åŠ¡å’Œè´£ä»»äºº
3. å¼€å§‹Week 1ä»»åŠ¡æ‰§è¡Œ
4. å»ºç«‹æ¯æ—¥ç«™ä¼šæœºåˆ¶
