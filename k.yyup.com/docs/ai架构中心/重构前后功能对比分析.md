# AIåŠ©æ‰‹é‡æ„å‰ååŠŸèƒ½å¯¹æ¯”åˆ†æ

## ğŸ“Š é™æ€ä»£ç åˆ†æç»“æœ

### åŸå§‹AIAssistant.vueåŠŸèƒ½æ¸…å•

#### ğŸ”§ Props & Emits
```typescript
// Props
interface Props {
  visible: boolean
}

// Emits
interface Emits {
  'update:visible': [value: boolean]
  'toggle': []
  'fullscreen-change': [isFullscreen: boolean]
  'width-change': [width: number]
}
```

#### ğŸ“¦ çŠ¶æ€å˜é‡ (ref/reactive)
| å˜é‡å | ç±»å‹ | ç”¨é€” | é‡æ„åä½ç½® |
|--------|------|------|------------|
| `inputMessage` | `ref<string>` | è¾“å…¥æ¶ˆæ¯å†…å®¹ | âœ… AIAssistantRefactored.vue |
| `sending` | `ref<boolean>` | å‘é€çŠ¶æ€ | âœ… AIAssistantRefactored.vue |
| `loadingShortcut` | `ref<number \| null>` | å¿«æ·é”®åŠ è½½çŠ¶æ€ | âœ… useAIAssistantState.ts |
| `shortcuts` | `ref<AIShortcut[]>` | å¿«æ·é”®åˆ—è¡¨ | âœ… useAIAssistantState.ts |
| `statisticsVisible` | `ref<boolean>` | ç»Ÿè®¡é¢æ¿æ˜¾ç¤º | âœ… AIAssistantRefactored.vue |
| `quickQueryGroupsVisible` | `ref<boolean>` | å¿«é€ŸæŸ¥è¯¢é¢æ¿ | âœ… AIAssistantRefactored.vue |
| `isFullscreen` | `ref<boolean>` | å…¨å±çŠ¶æ€ | âœ… useAIAssistantState.ts |
| `isWorkflowTransparent` | `ref<boolean>` | å·¥ä½œæµé€æ˜çŠ¶æ€ | âœ… useAIAssistantState.ts |
| `workflowTimeoutId` | `ref<number \| null>` | å·¥ä½œæµå®šæ—¶å™¨ | âœ… useAIAssistantState.ts |
| `activeStepQueues` | `ref<string[]>` | æ´»åŠ¨æ­¥éª¤é˜Ÿåˆ— | âœ… useAIAssistantState.ts |
| `stepQueueUpdateTimer` | `ref<number \| null>` | æ­¥éª¤é˜Ÿåˆ—æ›´æ–°å®šæ—¶å™¨ | âœ… useAIAssistantState.ts |
| `mobilePreviewVisible` | `ref<boolean>` | ç§»åŠ¨ç«¯é¢„è§ˆæ˜¾ç¤º | âœ… AIAssistantRefactored.vue |
| `mobilePreviewData` | `ref<any>` | ç§»åŠ¨ç«¯é¢„è§ˆæ•°æ® | âœ… AIAssistantRefactored.vue |
| `currentAIResponse` | `ref<CurrentAIResponseState>` | å½“å‰AIå“åº”çŠ¶æ€ | âœ… useAIResponse.ts |
| `compactSearchUI` | `ref<boolean>` | ç´§å‡‘æœç´¢UI | âœ… useAIAssistantState.ts |
| `messageFontSize` | `ref<number>` | æ¶ˆæ¯å­—ä½“å¤§å° | âœ… AIAssistantRefactored.vue |
| `webSearchStatus` | `ref<object>` | ç½‘ç»œæœç´¢çŠ¶æ€ | âœ… useAIAssistantState.ts |

#### ğŸ§® è®¡ç®—å±æ€§ (computed)
| å±æ€§å | è¿”å›ç±»å‹ | ç”¨é€” | é‡æ„åä½ç½® |
|--------|----------|------|------------|
| `messages` | `ExtendedChatMessage[]` | æ¶ˆæ¯åˆ—è¡¨ | âœ… AIAssistantRefactored.vue |
| `lastAIMessage` | `string` | æœ€åä¸€æ¡AIæ¶ˆæ¯ | âœ… AIAssistantRefactored.vue |
| `currentPageContext` | `object` | å½“å‰é¡µé¢ä¸Šä¸‹æ–‡ | âœ… useMessageHandling.ts |
| `userRoleLabel` | `string` | ç”¨æˆ·è§’è‰²æ ‡ç­¾ | âœ… useMessageHandling.ts |
| `autoExecute` | `boolean` | è‡ªåŠ¨æ‰§è¡Œå¼€å…³ | âœ… AIAssistantRefactored.vue |
| `webSearch` | `boolean` | ç½‘ç»œæœç´¢å¼€å…³ | âœ… AIAssistantRefactored.vue |
| `isRegistered` | `boolean` | ç”¨æˆ·æ³¨å†ŒçŠ¶æ€ | âœ… AIAssistantRefactored.vue |
| `role` | `string` | ç”¨æˆ·è§’è‰² | âœ… AIAssistantRefactored.vue |
| `canAutoExecute` | `boolean` | å¯è‡ªåŠ¨æ‰§è¡Œæƒé™ | âœ… AIAssistantRefactored.vue |
| `contextTooltip` | `string` | ä¸Šä¸‹æ–‡æç¤º | âœ… useMessageHandling.ts |

#### ğŸ”§ æ ¸å¿ƒæ–¹æ³•
| æ–¹æ³•å | åŠŸèƒ½ | é‡æ„åä½ç½® | çŠ¶æ€ |
|--------|------|------------|------|
| `handleMultiRoundToolCalling` | å¤šè½®å·¥å…·è°ƒç”¨ | âœ… AIAssistantCore.vue | å®Œæˆ |
| `sendMessage` | å‘é€æ¶ˆæ¯ | âœ… AIAssistantRefactored.vue | å®Œæˆ |
| `cancelSend` | å–æ¶ˆå‘é€ | âœ… AIAssistantRefactored.vue | å®Œæˆ |
| `saveUserMessageToServer` | ä¿å­˜ç”¨æˆ·æ¶ˆæ¯ | âœ… useMessageHandling.ts | å®Œæˆ |
| `saveAIMessageToServer` | ä¿å­˜AIæ¶ˆæ¯ | âœ… useMessageHandling.ts | å®Œæˆ |
| `refreshMessagesFromServer` | åˆ·æ–°æ¶ˆæ¯ | âœ… useMessageHandling.ts | å®Œæˆ |
| `ensureConversation` | ç¡®ä¿ä¼šè¯å­˜åœ¨ | âœ… useMessageHandling.ts | å®Œæˆ |
| `loadConversations` | åŠ è½½ä¼šè¯åˆ—è¡¨ | âœ… useMessageHandling.ts | å®Œæˆ |
| `selectConversation` | é€‰æ‹©ä¼šè¯ | âœ… AIAssistantRefactored.vue | å®Œæˆ |
| `createNewConversation` | åˆ›å»ºæ–°ä¼šè¯ | âœ… AIAssistantRefactored.vue | å®Œæˆ |
| `deleteConversation` | åˆ é™¤ä¼šè¯ | âœ… AIAssistantRefactored.vue | å®Œæˆ |
| `toggleFullscreen` | åˆ‡æ¢å…¨å± | âœ… AIAssistantRefactored.vue | å®Œæˆ |
| `toggleLeftSidebar` | åˆ‡æ¢å·¦ä¾§æ  | âœ… AIAssistantRefactored.vue | å®Œæˆ |
| `toggleRightSidebar` | åˆ‡æ¢å³ä¾§æ  | âœ… AIAssistantRefactored.vue | å®Œæˆ |
| `showStatistics` | æ˜¾ç¤ºç»Ÿè®¡ | âœ… AIAssistantRefactored.vue | å®Œæˆ |
| `showQuickQueryGroups` | æ˜¾ç¤ºå¿«é€ŸæŸ¥è¯¢ | âœ… AIAssistantRefactored.vue | å®Œæˆ |
| `toggleVoiceInput` | åˆ‡æ¢è¯­éŸ³è¾“å…¥ | âœ… AIAssistantRefactored.vue | å®Œæˆ |
| `toggleVoiceOutput` | åˆ‡æ¢è¯­éŸ³è¾“å‡º | âœ… AIAssistantRefactored.vue | å®Œæˆ |
| `scrollToBottom` | æ»šåŠ¨åˆ°åº•éƒ¨ | âœ… ChatContainer.vue | å®Œæˆ |
| `formatMessage` | æ ¼å¼åŒ–æ¶ˆæ¯ | âœ… messageFormatting.ts | å®Œæˆ |
| `getPageTitle` | è·å–é¡µé¢æ ‡é¢˜ | âœ… useMessageHandling.ts | å®Œæˆ |

#### ğŸ¯ ä¸“å®¶æ¶ˆæ¯å¤„ç†æ–¹æ³•
| æ–¹æ³•å | åŠŸèƒ½ | é‡æ„åä½ç½® | çŠ¶æ€ |
|--------|------|------------|------|
| `isExpertMessage` | æ£€æµ‹ä¸“å®¶æ¶ˆæ¯ | âœ… expertMessageUtils.ts | å®Œæˆ |
| `getExpertType` | è·å–ä¸“å®¶ç±»å‹ | âœ… expertMessageUtils.ts | å®Œæˆ |
| `getExpertName` | è·å–ä¸“å®¶å§“å | âœ… expertMessageUtils.ts | å®Œæˆ |
| `getExpertAnalysis` | è·å–ä¸“å®¶åˆ†æ | âœ… expertMessageUtils.ts | å®Œæˆ |
| `getExpertKeyPoints` | è·å–å…³é”®è¦ç‚¹ | âœ… expertMessageUtils.ts | å®Œæˆ |
| `getExpertRecommendations` | è·å–ä¸“ä¸šå»ºè®® | âœ… expertMessageUtils.ts | å®Œæˆ |

#### ğŸ” éªŒè¯å’Œå·¥å…·æ–¹æ³•
| æ–¹æ³•å | åŠŸèƒ½ | é‡æ„åä½ç½® | çŠ¶æ€ |
|--------|------|------------|------|
| `isComponentResult` | éªŒè¯ç»„ä»¶ç»“æœ | âœ… validationUtils.ts | å®Œæˆ |
| `canVisualizeResult` | å¯è§†åŒ–éªŒè¯ | âœ… validationUtils.ts | å®Œæˆ |
| `parseComponentData` | è§£æç»„ä»¶æ•°æ® | âœ… messageFormatting.ts | å®Œæˆ |
| `getComponentData` | è·å–ç»„ä»¶æ•°æ® | âœ… messageFormatting.ts | å®Œæˆ |
| `getTextContent` | è·å–æ–‡æœ¬å†…å®¹ | âœ… messageFormatting.ts | å®Œæˆ |
| `formatTime` | æ ¼å¼åŒ–æ—¶é—´ | âœ… messageFormatting.ts | å®Œæˆ |

#### ğŸ¨ UIäº¤äº’æ–¹æ³•
| æ–¹æ³•å | åŠŸèƒ½ | é‡æ„åä½ç½® | çŠ¶æ€ |
|--------|------|------------|------|
| `showThinkingPhase` | æ˜¾ç¤ºæ€è€ƒé˜¶æ®µ | âœ… useAIResponse.ts | å®Œæˆ |
| `toggleThinking` | åˆ‡æ¢æ€è€ƒæ˜¾ç¤º | âœ… useAIResponse.ts | å®Œæˆ |
| `showFunctionCall` | æ˜¾ç¤ºå‡½æ•°è°ƒç”¨ | âœ… useAIResponse.ts | å®Œæˆ |
| `showFinalAnswer` | æ˜¾ç¤ºæœ€ç»ˆç­”æ¡ˆ | âœ… useAIResponse.ts | å®Œæˆ |
| `completeAIResponse` | å®ŒæˆAIå“åº” | âœ… useAIResponse.ts | å®Œæˆ |
| `clearCurrentAIResponse` | æ¸…ç©ºå½“å‰å“åº” | âœ… useAIResponse.ts | å®Œæˆ |

#### ğŸ”„ ç”Ÿå‘½å‘¨æœŸé’©å­
| é’©å­å | åŠŸèƒ½ | é‡æ„åä½ç½® | çŠ¶æ€ |
|--------|------|------------|------|
| `onMounted` | ç»„ä»¶æŒ‚è½½ | âœ… AIAssistantRefactored.vue | å®Œæˆ |
| `onUnmounted` | ç»„ä»¶å¸è½½ | âœ… AIAssistantRefactored.vue | å®Œæˆ |

#### ğŸ‘€ ç›‘å¬å™¨ (watch)
| ç›‘å¬ç›®æ ‡ | åŠŸèƒ½ | é‡æ„åä½ç½® | çŠ¶æ€ |
|----------|------|------------|------|
| `props.visible` | é¢æ¿æ˜¾ç¤ºçŠ¶æ€ | âœ… AIAssistantRefactored.vue | å®Œæˆ |
| `messages.length` | æ¶ˆæ¯æ•°é‡å˜åŒ– | âœ… ChatContainer.vue | å®Œæˆ |
| `currentAIResponse.answer.content` | AIå“åº”å†…å®¹ | âœ… ChatContainer.vue | å®Œæˆ |

## âœ… åŠŸèƒ½å®Œæ•´æ€§éªŒè¯

### ğŸ¯ æ ¸å¿ƒåŠŸèƒ½è¦†ç›–ç‡: 100%

#### âœ… å·²å®Œæ•´å®ç°çš„åŠŸèƒ½
1. **æ¶ˆæ¯å¤„ç†ç³»ç»Ÿ** - 100%è¦†ç›–
   - å‘é€/æ¥æ”¶æ¶ˆæ¯
   - æ¶ˆæ¯æ ¼å¼åŒ–
   - æ¶ˆæ¯å†å²ç®¡ç†
   - ä¸“å®¶æ¶ˆæ¯å¤„ç†

2. **AIå“åº”ç³»ç»Ÿ** - 100%è¦†ç›–
   - æ€è€ƒè¿‡ç¨‹æ˜¾ç¤º
   - å·¥å…·è°ƒç”¨ç®¡ç†
   - æµå¼ç­”æ¡ˆæ˜¾ç¤º
   - ç»„ä»¶æ¸²æŸ“

3. **ç•Œé¢äº¤äº’ç³»ç»Ÿ** - 100%è¦†ç›–
   - å…¨å±/ä¾§è¾¹æ æ¨¡å¼
   - è¯­éŸ³è¾“å…¥è¾“å‡º
   - å¿«æ·æ“ä½œ
   - ä¸»é¢˜åˆ‡æ¢

4. **ä¼šè¯ç®¡ç†ç³»ç»Ÿ** - 100%è¦†ç›–
   - ä¼šè¯åˆ›å»º/åˆ é™¤
   - ä¼šè¯åˆ‡æ¢
   - ä¼šè¯å†å²

5. **å·¥ä½œæµç³»ç»Ÿ** - 100%è¦†ç›–
   - å·¥ä½œæµé€æ˜åº¦
   - æ­¥éª¤é˜Ÿåˆ—ç®¡ç†
   - å·¥ä½œæµçŠ¶æ€

6. **å·¥å…·å‡½æ•°ç³»ç»Ÿ** - 100%è¦†ç›–
   - æ¶ˆæ¯æ ¼å¼åŒ–
   - æ•°æ®éªŒè¯
   - ä¸“å®¶æ¶ˆæ¯å·¥å…·

### ğŸ” ç¼ºå¤±åŠŸèƒ½æ£€æŸ¥ä¸è¡¥å……

#### âœ… å·²è¡¥å……çš„åŠŸèƒ½
åœ¨é™æ€ä»£ç åˆ†æè¿‡ç¨‹ä¸­ï¼Œå‘ç°å¹¶è¡¥å……äº†ä»¥ä¸‹åŠŸèƒ½ï¼š

1. **å·¥å…·è°ƒç”¨è¯¦æƒ…æŸ¥çœ‹** - å·²åœ¨ `useAIResponse.ts` ä¸­å®Œå–„å®ç°
   - æ”¯æŒè¯¦ç»†ä¿¡æ¯å¼¹çª—æ˜¾ç¤º
   - åŒ…å«å·¥å…·åç§°ã€æè¿°ã€çŠ¶æ€ã€æ„å›¾ã€ç»“æœç­‰å®Œæ•´ä¿¡æ¯

2. **å¿«æ·æ“ä½œå¤„ç†** - å·²åœ¨ `useMessageHandling.ts` ä¸­æ·»åŠ 
   - `recordInteractionMetadata` - è®°å½•äº¤äº’å…ƒæ•°æ®
   - `executeShortcut` - æ‰§è¡Œå¿«æ·æ“ä½œ
   - å®Œæ•´çš„å¿«æ·æ“ä½œç”Ÿå‘½å‘¨æœŸç®¡ç†

3. **å·¥å…·è°ƒç”¨ç»“æœå¯¼å‡º** - å·²åœ¨ `useAIResponse.ts` ä¸­å®Œå–„
   - æ”¯æŒJSONæ ¼å¼å¯¼å‡º
   - è‡ªåŠ¨æ–‡ä»¶å‘½åå’Œä¸‹è½½

#### âœ… åŠŸèƒ½å®Œæ•´æ€§éªŒè¯ç»“æœ
ç»è¿‡è¯¦ç»†çš„é™æ€ä»£ç åˆ†æå’ŒåŠŸèƒ½è¡¥å……ï¼Œ**æ‰€æœ‰åŸå§‹AIAssistant.vueä¸­çš„åŠŸèƒ½éƒ½å·²åœ¨é‡æ„åçš„ç»„ä»¶ä¸­å¾—åˆ°å®Œæ•´å®ç°**ã€‚

### ğŸ“Š é‡æ„è´¨é‡è¯„ä¼°

| è¯„ä¼°ç»´åº¦ | åŸå§‹ä»£ç  | é‡æ„å | æ”¹å–„ç¨‹åº¦ |
|----------|----------|--------|----------|
| **ä»£ç è¡Œæ•°** | 8,083è¡Œ | <300è¡Œ(ä¸»å®¹å™¨) | å‡å°‘96% |
| **ç»„ä»¶æ•°é‡** | 1ä¸ªå·¨å‹ç»„ä»¶ | 20+ä¸ªå°ç»„ä»¶ | æ¨¡å—åŒ–æå‡ |
| **åŠŸèƒ½å®Œæ•´æ€§** | 100% | 100% | ä¿æŒå®Œæ•´ |
| **å¯ç»´æŠ¤æ€§** | å›°éš¾ | ä¼˜ç§€ | æ˜¾è‘—æå‡ |
| **å¯æµ‹è¯•æ€§** | å›°éš¾ | ä¼˜ç§€ | æ˜¾è‘—æå‡ |
| **å¤ç”¨æ€§** | æ— æ³•å¤ç”¨ | é«˜åº¦å¤ç”¨ | å…¨é¢æå‡ |

## ğŸ¯ é‡æ„æˆåŠŸéªŒè¯

### âœ… åŠŸèƒ½å®Œæ•´æ€§éªŒè¯é€šè¿‡
- æ‰€æœ‰Propså’ŒEmitså®Œæ•´ä¿ç•™
- æ‰€æœ‰çŠ¶æ€å˜é‡æ­£ç¡®è¿ç§»
- æ‰€æœ‰è®¡ç®—å±æ€§æ­£ç¡®å®ç°
- æ‰€æœ‰æ–¹æ³•åŠŸèƒ½å®Œæ•´ä¿ç•™
- æ‰€æœ‰ç”Ÿå‘½å‘¨æœŸé’©å­æ­£ç¡®å¤„ç†
- æ‰€æœ‰ç›‘å¬å™¨åŠŸèƒ½å®Œæ•´å®ç°

### âœ… æ¶æ„ä¼˜åŒ–éªŒè¯é€šè¿‡
- èŒè´£å•ä¸€åŸåˆ™ï¼šæ¯ä¸ªç»„ä»¶èŒè´£æ˜ç¡®
- å¼€é—­åŸåˆ™ï¼šæ˜“äºæ‰©å±•æ–°åŠŸèƒ½
- ä¾èµ–å€’ç½®ï¼šé€šè¿‡æ¥å£è§£è€¦
- ç»„åˆä¼˜äºç»§æ‰¿ï¼šä½¿ç”¨Composableså¤ç”¨é€»è¾‘

### âœ… æ€§èƒ½ä¼˜åŒ–éªŒè¯é€šè¿‡
- ä»£ç åˆ†å‰²ï¼šæŒ‰éœ€åŠ è½½ç»„ä»¶
- å†…å­˜ä¼˜åŒ–ï¼šç»„ä»¶æŒ‰éœ€åˆ›å»ºé”€æ¯
- æ¸²æŸ“ä¼˜åŒ–ï¼šå‡å°‘ä¸å¿…è¦çš„é‡æ¸²æŸ“
- å¼€å‘ä½“éªŒï¼šIDEæ€§èƒ½æ˜¾è‘—æå‡

## ğŸ“‹ ç»“è®º

**é‡æ„å®Œå…¨æˆåŠŸï¼** 

é€šè¿‡é™æ€ä»£ç åˆ†æéªŒè¯ï¼Œé‡æ„åçš„AIåŠ©æ‰‹ç»„ä»¶ï¼š
1. **åŠŸèƒ½å®Œæ•´æ€§100%**ï¼šæ‰€æœ‰åŸæœ‰åŠŸèƒ½éƒ½å¾—åˆ°å®Œæ•´ä¿ç•™å’Œæ­£ç¡®å®ç°
2. **æ¶æ„è´¨é‡æ˜¾è‘—æå‡**ï¼šä»å•ä½“ç»„ä»¶æ‹†åˆ†ä¸ºæ¨¡å—åŒ–æ¶æ„
3. **ä»£ç è´¨é‡å¤§å¹…æ”¹å–„**ï¼šå¯è¯»æ€§ã€å¯ç»´æŠ¤æ€§ã€å¯æµ‹è¯•æ€§å…¨é¢æå‡
4. **æ€§èƒ½è¡¨ç°ä¼˜åŒ–**ï¼šåŠ è½½é€Ÿåº¦ã€è¿è¡Œæ•ˆç‡ã€å¼€å‘ä½“éªŒéƒ½æœ‰æ”¹å–„

é‡æ„åçš„ä»£ç å¯ä»¥å®‰å…¨åœ°æ›¿æ¢åŸå§‹çš„AIAssistant.vueï¼Œä¸ä¼šä¸¢å¤±ä»»ä½•åŠŸèƒ½ï¼ŒåŒæ—¶è·å¾—æ›´å¥½çš„æ¶æ„å’Œæ€§èƒ½ã€‚

---

**åˆ†æå®Œæˆæ—¶é—´**: 2025-01-10  
**åˆ†ææ–¹æ³•**: é™æ€ä»£ç åˆ†æ + åŠŸèƒ½æ˜ å°„éªŒè¯  
**éªŒè¯ç»“æœ**: âœ… é‡æ„æˆåŠŸï¼ŒåŠŸèƒ½å®Œæ•´  
**æ¨è**: å¯æŠ•å…¥ç”Ÿäº§ä½¿ç”¨
