# è±†åŒ…ç«¯åˆ°ç«¯å®æ—¶è¯­éŸ³å¤§æ¨¡å‹æµ‹è¯•æŠ¥å‘Š

**æµ‹è¯•æ—¶é—´**: 2025-10-14  
**æµ‹è¯•äººå‘˜**: AI Assistant  
**æä¾›çš„å‡­è¯**:
- App ID: `7563592522`
- API Key: `e1545f0e-1d6f-4e70-aab3-3c5fdbec0700`

---

## ğŸ“‹ æµ‹è¯•æ€»ç»“

### âœ… **æˆåŠŸçš„æµ‹è¯•**

#### 1. APIå‡­è¯éªŒè¯ - âœ… é€šè¿‡

**æµ‹è¯•æ–¹æ³•**: è°ƒç”¨è±†åŒ…æ–‡æœ¬å¯¹è¯API  
**ç«¯ç‚¹**: `https://ark.cn-beijing.volces.com/api/v3/chat/completions`  
**ç»“æœ**: **æˆåŠŸ**

```json
{
  "choices": [
    {
      "message": {
        "content": "ä½ å¥½å‘€ï¼å¾ˆé«˜å…´è§åˆ°ä½ ~ æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®ä½ çš„å—ï¼ŸğŸ˜Š"
      }
    }
  ],
  "model": "doubao-seed-1-6-flash-250715",
  "usage": {
    "total_tokens": 195
  }
}
```

**ç»“è®º**: âœ… **API Key `e1545f0e-1d6f-4e70-aab3-3c5fdbec0700` æ˜¯æœ‰æ•ˆçš„**

---

### âŒ **å¤±è´¥çš„æµ‹è¯•**

#### 2. å®æ—¶è¯­éŸ³WebSocketè¿æ¥ - âŒ å¤±è´¥

**æµ‹è¯•æ–¹æ³•**: è¿æ¥è±†åŒ…å®æ—¶è¯­éŸ³WebSocket  
**ç«¯ç‚¹**: `wss://openspeech.bytedance.com/api/v3/realtime/dialogue`  
**è¯·æ±‚å¤´**:
```
X-Api-App-Key: e1545f0e-1d6f-4e70-aab3-3c5fdbec0700
X-Api-Resource-Id: volc.speech.dialog
```

**é”™è¯¯**: `Unexpected server response: 400`

**å°è¯•çš„è®¤è¯æ–¹å¼**:
1. âŒ è¯·æ±‚å¤´: `X-Api-App-Key` + `X-Api-Resource-Id`
2. âŒ è¯·æ±‚å¤´: `Authorization: Bearer {apiKey}` + `Resource-Id`
3. âŒ URLæŸ¥è¯¢å‚æ•°: `?appid={appId}&token={apiKey}&resource_id=...`

**ç»“è®º**: âŒ **æ‰€æœ‰WebSocketè®¤è¯æ–¹å¼éƒ½è¿”å›400é”™è¯¯**

---

#### 3. TTS WebSocketè¿æ¥ - âŒ å¤±è´¥

**æµ‹è¯•æ–¹æ³•**: ä½¿ç”¨æ•°æ®åº“ä¸­å·²æœ‰çš„TTSé…ç½®è¿æ¥WebSocket  
**ç«¯ç‚¹**: `wss://openspeech.bytedance.com/api/v3/tts/unidirectional/stream`  
**API Key**: `3251d95f-1039-4daa-9afa-eb3bfe345552` (æ•°æ®åº“ä¸­çš„é…ç½®)  
**è¯·æ±‚å¤´**:
```
X-Api-App-Key: 3251d95f-1039-4daa-9afa-eb3bfe345552
X-Api-Resource-Id: volc.service_type.10029
```

**é”™è¯¯**: `Unexpected server response: 400`

**ç»“è®º**: âŒ **å³ä½¿æ˜¯æ•°æ®åº“ä¸­å·²æœ‰çš„TTSé…ç½®ä¹Ÿæ— æ³•è¿æ¥WebSocket**

---

## ğŸ” é—®é¢˜åˆ†æ

### å¯èƒ½çš„åŸå› 

#### 1. **WebSocketè®¤è¯æ–¹å¼ä¸æ­£ç¡®**

ç«å±±å¼•æ“çš„WebSocket APIå¯èƒ½éœ€è¦ï¼š
- âœ… **ä¸´æ—¶Token** - éœ€è¦å…ˆè°ƒç”¨HTTP APIç”Ÿæˆä¸´æ—¶Token
- âœ… **ç­¾åè®¤è¯** - éœ€è¦ä½¿ç”¨AppID + AppKey + æ—¶é—´æˆ³ç”Ÿæˆç­¾å
- âœ… **RTC Token** - éœ€è¦ä½¿ç”¨RTCæœåŠ¡ç”ŸæˆToken

**è¯æ®**:
- æ•°æ®åº“ä¸­çš„TTSé…ç½®ä¹Ÿæ— æ³•è¿æ¥ï¼Œè¯´æ˜ä¸æ˜¯å‡­è¯é—®é¢˜
- HTTP APIè°ƒç”¨æˆåŠŸï¼Œè¯´æ˜API Keyæœ¬èº«æ˜¯æœ‰æ•ˆçš„
- æ‰€æœ‰WebSocketè¿æ¥éƒ½è¿”å›400ï¼Œè¯´æ˜è®¤è¯æ–¹å¼ä¸å¯¹

#### 2. **App IDç”¨é€”ä¸åŒ¹é…**

æä¾›çš„ `App ID: 7563592522` å¯èƒ½æ˜¯ï¼š
- âœ… ç”¨äºHTTP APIï¼ˆæ–‡æœ¬å¯¹è¯ã€å›¾åƒç”Ÿæˆç­‰ï¼‰
- âŒ **ä¸æ˜¯**ç”¨äºWebSocketå®æ—¶è¯­éŸ³æœåŠ¡

**éœ€è¦ç¡®è®¤**:
- è¿™ä¸ªApp IDæ˜¯å¦å¼€é€šäº†å®æ—¶è¯­éŸ³æœåŠ¡æƒé™
- æ˜¯å¦éœ€è¦å•ç‹¬åˆ›å»ºå®æ—¶è¯­éŸ³åº”ç”¨

#### 3. **ç¼ºå°‘å¿…è¦çš„SDKæˆ–åº“**

ç«å±±å¼•æ“å¯èƒ½è¦æ±‚ï¼š
- ä½¿ç”¨å®˜æ–¹SDKè¿›è¡ŒWebSocketè¿æ¥
- ä½¿ç”¨ç‰¹å®šçš„è®¤è¯åº“ç”ŸæˆToken

---

## ğŸ“ å»ºè®®çš„è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆ1: ä½¿ç”¨ç«å±±å¼•æ“å®˜æ–¹SDKï¼ˆæ¨èï¼‰

**æ­¥éª¤**:
1. å®‰è£…ç«å±±å¼•æ“Node.js SDK
   ```bash
   npm install @volcengine/openapi
   ```

2. ä½¿ç”¨SDKè¿æ¥å®æ—¶è¯­éŸ³æœåŠ¡
   ```javascript
   const { RealtimeVoiceClient } = require('@volcengine/openapi');
   
   const client = new RealtimeVoiceClient({
     appId: '7563592522',
     apiKey: 'e1545f0e-1d6f-4e70-aab3-3c5fdbec0700'
   });
   
   await client.connect();
   ```

### æ–¹æ¡ˆ2: ç”Ÿæˆä¸´æ—¶Token

**æ­¥éª¤**:
1. è°ƒç”¨ç«å±±å¼•æ“Tokenç”ŸæˆAPI
2. ä½¿ç”¨ä¸´æ—¶Tokenè¿æ¥WebSocket

**ç¤ºä¾‹**:
```javascript
// 1. ç”ŸæˆToken
const tokenResponse = await fetch('https://openspeech.bytedance.com/api/v1/token', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    appid: '7563592522',
    secret: 'e1545f0e-1d6f-4e70-aab3-3c5fdbec0700'
  })
});

const { token } = await tokenResponse.json();

// 2. ä½¿ç”¨Tokenè¿æ¥WebSocket
const ws = new WebSocket(`wss://openspeech.bytedance.com/api/v3/realtime/dialogue?token=${token}`);
```

### æ–¹æ¡ˆ3: è”ç³»ç«å±±å¼•æ“æŠ€æœ¯æ”¯æŒ

**éœ€è¦ç¡®è®¤çš„é—®é¢˜**:
1. App ID `7563592522` æ˜¯å¦å¼€é€šäº†å®æ—¶è¯­éŸ³æœåŠ¡ï¼Ÿ
2. å®æ—¶è¯­éŸ³WebSocketçš„æ­£ç¡®è®¤è¯æ–¹å¼æ˜¯ä»€ä¹ˆï¼Ÿ
3. æ˜¯å¦éœ€è¦å•ç‹¬ç”³è¯·å®æ—¶è¯­éŸ³æœåŠ¡æƒé™ï¼Ÿ
4. æ˜¯å¦æœ‰Node.jsçš„å®Œæ•´ç¤ºä¾‹ä»£ç ï¼Ÿ

---

## ğŸ¯ å½“å‰çŠ¶æ€

| åŠŸèƒ½ | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| **APIå‡­è¯** | âœ… æœ‰æ•ˆ | HTTP APIè°ƒç”¨æˆåŠŸ |
| **æ–‡æœ¬å¯¹è¯** | âœ… å¯ç”¨ | è±†åŒ…æ–‡æœ¬æ¨¡å‹å·¥ä½œæ­£å¸¸ |
| **å®æ—¶è¯­éŸ³WebSocket** | âŒ æ— æ³•è¿æ¥ | è®¤è¯æ–¹å¼ä¸æ˜ç¡® |
| **TTS WebSocket** | âŒ æ— æ³•è¿æ¥ | è®¤è¯æ–¹å¼ä¸æ˜ç¡® |

---

## ğŸ“‹ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### ç«‹å³è¡ŒåŠ¨ï¼ˆæ¨èï¼‰:

1. **æŸ¥çœ‹ç«å±±å¼•æ“æ§åˆ¶å°**
   - ç™»å½• https://console.volcengine.com
   - æ£€æŸ¥App ID `7563592522` çš„æœåŠ¡æƒé™
   - æŸ¥çœ‹æ˜¯å¦æœ‰å®æ—¶è¯­éŸ³æœåŠ¡çš„é…ç½®è¯´æ˜

2. **æŸ¥æ‰¾å®˜æ–¹ç¤ºä¾‹ä»£ç **
   - æœç´¢ç«å±±å¼•æ“å®˜æ–¹GitHubä»“åº“
   - æŸ¥æ‰¾Node.jså®æ—¶è¯­éŸ³ç¤ºä¾‹
   - å‚è€ƒå®˜æ–¹SDKæ–‡æ¡£

3. **è”ç³»æŠ€æœ¯æ”¯æŒ**
   - æä¾›App IDå’Œé”™è¯¯ä¿¡æ¯
   - è¯¢é—®æ­£ç¡®çš„WebSocketè®¤è¯æ–¹å¼
   - è·å–å®Œæ•´çš„é›†æˆæ–‡æ¡£

### ä¸´æ—¶æ–¹æ¡ˆ:

**ä½¿ç”¨åˆ†ç¦»å¼æ¶æ„ï¼ˆASR + LLM + TTSï¼‰**

è™½ç„¶ä¸æ˜¯ç«¯åˆ°ç«¯å®æ—¶è¯­éŸ³ï¼Œä½†å¯ä»¥å…ˆå®ç°åŸºæœ¬åŠŸèƒ½ï¼š

```typescript
// 1. è¯­éŸ³è¯†åˆ« (ä½¿ç”¨HTTP API)
const transcription = await fetch('https://openspeech.bytedance.com/api/v1/asr', {
  method: 'POST',
  headers: {
    'Authorization': `Bearer ${apiKey}`
  },
  body: audioData
});

// 2. æ–‡æœ¬å¯¹è¯ (å·²éªŒè¯å¯ç”¨)
const response = await fetch('https://ark.cn-beijing.volces.com/api/v3/chat/completions', {
  method: 'POST',
  headers: {
    'Authorization': `Bearer ${apiKey}`
  },
  body: JSON.stringify({
    model: 'doubao-seed-1-6-flash-250715',
    messages: [{ role: 'user', content: transcription.text }]
  })
});

// 3. è¯­éŸ³åˆæˆ (ä½¿ç”¨HTTP API)
const audio = await fetch('https://ark.cn-beijing.volces.com/api/v3/audio/speech', {
  method: 'POST',
  headers: {
    'Authorization': `Bearer ${apiKey}`
  },
  body: JSON.stringify({
    model: 'doubao-tts-bigmodel',
    input: response.choices[0].message.content
  })
});
```

---

## ğŸ‰ æ€»ç»“

### âœ… **å·²éªŒè¯**:
- API Keyæœ‰æ•ˆ
- è±†åŒ…æ–‡æœ¬å¯¹è¯APIå·¥ä½œæ­£å¸¸
- HTTP APIè®¤è¯æ–¹å¼æ­£ç¡®

### âŒ **å¾…è§£å†³**:
- WebSocketå®æ—¶è¯­éŸ³è¿æ¥å¤±è´¥
- è®¤è¯æ–¹å¼ä¸æ˜ç¡®
- éœ€è¦å®˜æ–¹æ–‡æ¡£æˆ–SDKæ”¯æŒ

### ğŸ’¡ **å»ºè®®**:
1. **ä¼˜å…ˆ**: æŸ¥çœ‹ç«å±±å¼•æ“æ§åˆ¶å°ï¼Œç¡®è®¤æœåŠ¡æƒé™
2. **æ¨è**: ä½¿ç”¨å®˜æ–¹SDKè€Œä¸æ˜¯ç›´æ¥WebSocket
3. **å¤‡é€‰**: å…ˆä½¿ç”¨åˆ†ç¦»å¼æ¶æ„ï¼ˆASR+LLM+TTSï¼‰å®ç°åŠŸèƒ½

---

**æµ‹è¯•æ–‡ä»¶**:
- âœ… `test-volcengine-auth.cjs` - APIå‡­è¯éªŒè¯ï¼ˆæˆåŠŸï¼‰
- âŒ `test-doubao-realtime-voice.cjs` - å®æ—¶è¯­éŸ³æµ‹è¯•ï¼ˆå¤±è´¥ï¼‰
- âŒ `test-tts-websocket.cjs` - TTS WebSocketæµ‹è¯•ï¼ˆå¤±è´¥ï¼‰

**æœ€åæ›´æ–°**: 2025-10-14 20:55

