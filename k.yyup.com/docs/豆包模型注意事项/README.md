# è±†åŒ…æ¨¡å‹æ³¨æ„äº‹é¡¹

## ğŸ“š æ–‡æ¡£å¯¼èˆª

æœ¬ç›®å½•åŒ…å«è±†åŒ…ï¼ˆç«å±±å¼•æ“ï¼‰AIæ¨¡å‹çš„ä½¿ç”¨æŒ‡å—ã€å¸¸è§é—®é¢˜å’Œæœ€ä½³å®è·µã€‚

---

## ğŸ“– æ–‡æ¡£åˆ—è¡¨

### 1. [TTSæ–‡å­—è½¬è¯­éŸ³æ­£ç¡®è°ƒç”¨æŒ‡å—](./TTSæ–‡å­—è½¬è¯­éŸ³æ­£ç¡®è°ƒç”¨æŒ‡å—.md)

**å†…å®¹æ¦‚è¦**:
- âœ… æ­£ç¡®çš„è°ƒç”¨æ–¹å¼
- âŒ å¸¸è§é”™è¯¯å’Œè§£å†³æ–¹æ¡ˆ
- ğŸ¤ å®Œæ•´çš„éŸ³è‰²å‚æ•°åˆ—è¡¨
- ğŸ“ å®é™…ä»£ç ç¤ºä¾‹
- ğŸ”§ æ•…éšœæ’é™¤æŒ‡å—

**é€‚ç”¨åœºæ™¯**:
- åª’ä½“ä¸­å¿ƒé…éŸ³
- è§†é¢‘åˆ¶ä½œæ—ç™½
- æ´»åŠ¨é€šçŸ¥è¯­éŸ³
- æ•™å­¦å†…å®¹é…éŸ³

**å…³é”®è¦ç‚¹**:
```typescript
// âœ… æ­£ç¡®ï¼šä½¿ç”¨ç«å±±å¼•æ“éŸ³è‰²
voice: 'zh_female_cancan_mars_bigtts'

// âŒ é”™è¯¯ï¼šä½¿ç”¨OpenAIéŸ³è‰²
voice: 'nova'
```

---

### 2. [å¸¸è§é—®é¢˜FAQ](./å¸¸è§é—®é¢˜FAQ.md)

**å†…å®¹æ¦‚è¦**:
- ğŸ” å¿«é€Ÿé—®é¢˜è¯Šæ–­
- ğŸ’¡ è§£å†³æ–¹æ¡ˆé€ŸæŸ¥
- ğŸ“Š é”™è¯¯ç å¯¹ç…§è¡¨
- âš¡ æ€§èƒ½ä¼˜åŒ–å»ºè®®

**æ¶µç›–ä¸»é¢˜**:
- TTSæ–‡å­—è½¬è¯­éŸ³ï¼ˆ16ä¸ªé—®é¢˜ï¼‰
- ASRè¯­éŸ³è¯†åˆ«ï¼ˆ2ä¸ªé—®é¢˜ï¼‰
- LLMå¯¹è¯æ¨¡å‹ï¼ˆ2ä¸ªé—®é¢˜ï¼‰
- é…ç½®é—®é¢˜ï¼ˆ3ä¸ªé—®é¢˜ï¼‰
- æ€§èƒ½ä¼˜åŒ–ï¼ˆ3ä¸ªé—®é¢˜ï¼‰

**å¿«é€ŸæŸ¥æ‰¾**:
- Q1: TTSè¿”å›0å­—èŠ‚æ€ä¹ˆåŠï¼Ÿ
- Q2: æ”¯æŒå“ªäº›éŸ³è‰²ï¼Ÿ
- Q3: å¦‚ä½•è°ƒæ•´è¯­é€Ÿï¼Ÿ
- Q6: WebSocketè¿æ¥è¶…æ—¶æ€ä¹ˆåŠï¼Ÿ

---

## ğŸš¨ é‡è¦æé†’

### TTSæ–‡å­—è½¬è¯­éŸ³

**å¿…é¡»ä½¿ç”¨ç«å±±å¼•æ“éŸ³è‰²**:
```typescript
// âœ… æ­£ç¡®çš„éŸ³è‰²å‚æ•°
const voices = [
  'zh_female_cancan_mars_bigtts',        // ç¿ç¿å¥³å£°
  'zh_female_yingyujiaoyu_mars_bigtts',  // Tinaè€å¸ˆ
  'zh_female_shaoergushi_mars_bigtts',   // å°‘å„¿æ•…äº‹
  'zh_male_tiancaitongsheng_mars_bigtts' // å¤©æ‰ç«¥å£°
]

// âŒ ä¸è¦ä½¿ç”¨OpenAIéŸ³è‰²
const wrongVoices = [
  'nova', 'alloy', 'echo', 'fable', 'onyx', 'shimmer'
]
```

**ç«¯ç‚¹é…ç½®**:
```
wss://openspeech.bytedance.com/api/v3/tts/bidirection
```

---

## ğŸ¯ å¿«é€Ÿå¼€å§‹

### 1. æ£€æŸ¥é…ç½®

```bash
# æ£€æŸ¥TTSæ¨¡å‹é…ç½®
node check-tts-config.cjs

# æ£€æŸ¥æ‰€æœ‰speechæ¨¡å‹
node check-speech-models.cjs
```

### 2. æµ‹è¯•è°ƒç”¨

```bash
# æµ‹è¯•TTS APIï¼ˆä½¿ç”¨æ­£ç¡®çš„éŸ³è‰²ï¼‰
node test-media-center-tts.cjs
```

### 3. æŸ¥çœ‹ç»“æœ

```bash
# æ’­æ”¾ç”Ÿæˆçš„éŸ³é¢‘
ffplay test-media-center-tts-output.mp3

# æ£€æŸ¥æ–‡ä»¶å¤§å°ï¼ˆåº”è¯¥ > 0ï¼‰
ls -lh test-media-center-tts-output.mp3
```

---

## ğŸ“‹ å¸¸è§é—®é¢˜é€ŸæŸ¥

### TTSè¿”å›0å­—èŠ‚

**ç—‡çŠ¶**: HTTP 200ï¼Œä½†Content-Length: 0

**åŸå› **: éŸ³è‰²å‚æ•°é”™è¯¯

**è§£å†³**: ä½¿ç”¨ç«å±±å¼•æ“éŸ³è‰²

**è¯¦è§**: [FAQ Q1](./å¸¸è§é—®é¢˜FAQ.md#q1-ttsè¿”å›0å­—èŠ‚éŸ³é¢‘æ•°æ®æ€ä¹ˆåŠ)

---

### WebSocketè¶…æ—¶

**ç—‡çŠ¶**: æ”¶åˆ°äº‹ä»¶ç  55000000ï¼Œ30ç§’è¶…æ—¶

**åŸå› **: éŸ³è‰²å‚æ•°ä¸åŒ¹é…

**è§£å†³**: æ£€æŸ¥å¹¶ä¿®æ­£éŸ³è‰²å‚æ•°

**è¯¦è§**: [FAQ Q6](./å¸¸è§é—®é¢˜FAQ.md#q6-websocketè¿æ¥è¶…æ—¶æ€ä¹ˆåŠ)

---

### éŸ³è‰²é€‰æ‹©

**æ•™è‚²åœºæ™¯æ¨è**:
- Tinaè€å¸ˆ: `zh_female_yingyujiaoyu_mars_bigtts`
- å°‘å„¿æ•…äº‹: `zh_female_shaoergushi_mars_bigtts`

**é€šç”¨åœºæ™¯æ¨è**:
- ç¿ç¿å¥³å£°: `zh_female_cancan_mars_bigtts`
- æ¸…æ–°å¥³å£°: `zh_female_qingxin_mars_bigtts`

**è¯¦è§**: [TTSæŒ‡å— - éŸ³è‰²å‚æ•°è¯´æ˜](./TTSæ–‡å­—è½¬è¯­éŸ³æ­£ç¡®è°ƒç”¨æŒ‡å—.md#éŸ³è‰²å‚æ•°è¯´æ˜)

---

## ğŸ”§ å·¥å…·è„šæœ¬

### é…ç½®æ£€æŸ¥
- `check-tts-config.cjs` - æ£€æŸ¥TTSé…ç½®
- `check-speech-models.cjs` - æ£€æŸ¥æ‰€æœ‰speechæ¨¡å‹

### é…ç½®ä¿®å¤
- `fix-tts-config.cjs` - ä¿®å¤TTSç«¯ç‚¹é…ç½®
- `fix-tts-model-type.cjs` - ä¿®å¤model_typeé…ç½®

### åŠŸèƒ½æµ‹è¯•
- `test-media-center-tts.cjs` - æµ‹è¯•TTS APIï¼ˆæ¨èï¼‰
- `test-local-tts-api.cjs` - æµ‹è¯•æœ¬åœ°TTS API
- `test-tts-direct.cjs` - ç›´æ¥æµ‹è¯•V3 WebSocket

---

## ğŸ“Š æ•°æ®åº“é…ç½®

### æ­£ç¡®çš„TTSæ¨¡å‹é…ç½®

```sql
SELECT 
  id, name, model_type, status, endpoint_url
FROM ai_model_config
WHERE name = 'doubao-tts-bigmodel';

-- æœŸæœ›ç»“æœ:
-- id: 48
-- name: doubao-tts-bigmodel
-- model_type: speech
-- status: active
-- endpoint_url: wss://openspeech.bytedance.com/api/v3/tts/bidirection
```

### æ¨¡å‹å‚æ•°

```json
{
  "appKey": "7563592522",
  "accessKey": "jq3vA4Ep5EsN-FU4mKizV6ePioXR3Ol3",
  "resourceId": "volc.service_type.10029",
  "speaker": "zh_female_cancan_mars_bigtts",
  "sampleRate": 24000,
  "format": "mp3"
}
```

---

## ğŸ’¡ æœ€ä½³å®è·µ

### âœ… æ¨èåšæ³•

1. **ä½¿ç”¨æ­£ç¡®çš„éŸ³è‰²å‚æ•°**
   ```typescript
   voice: 'zh_female_cancan_mars_bigtts'
   ```

2. **è®¾ç½®responseTypeä¸ºblob**
   ```typescript
   responseType: 'blob'
   ```

3. **é™åˆ¶æ–‡æœ¬é•¿åº¦**
   ```typescript
   text: text.substring(0, 4096)
   ```

4. **å¤„ç†é”™è¯¯**
   ```typescript
   try {
     const audio = await generateSpeech(text)
   } catch (error) {
     console.error('TTSå¤±è´¥:', error)
   }
   ```

### âŒ é¿å…çš„åšæ³•

1. **ä¸è¦ä½¿ç”¨OpenAIéŸ³è‰²**
   ```typescript
   voice: 'nova'  // âŒ é”™è¯¯
   ```

2. **ä¸è¦å¿˜è®°responseType**
   ```typescript
   // âŒ ç¼ºå°‘responseType
   await request.post('/ai/text-to-speech', params)
   ```

3. **ä¸è¦ä½¿ç”¨è¿‡é•¿æ–‡æœ¬**
   ```typescript
   text: longText  // âŒ å¯èƒ½è¶…è¿‡4096å­—ç¬¦
   ```

---

## ğŸ” æ•…éšœæ’é™¤æµç¨‹

```
1. æ£€æŸ¥éŸ³è‰²å‚æ•°
   â†“
2. æ£€æŸ¥responseType
   â†“
3. æ£€æŸ¥æ–‡æœ¬é•¿åº¦
   â†“
4. æ£€æŸ¥æ•°æ®åº“é…ç½®
   â†“
5. æŸ¥çœ‹åç«¯æ—¥å¿—
   â†“
6. è¿è¡Œæµ‹è¯•è„šæœ¬
   â†“
7. å‚è€ƒFAQæ–‡æ¡£
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

### é¡¹ç›®æ–‡æ¡£
- [TTSè¿”å›0å­—èŠ‚é—®é¢˜è§£å†³æ–¹æ¡ˆ](../å‘¼å«ä¸­å¿ƒ/TTSè¿”å›0å­—èŠ‚é—®é¢˜è§£å†³æ–¹æ¡ˆ.md)
- [ç«å±±å¼•æ“TTS V3åè®®](../å‘¼å«ä¸­å¿ƒ/ç«å±±å¼•æ“TTS_V3åŒå‘æµå¼åè®®.md)

### å®˜æ–¹æ–‡æ¡£
- [ç«å±±å¼•æ“TTSæ–‡æ¡£](https://www.volcengine.com/docs/6561/79820)
- [ç«å±±å¼•æ“ASRæ–‡æ¡£](https://www.volcengine.com/docs/6561/79818)

---

## ğŸ†˜ è·å–å¸®åŠ©

### é—®é¢˜è¯Šæ–­

1. **æŸ¥çœ‹FAQ**: [å¸¸è§é—®é¢˜FAQ](./å¸¸è§é—®é¢˜FAQ.md)
2. **è¿è¡Œæµ‹è¯•**: `node test-media-center-tts.cjs`
3. **æ£€æŸ¥æ—¥å¿—**: æŸ¥çœ‹åç«¯æ§åˆ¶å°è¾“å‡º
4. **å‚è€ƒæ–‡æ¡£**: [TTSæ­£ç¡®è°ƒç”¨æŒ‡å—](./TTSæ–‡å­—è½¬è¯­éŸ³æ­£ç¡®è°ƒç”¨æŒ‡å—.md)

### è”ç³»æ”¯æŒ

- æŠ€æœ¯æ–‡æ¡£: æœ¬ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡æ¡£
- æµ‹è¯•è„šæœ¬: é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ `test-*.cjs` æ–‡ä»¶
- åç«¯æ—¥å¿—: `server/logs/app.log`

---

## ğŸ“ æ›´æ–°æ—¥å¿—

### 2025-10-14
- âœ… åˆ›å»ºTTSæ–‡å­—è½¬è¯­éŸ³æ­£ç¡®è°ƒç”¨æŒ‡å—
- âœ… åˆ›å»ºå¸¸è§é—®é¢˜FAQ
- âœ… è§£å†³TTSè¿”å›0å­—èŠ‚é—®é¢˜
- âœ… éªŒè¯ç«å±±å¼•æ“éŸ³è‰²å‚æ•°

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0  
**åˆ›å»ºæ—¶é—´**: 2025-10-14  
**æœ€åæ›´æ–°**: 2025-10-14  
**ç»´æŠ¤è€…**: å¼€å‘å›¢é˜Ÿ

