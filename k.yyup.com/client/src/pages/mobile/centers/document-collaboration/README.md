# 移动端文档协作页面

## 功能概述

移动端文档协作页面是PC端 `DocumentCollaboration.vue` 的移动端版本，严格按照1:1复制原则，实现了完整的文档协作功能。

## 访问地址

```
http://localhost:5173/mobile/centers/document-collaboration
```

## 主要功能

### 1. 文档列表展示
- ✅ 搜索文档标题
- ✅ 状态筛选（草稿、填写中、审核中、已通过、已拒绝、已完成）
- ✅ 下拉刷新
- ✅ 无限滚动加载
- ✅ 分页控制
- ✅ 文档进度显示
- ✅ 点击进入详情

### 2. 文档详情和协作
- ✅ 文档基本信息展示
- ✅ 进度可视化（圆形进度条）
- ✅ 元数据信息展示
- ✅ 下拉刷新

### 3. 协作管理功能
- ✅ 文档分配（选择用户、设置截止时间、添加备注）
- ✅ 提交审核（选择审核人、添加说明）
- ✅ 审核文档（通过/拒绝、审核意见）
- ✅ 权限控制（所有者/管理员可分配，100%进度可提交，审核中状态可审核）

### 4. 评论讨论系统
- ✅ 评论列表展示
- ✅ 用户头像和名称显示
- ✅ 时间戳格式化
- ✅ 添加新评论
- ✅ 评论计数徽章

### 5. 版本历史管理
- ✅ 版本时间线展示
- ✅ 版本信息查看
- ✅ 版本恢复功能
- ✅ 创建新版本
- ✅ 版本计数徽章

## 技术特性

### 移动端优化
- ✅ 响应式设计，适配各种屏幕尺寸
- ✅ 触摸友好的交互设计
- ✅ 下拉刷新和无限滚动
- ✅ 移动端弹窗和选择器
- ✅ 触摸反馈和加载状态

### UI组件
- 使用 Vant 4 组件库
- RoleBasedMobileLayout 布局组件
- 响应式卡片设计
- 移动端友好的表单设计

### API集成
- 完整的 document-instances API 集成
- 用户管理 API 集成
- 错误处理和状态管理
- 加载状态反馈

## 页面结构

```
/mobile/centers/document-collaboration/
├── index.vue                 # 主页面组件
├── __tests__/
│   └── index.test.ts         # 单元测试
└── README.md                 # 说明文档
```

## 路由配置

已在 `mobile-routes.ts` 中添加：

```typescript
{
  path: '/mobile/centers/document-collaboration',
  name: 'MobileDocumentCollaboration',
  component: () => import('../pages/mobile/centers/document-collaboration/index.vue'),
  meta: {
    title: '文档协作',
    requiresAuth: true,
    role: ['admin', 'principal', 'teacher']
  }
}
```

## 功能对比

| 功能 | PC端 | 移动端 | 说明 |
|------|------|--------|------|
| 文档列表 | ✅ | ✅ | 移动端优化为卡片布局 |
| 文档详情 | ✅ | ✅ | 移动端优化为竖向布局 |
| 协作管理 | ✅ | ✅ | 使用移动端弹窗表单 |
| 评论讨论 | ✅ | ✅ | 移动端评论列表 |
| 版本历史 | ✅ | ✅ | 移动端时间线展示 |
| 搜索筛选 | ✅ | ✅ | 移动端搜索栏和筛选弹窗 |
| 权限控制 | ✅ | ✅ | 完全一致的权限逻辑 |

## 使用说明

### 访问页面
1. 启动前端服务器：`npm run start:frontend`
2. 访问：`http://localhost:5173/mobile/centers/document-collaboration`
3. 需要登录且具有管理员/园长/教师角色

### 文档列表操作
1. 使用搜索框搜索文档
2. 点击"筛选"按钮设置状态筛选
3. 下拉刷新更新列表
4. 点击文档卡片进入详情

### 文档协作操作
1. 在"协作管理"标签页进行分配操作
2. 设置截止时间和备注信息
3. 提交审核或进行审核操作

### 评论功能
1. 在"评论讨论"标签页查看历史评论
2. 在底部输入框添加新评论
3. 点击"发表评论"提交

### 版本管理
1. 在"版本历史"标签页查看所有版本
2. 点击"查看"查看特定版本
3. 点击"恢复"恢复历史版本
4. 点击"创建新版本"创建备份

## 测试

运行单元测试：

```bash
cd client
npm test src/pages/mobile/centers/document-collaboration/__tests__/index.test.ts
```

## 注意事项

1. 所有功能与PC端保持一致
2. 移动端专门优化了交互体验
3. 使用了Vant组件库确保移动端兼容性
4. 集成了完整的错误处理和加载状态
5. 响应式设计适配各种移动设备

## 开发时间

完成时间：2025-11-24
开发时间：约2小时
代码行数：约1000行（Vue组件）
测试覆盖：完整的单元测试