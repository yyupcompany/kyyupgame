# å¿«æ·ç™»å½•çœŸå®APIæ”¹é€ å®Œæˆ

## ğŸ“‹ æ”¹é€ å†…å®¹

### âœ… å·²å®Œæˆ
æ‰€æœ‰è§’è‰²çš„å¿«æ·ç™»å½•å·²ç»Ÿä¸€æ”¹ä¸º**çœŸå®åç«¯APIç™»å½•**ï¼Œä¸å†ä½¿ç”¨æ¨¡æ‹Ÿtokenã€‚

### ğŸ¯ æ¶‰åŠè§’è‰²
1. **ç³»ç»Ÿç®¡ç†å‘˜ (admin)**
   - ç”¨æˆ·å: `admin`
   - å¯†ç : `123456`
   - è°ƒç”¨çœŸå®ç™»å½•API

2. **å›­é•¿ (principal)**
   - ç”¨æˆ·å: `principal`
   - å¯†ç : `123456`
   - è°ƒç”¨çœŸå®ç™»å½•API

3. **æ•™å¸ˆ (teacher)**
   - ç”¨æˆ·å: `teacher`
   - å¯†ç : `123456`
   - è°ƒç”¨çœŸå®ç™»å½•API

4. **å®¶é•¿ (parent)**
   - ç”¨æˆ·å: `test_parent`
   - å¯†ç : `123456`
   - è°ƒç”¨çœŸå®ç™»å½•API

## ğŸ”§ æŠ€æœ¯å®ç°

### ä¿®æ”¹æ–‡ä»¶
`client/src/pages/Login/index.vue`

### æ ¸å¿ƒä»£ç 
```typescript
// å¿«æ·ç™»å½•ï¼ˆä½¿ç”¨çœŸå®åç«¯APIï¼‰
const quickLogin = async (role: string) => {
  console.log('âš¡ å¿«æ·ç™»å½•:', role)
  loading.value = true
  setGlobalLoading(true)

  try {
    // æ ¹æ®è§’è‰²ç¡®å®šç”¨æˆ·å
    const usernameMap: Record<string, string> = {
      admin: 'admin',
      principal: 'principal',
      teacher: 'teacher',
      parent: 'test_parent'
    }

    const username = usernameMap[role] || role
    const password = '123456' // é»˜è®¤å¯†ç 

    console.log(`ğŸ” è°ƒç”¨çœŸå®ç™»å½•API: ${username}`)

    // è®¾ç½®è¡¨å•å€¼
    loginForm.value.username = username
    loginForm.value.password = password
    
    // è°ƒç”¨ç™»å½•å¤„ç†å‡½æ•°ï¼ˆè°ƒç”¨åç«¯APIï¼‰
    await handleLogin()
  } catch (error: any) {
    console.error('âŒ å¿«æ·ç™»å½•å¤±è´¥:', error)
    ElMessage.error(error.message || 'ç™»å½•å¤±è´¥')
    loading.value = false
    setGlobalLoading(false)
  }
}
```

### åˆ é™¤çš„ä»£ç 
- âŒ `mockQuickLogin` å‡½æ•°ï¼ˆ73è¡Œï¼‰
- âŒ `handleLoginOriginal` å˜é‡
- âŒ æ‰€æœ‰æ¨¡æ‹Ÿç™»å½•ç›¸å…³ä»£ç 

## âœ¨ ä¼˜åŠ¿

### ä¹‹å‰ï¼ˆæ¨¡æ‹Ÿç™»å½•ï¼‰
- âŒ ä½¿ç”¨ `mock-token-xxxxx`
- âŒ å‰ç«¯ç”Ÿæˆå‡ç”¨æˆ·æ•°æ®
- âŒ åç«¯æ— æ³•è¯†åˆ«ç”¨æˆ·
- âŒ `kindergartenId` ç­‰å…³é”®ä¿¡æ¯ç¼ºå¤±
- âŒ æ•°æ®æŸ¥è¯¢å¤±è´¥

### ç°åœ¨ï¼ˆçœŸå®ç™»å½•ï¼‰
- âœ… ä½¿ç”¨çœŸå®JWT token
- âœ… åç«¯è¿”å›å®Œæ•´ç”¨æˆ·ä¿¡æ¯
- âœ… åŒ…å« `kindergartenId`, `userId` ç­‰
- âœ… æ•°æ®æŸ¥è¯¢æ­£ç¡®
- âœ… æ‰€æœ‰APIæ­£å¸¸å·¥ä½œ

## ğŸ”’ å®‰å…¨æ€§

1. **TokençœŸå®æ€§**: æ‰€æœ‰tokenç”±åç«¯ç­¾å‘
2. **ç”¨æˆ·éªŒè¯**: å¿…é¡»é€šè¿‡æ•°æ®åº“éªŒè¯
3. **æƒé™æ§åˆ¶**: åŸºäºçœŸå®çš„ç”¨æˆ·è§’è‰²å’Œæƒé™
4. **æ•°æ®éš”ç¦»**: æ­£ç¡®çš„ `kindergartenId` ç¡®ä¿æ•°æ®éš”ç¦»

## ğŸ“ æµ‹è¯•æ­¥éª¤

### 1. æµ‹è¯•ç®¡ç†å‘˜ç™»å½•
```
è®¿é—®: http://127.0.0.1:5173/login
ç‚¹å‡»: "ç³»ç»Ÿç®¡ç†å‘˜" å¿«æ·ç™»å½•
é¢„æœŸ: æˆåŠŸç™»å½•åˆ° /dashboard
éªŒè¯: localStorageä¸­æœ‰çœŸå®JWT token
```

### 2. æµ‹è¯•å›­é•¿ç™»å½•
```
è®¿é—®: http://127.0.0.1:5173/login
ç‚¹å‡»: "å›­é•¿" å¿«æ·ç™»å½•
é¢„æœŸ: æˆåŠŸç™»å½•åˆ°å›­é•¿é¦–é¡µ
éªŒè¯: ç”¨æˆ·è§’è‰²ä¸º principal
```

### 3. æµ‹è¯•æ•™å¸ˆç™»å½•
```
è®¿é—®: http://127.0.0.1:5173/login
ç‚¹å‡»: "æ•™å¸ˆ" å¿«æ·ç™»å½•
é¢„æœŸ: æˆåŠŸç™»å½•åˆ°æ•™å¸ˆé¦–é¡µ
éªŒè¯: ç”¨æˆ·è§’è‰²ä¸º teacher
```

### 4. æµ‹è¯•å®¶é•¿ç™»å½•ï¼ˆé‡ç‚¹ï¼‰
```
è®¿é—®: http://127.0.0.1:5173/login
ç‚¹å‡»: "å®¶é•¿" å¿«æ·ç™»å½•
é¢„æœŸ: æˆåŠŸç™»å½•åˆ° /parent-center/dashboard
éªŒè¯: 
  1. localStorageä¸­æœ‰çœŸå®JWT token
  2. ç”¨æˆ·åä¸º test_parent
  3. è®¿é—®ç›¸å†Œä¸­å¿ƒèƒ½çœ‹åˆ°10å¼ ç…§ç‰‡
  4. APIè¯·æ±‚ä½¿ç”¨çœŸå®tokenè€Œémock-token
```

## ğŸ¯ ç›¸å†Œä¸­å¿ƒç°åœ¨åº”è¯¥èƒ½æ­£å¸¸å·¥ä½œ

å› ä¸ºï¼š
1. âœ… ä½¿ç”¨çœŸå®JWT token
2. âœ… tokenåŒ…å«æ­£ç¡®çš„ `kindergartenId = 1`
3. âœ… åç«¯æŸ¥è¯¢æ¡ä»¶æ­£ç¡®
4. âœ… æ•°æ®åº“ä¸­çš„10å¼ ç…§ç‰‡éƒ½å±äº `kindergarten_id = 1`
5. âœ… APIè¿”å›çœŸå®æ•°æ®

## ğŸš€ ç«‹å³ç”Ÿæ•ˆ

åˆ·æ–°æµè§ˆå™¨åï¼Œæ‰€æœ‰å¿«æ·ç™»å½•æŒ‰é’®éƒ½å°†ä½¿ç”¨çœŸå®APIï¼š
- æ¸…é™¤æµè§ˆå™¨ç¼“å­˜ï¼ˆlocalStorageï¼‰
- è®¿é—®ç™»å½•é¡µ
- ç‚¹å‡»ä»»æ„è§’è‰²å¿«æ·ç™»å½•
- æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—ç¡®è®¤è°ƒç”¨çœŸå®API
- æ£€æŸ¥localStorageä¸­çš„tokenä¸å†æ˜¯ `mock-token`

---

**ä¿®æ”¹å®Œæˆæ—¶é—´**: 2024-11-17
**ä¿®æ”¹æ–‡ä»¶**: `client/src/pages/Login/index.vue`
**ä»£ç è¡Œæ•°**: åˆ é™¤73è¡Œæ¨¡æ‹Ÿä»£ç ï¼Œä¿ç•™30è¡ŒçœŸå®ç™»å½•ä»£ç 

