# 前端页面与测试用例开发完成度检查工具

## 📋 概述

这个工具用于比对前端页面和测试用例的开发完成度，帮助团队了解测试覆盖情况，识别需要补充测试的文件。

## 🚀 快速开始

### 方法一：使用npm脚本（推荐）

```bash
# 运行完成度检查
npm run check:completeness

# 或使用shell脚本版本
npm run check:completeness:sh
```

### 方法二：直接运行脚本

```bash
# 运行Node.js脚本
node scripts/check-development-completeness.js

# 或运行shell脚本
./scripts/check-completeness.sh
```

## 📊 报告内容

### 总体统计
- **总文件数**: 扫描到的所有Vue页面和组件文件数量
- **已测试文件**: 有对应测试文件的文件数量
- **未测试文件**: 缺少测试文件的文件数量
- **测试覆盖率**: 已测试文件占总文件的百分比

### 分类统计
- **页面文件统计**: pages/views目录下的Vue文件
- **组件文件统计**: components目录下的Vue文件

### 完成度分级
- **高完成度文件 (≥80%)**: 测试覆盖良好的文件
- **中等完成度文件 (50-79%)**: 有测试但覆盖不足的文件
- **低完成度文件 (<50%)**: 测试覆盖很少或没有测试的文件

### 问题汇总
- 缺少测试文件的数量
- 测试覆盖不足的具体问题
- 复杂组件测试用例不足的情况

## 📈 完成度计算规则

脚本会分析以下因素来计算完成度：

1. **基础测试存在 (30分)**: 是否有测试用例
2. **测试用例数量 (20分)**: 测试用例与源文件方法数量的比例
3. **Mock使用 (15分)**: 是否使用了Mock来隔离依赖
4. **覆盖率估算 (20分)**: 基于测试用例和断言的估算
5. **复杂度匹配 (15分)**: 测试用例数量与代码复杂度的匹配度

## 📁 输出文件

运行后会生成两个报告文件：

1. **JSON报告**: `test-results/development-completeness-report.json`
   - 机器可读的详细数据
   - 可用于CI/CD集成

2. **HTML报告**: `test-results/development-completeness-report.html`
   - 人类友好的可视化报告
   - 包含统计图表和详细列表

## 🔧 配置说明

### 扫描路径
脚本会扫描以下目录：
- `src/pages/**/*.vue` - 页面文件
- `src/views/**/*.vue` - 视图文件
- `src/components/**/*.vue` - 组件文件

### 测试文件查找规则
对于每个源文件，脚本会查找对应的测试文件：
- `tests/unit/对应路径/文件名.test.ts`
- `tests/unit/对应路径/文件名.test.js`
- `tests/unit/pages/目录名/文件名.test.ts`
- `tests/unit/components/目录名/文件名.test.ts`

## 💡 改进建议

### 优先级建议
1. **优先创建测试**: 为没有测试的核心页面和组件创建测试
2. **提升覆盖率**: 为测试覆盖率低的文件增加测试用例
3. **复杂组件重点关注**: 为复杂度高的组件编写更全面的测试

### 测试质量建议
- 使用Mock来隔离外部依赖
- 测试边缘情况和错误处理
- 确保测试用例覆盖主要功能路径
- 定期运行测试确保代码质量

## 🔍 示例输出

```
📈 总体统计
============================================================
总文件数: 421
已测试文件: 10
未测试文件: 411
测试覆盖率: 2%

📄 页面文件统计:
  总数: 279
  已测试: 7
  覆盖率: 3%

🧩 组件文件统计:
  总数: 142
  已测试: 3
  覆盖率: 2%
```

## 🛠️ 自定义配置

如需修改扫描路径或测试文件查找规则，可以编辑 `scripts/check-development-completeness.js` 文件中的相关配置。

## 📝 注意事项

1. 脚本需要Node.js环境和glob依赖包
2. 首次运行会自动安装必要的依赖
3. 生成的报告文件会覆盖之前的报告
4. 脚本会分析Vue文件的结构，提取方法、计算属性等信息

## 🤝 贡献

如果发现问题或有改进建议，欢迎提交Issue或Pull Request。

## 📄 许可证

本工具遵循项目的整体许可证。
