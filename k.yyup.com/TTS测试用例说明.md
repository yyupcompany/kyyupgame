# 🔊 TTS测试用例说明

## 📋 概述

这是一个基于 `TTS连接使用帮助.md` 文档创建的独立测试用例，用于验证火山引擎TTS服务配置和连接。

## 🚀 使用方法

### 1. 配置密钥

编辑 `tts-test.cjs` 文件，在开头的 `CONFIG` 区域填入你的火山引擎TTS配置：

```javascript
const CONFIG = {
  appId: 'your-actual-app-key',           // 替换为你的实际App Key
  accessToken: 'your-actual-access-token', // 替换为你的实际Access Token
  endpoint: 'openspeech.bytedance.com',
  path: '/api/v1/tts',
  cluster: 'volcano_tts',
  userId: '62170702'
};
```

### 2. 运行测试

```bash
node tts-test.cjs
```

## 🧪 测试用例

测试用例包含5个场景：

1. **基础测试** - 验证基本TTS功能
2. **儿童友好测试** - 测试适合儿童的语音
3. **男声测试** - 测试男声音色
4. **快速语音测试** - 测试语速调整
5. **长文本测试** - 测试长文本处理能力

## 📊 测试报告

测试完成后会生成详细报告，包括：
- 成功/失败统计
- 耗时信息
- 生成的音频文件列表
- 错误信息（如果有）

## 💾 输出文件

成功的测试会在当前目录生成MP3文件：
- `test-1-基础测试.mp3`
- `test-2-儿童友好测试.mp3`
- `test-3-男声测试.mp3`
- `test-4-快速语音测试.mp3`
- `test-5-长文本测试.mp3`

## 🔧 功能特性

### 1. 配置验证
- 自动检查App Key和Access Token是否已配置
- 防止使用默认值进行测试

### 2. 网络连接测试
- 在执行测试前验证与火山引擎服务器的连接
- 确保网络可达性

### 3. 重试机制
- 自动重试失败的请求（最多3次）
- 指数退避算法，避免频率限制

### 4. 详细的错误处理
- HTTP状态码解析
- 错误信息提取
- 超时处理（30秒）

### 5. 进度跟踪
- 实时显示测试进度
- 详细的日志输出
- 音频生成统计

## ⚠️ 注意事项

1. **配置安全**：不要将包含真实密钥的文件提交到版本控制系统
2. **网络环境**：确保能够访问 `openspeech.bytedance.com`
3. **API配额**：注意火山引擎TTS的调用频率限制
4. **文件权限**：确保当前目录有写入权限

## 🐛 故障排除

### 常见问题：

1. **配置未设置**
   ```
   配置错误:
      ❌ App Key 未配置或使用默认值
   ```
   解决：在CONFIG区域填入真实的App Key和Access Token

2. **网络连接失败**
   ```
   ❌ 网络连接失败: connect ECONNREFUSED
   ```
   解决：检查网络连接和防火墙设置

3. **认证失败**
   ```
   ❌ 测试失败: HTTP 401: Unauthorized
   ```
   解决：检查App Key和Access Token是否正确

4. **配额超限**
   ```
   ❌ 测试失败: HTTP 429: Too Many Requests
   ```
   解决：等待一段时间后重试，或升级服务套餐

## 📈 测试结果解读

### 全部成功 ✅
```
🎉 所有测试通过！TTS服务配置正确。
```
说明：配置正确，服务可用

### 部分成功 ⚠️
```
⚠️  部分测试通过，请检查失败的测试用例。
```
说明：基本配置正确，但某些功能可能有问题

### 全部失败 ❌
```
❌ 所有测试失败，请检查配置和网络连接。
```
说明：配置或网络连接有问题

## 🔍 自定义测试

你可以修改 `TEST_CASES` 数组来自定义测试用例：

```javascript
const TEST_CASES = [
  {
    name: '自定义测试',
    text: '这是你的测试文本',
    voice: 'zh_female_cancan_mars_bigtts',
    speed: 1.0,
    encoding: 'mp3'
  }
];
```

## 📞 技术支持

如果遇到问题，请检查：
1. 火山引擎控制台中的API密钥是否正确
2. 账户余额是否充足
3. 网络连接是否正常
4. 参考 `TTS连接使用帮助.md` 文档

---

**提示**：这是一个独立的测试工具，可以直接使用，无需依赖项目的其他组件。