# Docker é…ç½®æ€»ç»“

## ğŸ¯ é…ç½®ç›®æ ‡
ä¸ºå¹¼å„¿å›­ç®¡ç†ç³»ç»Ÿåˆ›å»ºç»Ÿä¸€çš„Dockerç¯å¢ƒï¼Œå°†Vue.jså‰ç«¯å’ŒNode.jsåç«¯æ•´åˆåœ¨ä¸€ä¸ªå®¹å™¨ä¸­è¿è¡Œã€‚

## ğŸ“ åˆ›å»ºçš„æ–‡ä»¶

### æ ¸å¿ƒé…ç½®æ–‡ä»¶
1. **Dockerfile** - ä¸»æ„å»ºæ–‡ä»¶
2. **docker-compose.yml** - å®¹å™¨ç¼–æ’é…ç½®
3. **.dockerignore** - å¿½ç•¥æ–‡ä»¶é…ç½®

### Dockeré…ç½®ç›®å½• (`docker/`)
1. **nginx.conf** - Nginxä¸»é…ç½®
2. **default.conf** - è™šæ‹Ÿä¸»æœºé…ç½®  
3. **supervisord.conf** - è¿›ç¨‹ç®¡ç†é…ç½®
4. **health-check.sh** - å¥åº·æ£€æŸ¥è„šæœ¬
5. **docker-build.sh** - æ„å»ºè„šæœ¬
6. **start.sh** - å¯åŠ¨è„šæœ¬

### æ–‡æ¡£æ–‡ä»¶
1. **README-DOCKER.md** - è¯¦ç»†Dockerä½¿ç”¨æŒ‡å—
2. **å¿«é€Ÿå¯åŠ¨æŒ‡å—.md** - å¿«é€Ÿå¯åŠ¨è¯´æ˜
3. **DOCKER-é…ç½®æ€»ç»“.md** - æœ¬æ–‡ä»¶

## ğŸ—ï¸ æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             Dockerå®¹å™¨               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   Nginx   â”‚  â”‚   Supervisor    â”‚ â”‚
â”‚  â”‚  (ç«¯å£80) â”‚  â”‚   (è¿›ç¨‹ç®¡ç†)    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚       â”‚              â”‚             â”‚
â”‚       â”œâ”€ é™æ€æ–‡ä»¶    â”œâ”€ Nginx       â”‚
â”‚       â””â”€ APIä»£ç†     â””â”€ Node.js     â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚        Node.js åç«¯API          â”‚ â”‚
â”‚  â”‚         (ç«¯å£3000)             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”§ æŠ€æœ¯æ ˆ

### å‰ç«¯éƒ¨åˆ†
- **æ¡†æ¶**: Vue 3 + Vite
- **æ„å»º**: `npm run build` â†’ `client/dist/`
- **æœåŠ¡**: Nginxé™æ€æ–‡ä»¶æœåŠ¡

### åç«¯éƒ¨åˆ†  
- **æ¡†æ¶**: Node.js + Express + TypeScript
- **æ„å»º**: `npm run build` â†’ `server/dist/`
- **å…¥å£**: `dist/app.js`
- **ç«¯å£**: 3000

### å®¹å™¨ç®¡ç†
- **WebæœåŠ¡å™¨**: Nginx (Alpine)
- **è¿›ç¨‹ç®¡ç†**: Supervisor
- **åŸºç¡€é•œåƒ**: Node.js 18 Alpine

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### å¿«é€Ÿå¯åŠ¨
```bash
# ä½¿ç”¨Docker Composeï¼ˆæ¨èï¼‰
docker-compose up -d

# ç›´æ¥æ„å»ºå’Œè¿è¡Œ
docker build -t kindergarten-system .
docker run -d -p 80:80 --name kindergarten kindergarten-system
```

### è®¿é—®åœ°å€
- **å‰ç«¯åº”ç”¨**: http://localhost
- **APIæ¥å£**: http://localhost/api/*ï¼ˆé€šè¿‡Nginxä»£ç†åˆ°åç«¯ï¼‰

## ğŸ›¡ï¸ å®‰å…¨ç‰¹æ€§

1. **érootç”¨æˆ·**: åˆ›å»ºäº†ä¸“ç”¨ç”¨æˆ·è¿è¡Œåº”ç”¨
2. **å¥åº·æ£€æŸ¥**: 30ç§’é—´éš”æ£€æŸ¥æœåŠ¡çŠ¶æ€
3. **èµ„æºé™åˆ¶**: å¯é€šè¿‡docker-composeè®¾ç½®
4. **æ—¥å¿—ç®¡ç†**: ç»Ÿä¸€æ—¥å¿—æ”¶é›†å’Œè½®è½¬

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

1. **åˆ†å±‚æ„å»º**: ä¼˜åŒ–Dockerå±‚ç¼“å­˜
2. **å¤šé˜¶æ®µæ„å»º**: å‡å°æœ€ç»ˆé•œåƒå¤§å°
3. **Gzipå‹ç¼©**: Nginxå¯ç”¨å‹ç¼©
4. **é™æ€èµ„æºç¼“å­˜**: 1å¹´ç¼“å­˜æœŸ
5. **ä¾èµ–å®‰è£…ä¼˜åŒ–**: å…ˆå®‰è£…ä¾èµ–å†å¤åˆ¶æºç 

## ğŸ” ç›‘æ§å’Œè°ƒè¯•

### æ—¥å¿—ä½ç½®
- Supervisor: `/var/log/supervisor/`
- Nginx: `/var/log/nginx/`
- åç«¯: `/var/log/supervisor/backend.log`

### è°ƒè¯•å‘½ä»¤
```bash
# æŸ¥çœ‹å®¹å™¨çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f

# è¿›å…¥å®¹å™¨
docker exec -it kindergarten-system sh

# æ£€æŸ¥æœåŠ¡çŠ¶æ€
supervisorctl status
```

## ğŸ—‚ï¸ ç›®å½•æ˜ å°„

```yaml
volumes:
  - ./uploads:/app/uploads          # æ–‡ä»¶ä¸Šä¼ 
  - ./server/logs:/app/server/logs  # åº”ç”¨æ—¥å¿—
```

## âš™ï¸ ç¯å¢ƒå˜é‡

```yaml
environment:
  - NODE_ENV=production
  - PORT=3000
  # æ•°æ®åº“é…ç½®ï¼ˆæ ¹æ®éœ€è¦ï¼‰
  - DB_HOST=localhost
  - DB_PORT=3306
  - DB_NAME=kindergarten
```

## ğŸ”„ CI/CDé›†æˆ

### GitHub Actionsç¤ºä¾‹
```yaml
- name: Build Docker Image
  run: docker build -t kindergarten-system .
  
- name: Run Tests
  run: docker run --rm kindergarten-system npm test
```

### ç”Ÿäº§éƒ¨ç½²
```bash
# æ„å»ºç”Ÿäº§é•œåƒ
docker build -t kindergarten-system:prod .

# æ¨é€åˆ°ä»“åº“
docker tag kindergarten-system:prod your-registry/kindergarten-system:latest
docker push your-registry/kindergarten-system:latest
```

## ğŸ”§ è‡ªå®šä¹‰é…ç½®

### ä¿®æ”¹ç«¯å£
åœ¨ `docker-compose.yml` ä¸­ä¿®æ”¹ï¼š
```yaml
ports:
  - "8080:80"  # æ”¹ä¸º8080ç«¯å£
```

### æ·»åŠ æ•°æ®åº“
å–æ¶ˆæ³¨é‡Š `docker-compose.yml` ä¸­çš„MySQLé…ç½®

### å¼€å‘æ¨¡å¼
åˆ›å»º `docker-compose.dev.yml` ç”¨äºå¼€å‘ç¯å¢ƒ

## ğŸ“‹ TODOæ¸…å•

- [ ] æ·»åŠ Redisç¼“å­˜æ”¯æŒ
- [ ] é…ç½®SSL/HTTPS
- [ ] æ·»åŠ æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
- [ ] åˆ›å»ºå¼€å‘ç¯å¢ƒä¸“ç”¨é…ç½®
- [ ] æ·»åŠ è‡ªåŠ¨å¤‡ä»½æœºåˆ¶

## ğŸ› å·²çŸ¥é—®é¢˜

1. **æƒé™é—®é¢˜**: æŸäº›ç¯å¢ƒä¸‹å¯èƒ½éœ€è¦è°ƒæ•´æ–‡ä»¶æƒé™
2. **å†…å­˜ä½¿ç”¨**: æ„å»ºè¿‡ç¨‹éœ€è¦è¾ƒå¤šå†…å­˜
3. **ç«¯å£å†²çª**: ç¡®ä¿80å’Œ3000ç«¯å£æœªè¢«å ç”¨

## ğŸ“ æŠ€æœ¯æ”¯æŒ

é‡åˆ°é—®é¢˜æ—¶è¯·æ£€æŸ¥ï¼š
1. Dockerç‰ˆæœ¬å…¼å®¹æ€§
2. ç³»ç»Ÿèµ„æºï¼ˆå†…å­˜/ç£ç›˜ï¼‰
3. ç½‘ç»œè¿æ¥çŠ¶å†µ
4. è¯¦ç»†é”™è¯¯æ—¥å¿—

---

**é…ç½®å®Œæˆæ—¶é—´**: 2025å¹´1æœˆ30æ—¥  
**Dockerç‰ˆæœ¬è¦æ±‚**: 20.10+  
**Docker Composeç‰ˆæœ¬**: 2.0+