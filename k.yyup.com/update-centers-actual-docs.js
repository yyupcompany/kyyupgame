import mysql from 'mysql2/promise';

const connection = await mysql.createConnection({
  host: 'localhost',
  user: 'root',
  password: '123456',
  database: 'lazy_ai_substitute_project'
});

console.log('开始更新人事中心和营销中心的AI知识库文档...');

// 先删除旧的人事中心和营销中心文档
console.log('删除旧的人事中心和营销中心AI知识库文档...');
await connection.execute(
  "DELETE FROM ai_knowledge_base WHERE category IN ('人事中心', '营销中心')"
);

const allCenterDocs = [
  // 人事中心文档
  {
    category: '人事中心',
    document_name: 'personnel_overview_dashboard',
    document_description: '人事中心概览仪表板功能说明',
    document_content: `# 人事中心概览仪表板

## 页面概述
人事中心是教师和学生管理的核心平台，提供全面的人员管理功能，包括教师信息、学生档案、家长管理、班级组织等。

## 标签页结构
人事中心包含5个主要标签页：
1. **概览**：统计数据、图表分析、快速操作
2. **学生管理**：学生列表、详情查看、CRUD操作
3. **家长管理**：家长信息、沟通记录、孩子关联
4. **教师管理**：教师档案、部门职位、班级分配
5. **班级管理**：班级信息、容量管理、学生分配

## 概览功能
### 统计卡片
- **在校学生**：456人，较上月增长12人
- **注册家长**：328人，较上月增长8人
- **在职教师**：45人，较上月增长2人
- **开设班级**：18个，较上月增长1个

### 图表展示
- **人员分布统计**：饼图显示各类人员比例
- **人员增长趋势**：折线图显示6个月变化趋势

### 快速操作
提供新增学生、家长、教师、班级的快速入口`
  },
  {
    category: '人事中心',
    document_name: 'student_management_features',
    document_description: '学生管理功能详解',
    document_content: `# 学生管理功能

## 页面布局
左右分栏设计：左侧学生列表，右侧学生详情

## 学生列表
### 表格字段
- 姓名、学号、班级、性别、年龄、状态、入学时间

### 状态管理
- **在读(active)**：绿色标签
- **休学(suspended)**：橙色标签
- **毕业(graduated)**：蓝色标签

### 操作功能
- 新增、编辑、删除学生
- 点击行查看详情
- 分页和搜索

## 学生详情
### 信息分组
1. **基本信息**：姓名、学号、性别、年龄、生日
2. **班级信息**：班级、入学时间、状态
3. **家长信息**：家长姓名、电话、邮箱
4. **成绩记录**：各科目成绩和等级

### 成绩显示
- 优秀(≥90分)：绿色标签
- 良好(≥80分)：蓝色标签
- 中等(≥70分)：橙色标签
- 待提高(<70分)：红色标签`
  },
  {
    category: '人事中心',
    document_name: 'parent_management_features',
    document_description: '家长管理功能详解',
    document_content: `# 家长管理功能

## 功能特色
家长管理是人事中心的重要组成部分，支持完整的家长信息管理和沟通记录。

## 列表功能
### 表格字段
- 姓名、手机号、邮箱、关联孩子、状态、注册时间

### 高级操作
- **查看**：查看家长详细信息
- **编辑**：修改家长基本信息
- **孩子管理**：管理家长关联的孩子
- **沟通记录**：查看历史沟通情况
- **删除**：删除家长记录

## 详情面板
### 信息分组
1. **基本信息**：姓名、电话、邮箱、地址
2. **孩子信息**：关联的孩子列表
3. **沟通记录**：详细沟通历史
4. **其他信息**：状态、注册时间、来源

### 沟通记录
- **记录类型**：电话、访问、消息、邮件
- **时间显示**：按时间顺序排列
- **内容详情**：每次沟通的具体内容
- **颜色标识**：不同类型用不同颜色区分`
  },
  {
    category: '人事中心',
    document_name: 'teacher_management_features',
    document_description: '教师管理功能详解',
    document_content: `# 教师管理功能

## 页面设计
教师管理采用单列布局，专注于教师信息的展示和管理。

## 教师列表
### 表格字段
- 姓名、工号、部门、职位、任教班级、状态、入职时间

### 部门分类
- **教学部(teaching)**：负责教学工作
- **行政部(admin)**：负责管理工作
- **后勤部(logistics)**：负责后勤保障

### 状态管理
- **在职(active)**：绿色标签，正常工作
- **离职(inactive)**：红色标签，已离职
- **休假(leave)**：橙色标签，临时休假

## 班级关联
- 教师可关联多个班级
- 班级信息用标签形式显示
- 支持班级分配调整

## 表单管理
### 新增教师
包含基本信息、部门职位、入职时间、薪资等字段

### 编辑功能
使用专门的TeacherEditDialog组件，支持全信息修改`
  },
  {
    category: '人事中心',
    document_name: 'class_management_features',
    document_description: '班级管理功能详解',
    document_content: `# 班级管理功能

## 核心特色
班级管理提供可视化的容量管理和学生分配功能。

## 班级列表
### 表格字段
- 班级名称、年级、容量情况、班主任、教室、状态、创建时间

### 容量可视化
- **进度条显示**：当前学生数/最大容量
- **动态更新**：学生变动时自动更新
- **容量警告**：接近满员时的视觉提示

## 年级分类
- **小班(small)**：适合较小年龄段幼儿
- **中班(medium)**：中等年龄段幼儿
- **大班(large)**：大年龄段，准备升学幼儿

## 班级详情
### 信息分组
1. **基本信息**：名称、年级、教室、最大容量
2. **教师信息**：班主任、副班主任
3. **学生信息**：学生头像网格展示
4. **其他信息**：状态、创建时间、描述

### 学生展示
- **头像网格**：以卡片形式展示所有学生
- **响应式布局**：适应不同屏幕尺寸
- **快速识别**：通过头像和姓名快速识别`
  },
  
  // 营销中心文档
  {
    category: '营销中心',
    document_name: 'marketing_center_overview',
    document_description: '营销中心概览功能说明',
    document_content: `# 营销中心概览

## 页面定位
营销中心是营销活动管理和推广的中心枢纽，您可以创建营销活动、管理推广渠道、分析营销效果。

## 核心功能区域

### 1. 营销统计仪表板
显示四个关键营销指标：
- **活跃营销活动**：当前进行中的活动数量
- **本月新客户**：营销活动带来的新客户
- **转化率**：整体营销转化效果百分比
- **营销ROI**：投资回报率百分比

### 2. 六大功能模块
- **营销活动📢**：创建管理促销优惠活动
- **推广渠道📱**：管理社媒广告合作渠道
- **营销分析📊**：分析转化率ROI获客成本
- **营销自动化🤖**：设置邮件营销客户跟进
- **优惠券管理🎫**：创建管理优惠券规则
- **咨询管理📝**：管理客户咨询跟进状态

### 3. 最近营销活动
展示最近3个营销活动的：
- 活动标题和描述
- 参与人数和转化率
- 活动状态（进行中/已完成）
- 查看和编辑操作

### 4. 营销渠道概览
各渠道的关键数据：
- 本月获客数量
- 转化率百分比
- 获客成本金额
- 渠道状态（活跃/暂停）`
  },
  {
    category: '营销中心',
    document_name: 'campaign_management_system',
    document_description: '营销活动管理系统详解',
    document_content: `# 营销活动管理系统

## 活动展示功能
营销中心展示最近3个活动的完整信息。

## 活动信息结构
### 基本信息
- **活动标题**：营销活动的完整名称
- **活动描述**：内容和目标的简要说明
- **开始日期**：活动启动的具体时间

### 状态标识
- **active（进行中）**：蓝色标签，活动正在进行
- **completed（已完成）**：绿色标签，活动已结束

### 关键指标
- **参与人数**：活动吸引的总人数
- **转化率**：参与到转化的比例百分比

## 活动操作
### 查看功能
- 点击查看按钮进入活动详情
- 查看活动的完整数据和分析

### 编辑功能
- 点击编辑按钮修改活动设置
- 更新活动内容和参数

## 创建活动
### 创建流程
1. 点击"创建营销活动"按钮
2. 打开CreateCampaignDialog组件
3. 填写活动基本信息
4. 设置活动参数和规则
5. 保存并启动活动

### 数据更新
- 创建成功后自动刷新活动列表
- 实时显示最新的活动数据`
  },
  {
    category: '营销中心',
    document_name: 'marketing_channels_analysis',
    document_description: '营销渠道分析功能详解',
    document_content: `# 营销渠道分析功能

## 渠道数据概览
营销渠道概览提供各推广渠道的详细数据分析。

## 渠道信息展示
### 基本信息
- **渠道图标**：可视化图标标识
- **渠道名称**：清晰的渠道标识
- **运营状态**：活跃或暂停状态

### 关键指标
#### 1. 本月获客数量
- 当月通过该渠道获得的新客户数
- 直观反映渠道获客能力
- 用于渠道效果对比

#### 2. 转化率
- 访问到转化的比例
- 评估渠道质量的核心指标
- 以百分比形式显示

#### 3. 获客成本
- 每获得一个客户的平均成本
- 用人民币形式显示(¥)
- 用于ROI计算和成本控制

## 状态管理
### 渠道状态
- **active（活跃）**：蓝色主题，正常运营
- **paused（暂停）**：橙色警告，临时停止

## 数据可视化
### 网格布局
- 响应式CSS Grid设计
- 最小宽度250px确保内容可读
- 自动适应不同屏幕尺寸

### 数据格式
- 获客数量：整数显示
- 转化率：百分比格式
- 获客成本：货币格式`
  },
  {
    category: '营销中心',
    document_name: 'marketing_modules_navigation',
    document_description: '营销功能模块导航详解',
    document_content: `# 营销功能模块导航

## 模块架构
营销中心提供6个核心功能模块，覆盖营销活动的全生命周期。

## 详细模块介绍

### 📢 营销活动模块
- **路径**：/marketing
- **核心功能**：创建和管理各种营销活动
- **适用场景**：促销活动、产品推广、会员活动
- **主要操作**：活动创建、编辑、状态管理、效果统计

### 📱 推广渠道模块  
- **路径**：/advertisement
- **核心功能**：管理多种推广渠道
- **渠道类型**：社交媒体、在线广告、合作伙伴
- **管理功能**：渠道配置、投放监控、效果分析

### 📊 营销分析模块
- **路径**：/principal/marketing-analysis
- **核心功能**：深入分析营销效果
- **分析维度**：转化率、ROI、客户获取成本
- **报表功能**：数据可视化、自定义报表

### 🤖 营销自动化模块
- **路径**：/marketing/intelligent-engine/marketing-engine
- **核心功能**：设置自动化营销流程
- **自动化场景**：邮件营销、客户跟进、个性化推荐
- **智能功能**：触发条件、个性化内容、效果追踪

### 🎫 优惠券管理模块
- **路径**：/centers/marketing/coupons
- **核心功能**：创建和管理优惠券
- **优惠券类型**：满减券、折扣券、体验券
- **管理功能**：发放控制、使用统计、有效期管理

### 📝 咨询管理模块
- **路径**：/centers/marketing/consultations
- **核心功能**：管理客户咨询
- **咨询渠道**：在线客服、电话、邮件、表单
- **管理流程**：接收、分配、跟进、反馈、归档

## 导航机制
- 使用Vue Router进行页面跳转
- 支持错误处理和友好提示
- 统一的交互设计和视觉反馈`
  }
];

console.log('开始添加基于实际页面内容的AI知识库文档...');

for (const doc of allCenterDocs) {
  try {
    const [result] = await connection.execute(
      'INSERT INTO ai_knowledge_base (category, document_name, document_description, document_content, created_at, updated_at) VALUES (?, ?, ?, ?, NOW(), NOW())',
      [doc.category, doc.document_name, doc.document_description, doc.document_content]
    );
    
    console.log(`✅ 成功添加文档: ${doc.category} - ${doc.document_name} (ID: ${result.insertId})`);
  } catch (error) {
    console.error(`❌ 添加文档失败: ${doc.category} - ${doc.document_name}`, error.message);
  }
}

await connection.end();
console.log('人事中心和营销中心AI知识库文档更新完成！');